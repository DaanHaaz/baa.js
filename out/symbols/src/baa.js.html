<html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"> <style>
	.KEYW {color: #933;}
	.COMM {color: #bbb; font-style: italic;}
	.NUMB {color: #393;}
	.STRN {color: #393;}
	.REGX {color: #339;}
	.line {border-right: 1px dotted #666; color: #666; font-style: normal;}
	</style></head><body><pre><span class='line'>  1</span> <span class="COMM">/*
<span class='line'>  2</span> BBBBBBBBBBBBBBBBB               AAA                              AAA               
<span class='line'>  3</span> B::::::::::::::::B             A:::A                            A:::A              
<span class='line'>  4</span> B::::::BBBBBB:::::B           A:::::A                          A:::::A             
<span class='line'>  5</span> BB:::::B     B:::::B         A:::::::A                        A:::::::A            
<span class='line'>  6</span>   B::::B     B:::::B        A:::::::::A                      A:::::::::A           
<span class='line'>  7</span>   B::::B     B:::::B       A:::::A:::::A                    A:::::A:::::A          
<span class='line'>  8</span>   B::::BBBBBB:::::B       A:::::A A:::::A                  A:::::A A:::::A         
<span class='line'>  9</span>   B:::::::::::::BB       A:::::A   A:::::A                A:::::A   A:::::A        
<span class='line'> 10</span>   B::::BBBBBB:::::B     A:::::A     A:::::A              A:::::A     A:::::A       
<span class='line'> 11</span>   B::::B     B:::::B   A:::::AAAAAAAAA:::::A            A:::::AAAAAAAAA:::::A      
<span class='line'> 12</span>   B::::B     B:::::B  A:::::::::::::::::::::A          A:::::::::::::::::::::A     
<span class='line'> 13</span>   B::::B     B:::::B A:::::AAAAAAAAAAAAA:::::A        A:::::AAAAAAAAAAAAA:::::A    
<span class='line'> 14</span> BB:::::BBBBBB::::::BA:::::A             A:::::A      A:::::A             A:::::A   
<span class='line'> 15</span> B:::::::::::::::::BA:::::A               A:::::A    A:::::A               A:::::A  
<span class='line'> 16</span> B::::::::::::::::BA:::::A                 A:::::A  A:::::A                 A:::::A 
<span class='line'> 17</span> BBBBBBBBBBBBBBBBBAAAAAAA                   AAAAAAAAAAAAAA                   AAAAAAA
<span class='line'> 18</span> 
<span class='line'> 19</span> Barely an angine
<span class='line'> 20</span> 
<span class='line'> 21</span> */</span><span class="WHIT">
<span class='line'> 22</span> 
<span class='line'> 23</span> 
<span class='line'> 24</span> </span><span class="COMM">/**
<span class='line'> 25</span>  * Saves time from writing console.log, and writes complete functions
<span class='line'> 26</span>  */</span><span class="WHIT">
<span class='line'> 27</span> </span><span class="NAME">print</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 28</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT">
<span class='line'> 29</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 30</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">&lt;</span><span class="NAME">arguments.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 31</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="STRN">", "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 32</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 33</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 34</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 35</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 36</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 37</span> </span><span class="WHIT">	</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 38</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 39</span> 
<span class='line'> 40</span> 
<span class='line'> 41</span> </span><span class="COMM">/**
<span class='line'> 42</span>  * Saves time from writing console.log
<span class='line'> 43</span>  */</span><span class="WHIT">
<span class='line'> 44</span> </span><span class="NAME">printf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'> 45</span> </span><span class="WHIT">	</span><span class="NAME">console.log</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 46</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'> 47</span> 
<span class='line'> 48</span> 
<span class='line'> 49</span> </span><span class="COMM">//////////////</span><span class="WHIT">
<span class='line'> 50</span> </span><span class="COMM">///CLASSIST///</span><span class="WHIT">
<span class='line'> 51</span> </span><span class="COMM">//////////////</span><span class="WHIT">
<span class='line'> 52</span> 
<span class='line'> 53</span> </span><span class="COMM">/**
<span class='line'> 54</span>  * Let's you create classes, that allow extending, implementing, and type checking.
<span class='line'> 55</span>  * @example
<span class='line'> 56</span>  * //Create a new class.
<span class='line'> 57</span>  * Animal = Class.extend("Animal");
<span class='line'> 58</span>  *
<span class='line'> 59</span>  * //Static variable
<span class='line'> 60</span>  * Animal.types = [
<span class='line'> 61</span>  * 	"Mammal",
<span class='line'> 62</span>  * 	"Fish",
<span class='line'> 63</span>  * 	"Insect"
<span class='line'> 64</span>  * ]
<span class='line'> 65</span>  * 
<span class='line'> 66</span>  * //The constructor. This is called when creating a new instance.
<span class='line'> 67</span>  * Animal.init = function () {
<span class='line'> 68</span>  * 		this.health = 100;
<span class='line'> 69</span>  * 		
<span class='line'> 70</span>  * }
<span class='line'> 71</span>  *
<span class='line'> 72</span>  * //Give functions to the class like this.
<span class='line'> 73</span>  * Animal.draw = function () {
<span class='line'> 74</span>  * 		baa.graphics.rectangle("fill",100,100,this.health);
<span class='line'> 75</span>  * }
<span class='line'> 76</span>  *
<span class='line'> 77</span>  * //Extend an existing class
<span class='line'> 78</span>  * Bear = Animal.extend("Bear");
<span class='line'> 79</span>  *
<span class='line'> 80</span>  *
<span class='line'> 81</span>  * Bear.init = function () {
<span class='line'> 82</span>  * 		//Call the original function of the extended class
<span class='line'> 83</span>  * 		Bear.super.init();
<span class='line'> 84</span>  * }
<span class='line'> 85</span>  *
<span class='line'> 86</span>  * Bear.draw = function () {
<span class='line'> 87</span>  * 		Bear.super.draw();
<span class='line'> 88</span>  * }
<span class='line'> 89</span>  *
<span class='line'> 90</span>  * //Static function. You can't use 'this' here.
<span class='line'> 91</span>  * Bear.__doStuff = function () {
<span class='line'> 92</span>  * 
<span class='line'> 93</span>  * }
<span class='line'> 94</span>  * @class
<span class='line'> 95</span>  * @type {object}
<span class='line'> 96</span>  */</span><span class="WHIT">
<span class='line'> 97</span> </span><span class="NAME">Class</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'> 98</span> 
<span class='line'> 99</span> </span><span class="COMM">/**
<span class='line'>100</span>  * The names of the class. For each extension there is a new name.
<span class='line'>101</span>  * @type {string[]}
<span class='line'>102</span>  */</span><span class="WHIT">
<span class='line'>103</span> </span><span class="NAME">Class._names</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"Class"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>104</span> 
<span class='line'>105</span> </span><span class="COMM">/**
<span class='line'>106</span>  * This is used to check if something is a class
<span class='line'>107</span>  */</span><span class="WHIT">
<span class='line'>108</span> </span><span class="NAME">Class._isClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>109</span> 
<span class='line'>110</span> </span><span class="COMM">/**
<span class='line'>111</span>  * Clones an existing class to create a new type of class.
<span class='line'>112</span>  * @param  {string} name The name of the class
<span class='line'>113</span>  * @return {Class}      A clone of the class
<span class='line'>114</span>  */</span><span class="WHIT">
<span class='line'>115</span> </span><span class="NAME">Class.extend</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>116</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>117</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Missing argument name in Class.extend"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>118</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>119</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>120</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">supr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>121</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>122</span> </span><span class="WHIT">		</span><span class="NAME">temp</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.__clone</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>123</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">!=</span><span class="STRN">"isClass"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>124</span> </span><span class="WHIT">			</span><span class="NAME">supr</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.__clone</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>125</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>126</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>127</span> </span><span class="WHIT">	</span><span class="NAME">temp.super</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">supr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>128</span> </span><span class="WHIT">	</span><span class="NAME">temp._names.push</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>129</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">temp</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>130</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>131</span> 
<span class='line'>132</span> </span><span class="COMM">/**
<span class='line'>133</span>  * Creates a new instance of the class
<span class='line'>134</span>  * @return {Class} The new instance of the class.
<span class='line'>135</span>  */</span><span class="WHIT">
<span class='line'>136</span> </span><span class="NAME">Class.new</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>137</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">self</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.__clone</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>138</span> 
<span class='line'>139</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">self.init</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>140</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="NAME">this.type</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" has no constructor"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>141</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>142</span> 
<span class='line'>143</span> </span><span class="WHIT">	</span><span class="NAME">self.init.apply</span><span class="PUNC">(</span><span class="NAME">self</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>144</span> </span><span class="WHIT">	
<span class='line'>145</span> 	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">self</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>146</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>147</span> 
<span class='line'>148</span> </span><span class="COMM">/**
<span class='line'>149</span>  * Copies the functions of a different class
<span class='line'>150</span>  * @param  {Class} obj   The class to implement
<span class='line'>151</span>  * @param  {boolean} force Whether to overwrite existing functions.
<span class='line'>152</span>  */</span><span class="WHIT">
<span class='line'>153</span> </span><span class="NAME">Class.implement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>154</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"Class"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"Class"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>155</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"force"</span><span class="PUNC">,</span><span class="NAME">force</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>156</span> 
<span class='line'>157</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>158</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>159</span> </span><span class="WHIT">			</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.__clone</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>160</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>161</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>162</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>163</span> 
<span class='line'>164</span> </span><span class="COMM">/**
<span class='line'>165</span>  * If something is specific class
<span class='line'>166</span>  * @example
<span class='line'>167</span>  * var rect = baa.rect.new();
<span class='line'>168</span>  * 
<span class='line'>169</span>  * //Returns true
<span class='line'>170</span>  * rect.is(baa.rect);
<span class='line'>171</span>  *
<span class='line'>172</span>  * //Returns true
<span class='line'>173</span>  * rect.is(baa.point);
<span class='line'>174</span>  *
<span class='line'>175</span>  * //Returns false
<span class='line'>176</span>  * rect.is(baa.sprite);
<span class='line'>177</span>  * 
<span class='line'>178</span>  * @param  {Class|string}  obj The value you want to check
<span class='line'>179</span>  * @return {boolean}  If it is of the type obj 
<span class='line'>180</span>  */</span><span class="WHIT">
<span class='line'>181</span> </span><span class="NAME">Class.is</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>182</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"Class"</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>183</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>184</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>185</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._names.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>186</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this._names</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">obj.type</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._names</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>187</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>188</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>189</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>190</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>191</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>192</span> 
<span class='line'>193</span> </span><span class="COMM">/**
<span class='line'>194</span>  * Returns the top-layer-type of the class
<span class='line'>195</span>  * @example
<span class='line'>196</span>  * // returns "baa.rectangle"
<span class='line'>197</span>  * baa.rectangle = baa.point.extend("baa.rectangle");
<span class='line'>198</span>  * baa.rectangle.type();
<span class='line'>199</span>  * @return {string} The type of the class
<span class='line'>200</span>  */</span><span class="WHIT">
<span class='line'>201</span> </span><span class="NAME">Class.type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>202</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._names</span><span class="PUNC">[</span><span class="NAME">this._names.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>203</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Add a type name! class.extend([TYPE])"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>204</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>205</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._names</span><span class="PUNC">[</span><span class="NAME">this._names.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>206</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>207</span> 
<span class='line'>208</span> </span><span class="COMM">/**
<span class='line'>209</span>  * Clones the properties of obj
<span class='line'>210</span>  * @private
<span class='line'>211</span>  * @param  {object} obj  The object to clone properties from
<span class='line'>212</span>  * @param  {boolean} supr If this is for extending or not
<span class='line'>213</span>  * @return {object}      The cloned object
<span class='line'>214</span>  */</span><span class="WHIT">
<span class='line'>215</span> </span><span class="NAME">Class.__clone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">supr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>216</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">supr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>217</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_super</span><span class="WHIT">  </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>218</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">args</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>219</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_this</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">args</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>220</span> </span><span class="WHIT">			</span><span class="NAME">args.splice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>221</span> </span><span class="WHIT">			</span><span class="COMM">// _this.__superWasCalled = true;</span><span class="WHIT">
<span class='line'>222</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj.apply</span><span class="PUNC">(</span><span class="NAME">_this</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>223</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>224</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">_super</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>225</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>226</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>227</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>228</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>229</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Array.isArray</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>230</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">obj.slice</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>231</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>232</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">temp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj.constructor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>233</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>234</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"super"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>235</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"__clone"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"isClass"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"new"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">key.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"__"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>236</span> </span><span class="WHIT">		</span><span class="NAME">temp</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.__clone</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">supr</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>237</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>238</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">temp</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>239</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>240</span> 
<span class='line'>241</span> </span><span class="COMM">/**
<span class='line'>242</span>  * Ìf something is a class or not
<span class='line'>243</span>  * @param  {dynamic}  obj The value to check
<span class='line'>244</span>  * @return {boolean}   If it's a class or not
<span class='line'>245</span>  */</span><span class="WHIT">
<span class='line'>246</span> </span><span class="NAME">Class.isClass</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>247</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>248</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>249</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="STRN">"_isClass"</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>250</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>251</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>252</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>253</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>254</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>255</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>256</span> 
<span class='line'>257</span> </span><span class="COMM">//////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>258</span> </span><span class="COMM">//////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>259</span> </span><span class="COMM">//////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>260</span> 
<span class='line'>261</span> 
<span class='line'>262</span> </span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">_baa_init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>263</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.canvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">'canvas'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>264</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics._defaultCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.canvas</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>265</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.canvas.getContext</span><span class="PUNC">(</span><span class="STRN">'2d'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>266</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics._defaultCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.ctx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>267</span> 
<span class='line'>268</span> </span><span class="WHIT">	</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"keydown"</span><span class="PUNC">,</span><span class="NAME">baa.keyboard._downHandler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>269</span> </span><span class="WHIT">	</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"keyup"</span><span class="PUNC">,</span><span class="NAME">baa.keyboard._upHandler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>270</span> </span><span class="WHIT">	</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"mousemove"</span><span class="PUNC">,</span><span class="NAME">baa.mouse._move</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>271</span> </span><span class="WHIT">	</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"mousedown"</span><span class="PUNC">,</span><span class="NAME">baa.mouse._downHandler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>272</span> </span><span class="WHIT">	</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"mouseup"</span><span class="PUNC">,</span><span class="NAME">baa.mouse._upHandler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>273</span> </span><span class="WHIT">	</span><span class="NAME">document.addEventListener</span><span class="PUNC">(</span><span class="STRN">"mousewheel"</span><span class="PUNC">,</span><span class="NAME">baa.mouse._wheelHandler</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>274</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>275</span> 
<span class='line'>276</span> </span><span class="COMM">/**
<span class='line'>277</span>  * baa.js is a library created by Daniël Haazen. It's heavily inspired by the LÖVE framework.
<span class='line'>278</span>  * @constructor
<span class='line'>279</span>  * @type {object}
<span class='line'>280</span>  */</span><span class="WHIT">
<span class='line'>281</span> </span><span class="NAME">baa</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>282</span> 
<span class='line'>283</span> </span><span class="COMM">/**
<span class='line'>284</span>  * Whether to use type safety. Is turned off in release-mode.
<span class='line'>285</span>  * @type {boolean}
<span class='line'>286</span>  */</span><span class="WHIT">
<span class='line'>287</span> </span><span class="NAME">baa._typesafe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>288</span> 
<span class='line'>289</span> </span><span class="COMM">/**
<span class='line'>290</span>  * Checks if the type of obj is one of the given types, and throws an error if it's not
<span class='line'>291</span>  * @param  {string} name The name of the object
<span class='line'>292</span>  * @param  {object} obj  The object
<span class='line'>293</span>  * @param {dynamic} ... The allowed types
<span class='line'>294</span>  */</span><span class="WHIT">
<span class='line'>295</span> </span><span class="NAME">baa._checkType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>296</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._typesafe</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>297</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>298</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>299</span> </span><span class="WHIT">	</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT">
<span class='line'>300</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">Array.isArray</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"array"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>301</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">clss</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">  </span><span class="NAME">Class.isClass</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>302</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>303</span> </span><span class="WHIT">		
<span class='line'>304</span> 		</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>305</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>306</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>307</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>308</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">clss</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj.is</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>309</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>310</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>311</span> </span><span class="WHIT">	
<span class='line'>312</span> 		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>313</span> </span><span class="WHIT">			</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">", "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>314</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>315</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>316</span> </span><span class="WHIT">	</span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Wrong type '"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"' for "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">". Correct types: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">str</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>317</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>318</span> 
<span class='line'>319</span> </span><span class="COMM">/**
<span class='line'>320</span>  * Number of assets that are loaded
<span class='line'>321</span>  * @type {number}
<span class='line'>322</span>  */</span><span class="WHIT">
<span class='line'>323</span> </span><span class="NAME">baa._assetsLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>324</span> 
<span class='line'>325</span> </span><span class="COMM">/**
<span class='line'>326</span>  * Total number of assets that have to be loaded before starting the program
<span class='line'>327</span>  * @type {number}
<span class='line'>328</span>  */</span><span class="WHIT">
<span class='line'>329</span> </span><span class="NAME">baa._assetsToBeLoaded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>330</span> 
<span class='line'>331</span> </span><span class="COMM">/**
<span class='line'>332</span>  * The object containing information for deltatime
<span class='line'>333</span>  * @constructor
<span class='line'>334</span>  * @type {object}
<span class='line'>335</span>  */</span><span class="WHIT">
<span class='line'>336</span> </span><span class="NAME">baa._time</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">dt</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">last</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>337</span> 
<span class='line'>338</span> </span><span class="COMM">/**
<span class='line'>339</span>  * Returns the current time
<span class='line'>340</span>  * @return {number} The current time
<span class='line'>341</span>  */</span><span class="WHIT">
<span class='line'>342</span> </span><span class="NAME">baa._time.stamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>343</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">window.performance</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">window.performance.now</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">window.performance.now</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Date</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">getTime</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>344</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>345</span> 
<span class='line'>346</span> </span><span class="COMM">/**
<span class='line'>347</span>  * The time of the previous loop
<span class='line'>348</span>  * @type {number}
<span class='line'>349</span>  */</span><span class="WHIT">
<span class='line'>350</span> </span><span class="NAME">baa._time.last</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa._time.stamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>351</span> 
<span class='line'>352</span> 
<span class='line'>353</span> </span><span class="COMM">//Point</span><span class="WHIT">
<span class='line'>354</span> </span><span class="COMM">//////////////////////////////////</span><span class="WHIT">
<span class='line'>355</span> 
<span class='line'>356</span> </span><span class="COMM">/**
<span class='line'>357</span>  * A point class. Containing an x and y.
<span class='line'>358</span>  * @constructor
<span class='line'>359</span>  * @property {number} x The horizontal position
<span class='line'>360</span>  * @property {number} y The vertical position
<span class='line'>361</span>  * @param  {number} [x=0] The horizontal position
<span class='line'>362</span>  * @param  {number} [y=x] The vertical position
<span class='line'>363</span>  * @type {Class}
<span class='line'>364</span>  */</span><span class="WHIT">
<span class='line'>365</span> </span><span class="NAME">baa.point</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.point"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>366</span> 
<span class='line'>367</span> 
<span class='line'>368</span> </span><span class="NAME">baa.point.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>369</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>370</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>371</span> </span><span class="WHIT">	
<span class='line'>372</span> 	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>373</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>374</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>375</span> 
<span class='line'>376</span> </span><span class="COMM">/**
<span class='line'>377</span>  * Sets the x and y of the point
<span class='line'>378</span>  * @param  {number} [x=0] The horizontal position
<span class='line'>379</span>  * @param  {number} [y=x] The vertical position
<span class='line'>380</span>  */</span><span class="WHIT">
<span class='line'>381</span> </span><span class="NAME">baa.point.set</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>382</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>383</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>384</span> 
<span class='line'>385</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>386</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>387</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>388</span> 
<span class='line'>389</span> </span><span class="COMM">/**
<span class='line'>390</span>  * Clones the x and y of another point
<span class='line'>391</span>  * @param  {baa.point} p The point to clone from
<span class='line'>392</span>  */</span><span class="WHIT">
<span class='line'>393</span> </span><span class="NAME">baa.point.clone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">point</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>394</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"point"</span><span class="PUNC">,</span><span class="NAME">point</span><span class="PUNC">,</span><span class="STRN">"baa.point"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>395</span> 
<span class='line'>396</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">point.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>397</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">point.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>398</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>399</span> 
<span class='line'>400</span> </span><span class="COMM">/**
<span class='line'>401</span>  * If the point overlaps with a rectangle
<span class='line'>402</span>  * @param  {baa.rectangle} r The rectangle you want to check overlap with
<span class='line'>403</span>  * @return {boolean}   If there is overlap
<span class='line'>404</span>  */</span><span class="WHIT">
<span class='line'>405</span> </span><span class="NAME">baa.point.overlaps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>406</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rect"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"baa.rect"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>407</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rect.width</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT">
<span class='line'>408</span> </span><span class="WHIT">		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rect.height</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>409</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>410</span> 
<span class='line'>411</span> </span><span class="COMM">//Rect</span><span class="WHIT">
<span class='line'>412</span> </span><span class="COMM">//////////////////////////////////</span><span class="WHIT">
<span class='line'>413</span> 
<span class='line'>414</span> </span><span class="COMM">/**
<span class='line'>415</span>  * A rectangle class. Extends baa.point with a width and height.
<span class='line'>416</span>  * @constructor
<span class='line'>417</span>  * @property {number} width The width of the rectangle
<span class='line'>418</span>  * @property {number} height The height of the rectangle
<span class='line'>419</span>  * @property {object} color The color of the rectangle. Use an array of 3 numbers.
<span class='line'>420</span>  * @param {number} [x=0] The horizontal position
<span class='line'>421</span>  * @param {number} [y=x] The vertical position
<span class='line'>422</span>  * @param {number} [width=0] The width
<span class='line'>423</span>  * @param {number} [height=width] The height
<span class='line'>424</span>  * @type {Class}
<span class='line'>425</span>  */</span><span class="WHIT">
<span class='line'>426</span> </span><span class="NAME">baa.rect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.extend</span><span class="PUNC">(</span><span class="STRN">"baa.rect"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>427</span> 
<span class='line'>428</span> </span><span class="NAME">baa.rect.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>429</span> </span><span class="WHIT">	</span><span class="NAME">baa.rect.super.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>430</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>431</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>432</span> 
<span class='line'>433</span> </span><span class="WHIT">	</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>434</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>435</span> </span><span class="WHIT">	</span><span class="NAME">this.color</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>436</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>437</span> 
<span class='line'>438</span> </span><span class="COMM">/**
<span class='line'>439</span>  * Draws the rectangle
<span class='line'>440</span>  * @param  {string} [mode="fill"] Whether to use fill, line or both when drawing
<span class='line'>441</span>  * @param  {number} r    How much rounding to use
<span class='line'>442</span>  */</span><span class="WHIT">
<span class='line'>443</span> </span><span class="NAME">baa.rect.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>444</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>445</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>446</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>447</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>448</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>449</span> 
<span class='line'>450</span> </span><span class="COMM">/**
<span class='line'>451</span>  * Sets new values for the rectangle
<span class='line'>452</span>  * @param  {number} [x=0] The horizontal position
<span class='line'>453</span>  * @param  {number} [y=x] The vertical position
<span class='line'>454</span>  * @param {number} [width=0] The width
<span class='line'>455</span>  * @param {number} [height=width] The height
<span class='line'>456</span>  * @override
<span class='line'>457</span>  */</span><span class="WHIT">
<span class='line'>458</span> </span><span class="NAME">baa.rect.set</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>459</span> </span><span class="WHIT">	</span><span class="NAME">baa.rect.super.set</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>460</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>461</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>462</span> 
<span class='line'>463</span> </span><span class="WHIT"> 	</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>464</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>465</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>466</span> 
<span class='line'>467</span> </span><span class="COMM">/**
<span class='line'>468</span>  * Clones the values of another rectangle
<span class='line'>469</span>  * @param  {baa.rectangle} r The rectangle to clone from
<span class='line'>470</span>  * @override
<span class='line'>471</span>  */</span><span class="WHIT">
<span class='line'>472</span> </span><span class="NAME">baa.rect.clone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>473</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rect"</span><span class="PUNC">,</span><span class="NAME">rect</span><span class="PUNC">,</span><span class="STRN">"baa.rect"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>474</span> 
<span class='line'>475</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>476</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>477</span> </span><span class="WHIT">	</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rect.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>478</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rect.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>479</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>480</span> 
<span class='line'>481</span> </span><span class="COMM">/**
<span class='line'>482</span>  * Sets and returns the left side of the rectangle
<span class='line'>483</span>  * @param  {number} [x] The horizontal position you want the left side to be at
<span class='line'>484</span>  * @return {number}   The horizontal position the left side is at
<span class='line'>485</span>  */</span><span class="WHIT">
<span class='line'>486</span> </span><span class="NAME">baa.rect.left</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>487</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>488</span> 
<span class='line'>489</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>490</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>491</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>492</span> 
<span class='line'>493</span> </span><span class="COMM">/**
<span class='line'>494</span>  * Sets and returns the right side of the rectangle
<span class='line'>495</span>  * @param  {number} [x] The horizontal position you want the right side to be at
<span class='line'>496</span>  * @return {number}   The horizontal position the right side is at
<span class='line'>497</span>  */</span><span class="WHIT">
<span class='line'>498</span> </span><span class="NAME">baa.rect.right</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>499</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>500</span> 
<span class='line'>501</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>502</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>503</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>504</span> 
<span class='line'>505</span> </span><span class="COMM">/**
<span class='line'>506</span>  * Sets and returns the top side of the rectangle
<span class='line'>507</span>  * @param  {number} [y] The vertical position you want the top side to be at
<span class='line'>508</span>  * @return {number}   The vertical position the top side is at
<span class='line'>509</span>  */</span><span class="WHIT">
<span class='line'>510</span> </span><span class="NAME">baa.rect.top</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>511</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>512</span> 
<span class='line'>513</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>514</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>515</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>516</span> 
<span class='line'>517</span> </span><span class="COMM">/**
<span class='line'>518</span>  * Sets and returns the bottom side of the rectangle
<span class='line'>519</span>  * @param  {number} [y] The vertical position you want the bottom side to be at
<span class='line'>520</span>  * @return {number}   The vertical position the bottom side is at
<span class='line'>521</span>  */</span><span class="WHIT">
<span class='line'>522</span> </span><span class="NAME">baa.rect.bottom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>523</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>524</span> 
<span class='line'>525</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>526</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>527</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>528</span> 
<span class='line'>529</span> </span><span class="COMM">/**
<span class='line'>530</span>  * Sets and returns the horizontal center of the rectangle
<span class='line'>531</span>  * @param  {number} [x] The horizontal position you want the horizontal center to be at
<span class='line'>532</span>  * @return {number}   The horizontal position the horizontal center is at
<span class='line'>533</span>  */</span><span class="WHIT">
<span class='line'>534</span> </span><span class="NAME">baa.rect.centerX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>535</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>536</span> 
<span class='line'>537</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>538</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>539</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>540</span> 
<span class='line'>541</span> </span><span class="COMM">/**
<span class='line'>542</span>  * Sets and returns the vertical center of the rectangle
<span class='line'>543</span>  * @param  {number} [y] The vertical position you want the vertical center to be at
<span class='line'>544</span>  * @return {number}   The vertical position the vertical center is at
<span class='line'>545</span>  */</span><span class="WHIT">
<span class='line'>546</span> </span><span class="NAME">baa.rect.centerY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>547</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>548</span> 
<span class='line'>549</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>550</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>551</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>552</span> 
<span class='line'>553</span> </span><span class="COMM">/**
<span class='line'>554</span>  * If the rectangle overlaps with another rectangle or point
<span class='line'>555</span>  * @param  {baa.rectangle|baa.point} r The rectangle or point you want to check overlap with
<span class='line'>556</span>  * @return {boolean}   If there is overlap
<span class='line'>557</span>  * @override
<span class='line'>558</span>  */</span><span class="WHIT">
<span class='line'>559</span> </span><span class="NAME">baa.rect.overlaps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>560</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rect"</span><span class="PUNC">,</span><span class="NAME">rect</span><span class="PUNC">,</span><span class="STRN">"baa.rect"</span><span class="PUNC">,</span><span class="STRN">"baa.point"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>561</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect.width</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> 
<span class='line'>562</span> 		</span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect.height</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>563</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>564</span> 
<span class='line'>565</span> </span><span class="COMM">/**
<span class='line'>566</span>  * If the rectangle overlaps horizontally with another rectangle or point
<span class='line'>567</span>  * @param  {baa.rectangle|baa.point} r The rectangle or point you want to check horizontal overlap with
<span class='line'>568</span>  * @return {boolean}   If there is horizontal overlap
<span class='line'>569</span>  */</span><span class="WHIT">
<span class='line'>570</span> </span><span class="NAME">baa.rect.overlapsX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>571</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rect"</span><span class="PUNC">,</span><span class="NAME">rect</span><span class="PUNC">,</span><span class="STRN">"baa.rect"</span><span class="PUNC">,</span><span class="STRN">"baa.point"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>572</span> 
<span class='line'>573</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">rect.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>574</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>575</span> 
<span class='line'>576</span> </span><span class="COMM">/**
<span class='line'>577</span>  * If the rectangle overlaps vertically with another rectangle or point
<span class='line'>578</span>  * @param  {baa.rectangle|baa.point} r The rectangle or point you want to check vertical overlap with
<span class='line'>579</span>  * @return {boolean}   If there is vertical overlap
<span class='line'>580</span>  */</span><span class="WHIT">
<span class='line'>581</span> </span><span class="NAME">baa.rect.overlapsY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>582</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rect"</span><span class="PUNC">,</span><span class="NAME">rect</span><span class="PUNC">,</span><span class="STRN">"baa.rect"</span><span class="PUNC">,</span><span class="STRN">"baa.point"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>583</span> 
<span class='line'>584</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>585</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>586</span> 
<span class='line'>587</span> </span><span class="COMM">//Circle</span><span class="WHIT">
<span class='line'>588</span> </span><span class="COMM">///////////////////////////////</span><span class="WHIT">
<span class='line'>589</span> 
<span class='line'>590</span> </span><span class="COMM">/**
<span class='line'>591</span>  * A circle class. Extends baa.point with a size
<span class='line'>592</span>  * @constructor
<span class='line'>593</span>  * @property {number} size The size of the circle
<span class='line'>594</span>  * @property {array} color The color of the circle. Use an array of 3 numbers.
<span class='line'>595</span>  * @param {number} [x=0] The horizontal position
<span class='line'>596</span>  * @param {number} [y=x] The vertical position
<span class='line'>597</span>  * @param {number} [size=0] The size
<span class='line'>598</span>  * @type {Class}
<span class='line'>599</span>  */</span><span class="WHIT">
<span class='line'>600</span> </span><span class="NAME">baa.circle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.extend</span><span class="PUNC">(</span><span class="STRN">"baa.circle"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>601</span> 
<span class='line'>602</span> </span><span class="NAME">baa.circle.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>603</span> </span><span class="WHIT">	</span><span class="NAME">baa.circle.super.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>604</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"size"</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>605</span> 
<span class='line'>606</span> </span><span class="WHIT">	</span><span class="NAME">this.size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">size</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>607</span> </span><span class="WHIT">	</span><span class="NAME">this.color</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>608</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>609</span> 
<span class='line'>610</span> </span><span class="COMM">/**
<span class='line'>611</span>  * Draws the circle
<span class='line'>612</span>  * @param  {string} mode Wether to use fill, line or both when drawing
<span class='line'>613</span>  */</span><span class="WHIT">
<span class='line'>614</span> </span><span class="NAME">baa.circle.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>615</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>616</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NAME">this.color</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>617</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>618</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.circle</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>619</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>620</span> 
<span class='line'>621</span> </span><span class="COMM">/**
<span class='line'>622</span>  * Sets new values for the circle
<span class='line'>623</span>  * @param  {number} [x=0] The horizontal position
<span class='line'>624</span>  * @param  {number} [y=x] The vertical position
<span class='line'>625</span>  * @param {number} [size=0] The size
<span class='line'>626</span>  * @override
<span class='line'>627</span>  */</span><span class="WHIT">
<span class='line'>628</span> </span><span class="NAME">baa.circle.set</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>629</span> </span><span class="WHIT">	</span><span class="NAME">baa.circle.super.init</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>630</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"size"</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>631</span> 
<span class='line'>632</span> </span><span class="WHIT">	</span><span class="NAME">this.size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">size</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>633</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>634</span> 
<span class='line'>635</span> </span><span class="COMM">/**
<span class='line'>636</span>  * Clones the values of another circle
<span class='line'>637</span>  * @param  {baa.circle} r The circle to clone from
<span class='line'>638</span>  * @override
<span class='line'>639</span>  */</span><span class="WHIT">
<span class='line'>640</span> </span><span class="NAME">baa.circle.clone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">circle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>641</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"circle"</span><span class="PUNC">,</span><span class="NAME">circle</span><span class="PUNC">,</span><span class="STRN">"baa.circle"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>642</span> 
<span class='line'>643</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">circle.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>644</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">circle.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>645</span> </span><span class="WHIT">	</span><span class="NAME">this.size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">circle.size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>646</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>647</span> 
<span class='line'>648</span> </span><span class="COMM">/**
<span class='line'>649</span>  * If the circle overlaps with another circle or point
<span class='line'>650</span>  * @param  {baa.circle|baa.point} r The circle or point you want to check overlap with
<span class='line'>651</span>  * @return {boolean}   If there is overlap
<span class='line'>652</span>  * @override
<span class='line'>653</span>  */</span><span class="WHIT">
<span class='line'>654</span> </span><span class="NAME">baa.circle.overlaps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">circle</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>655</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"circle"</span><span class="PUNC">,</span><span class="NAME">circle</span><span class="PUNC">,</span><span class="STRN">"baa.circle"</span><span class="PUNC">,</span><span class="STRN">"baa.point"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>656</span> 
<span class='line'>657</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">circle.x</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">circle.y</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.size</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">circle.size</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>658</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>659</span> 
<span class='line'>660</span> 
<span class='line'>661</span> </span><span class="COMM">//Sprite</span><span class="WHIT">
<span class='line'>662</span> </span><span class="COMM">//////////////////////////////</span><span class="WHIT">
<span class='line'>663</span> 
<span class='line'>664</span> </span><span class="COMM">/**
<span class='line'>665</span>  * A sprite class. Extends baa.rectangle with image and animations.
<span class='line'>666</span>  * @constructor
<span class='line'>667</span>  * @property {baa.point} origin The point the object is rotated around and scaled to
<span class='line'>668</span>  * @property {baa.point} offset How far the image should be drawn from the hitbox
<span class='line'>669</span>  * @property {baa.point} scale How much the image should scale
<span class='line'>670</span>  * @property {number} alpha The opacity of the sprite. Use a value between 0 and 1.
<span class='line'>671</span>  * @property {number} angle The angle of the image in radians
<span class='line'>672</span>  * @property {boolean} flip If the image should be mirrored. Useful for characters walking left and right.
<span class='line'>673</span>  * @property {boolean} visible If the sprite should be drawn
<span class='line'>674</span>  * @property {baa._image} image The image to draw
<span class='line'>675</span>  * @property {array} _frames The frames the sprite has and can be used to make animations with
<span class='line'>676</span>  * @property {object} _animations The animations that are made
<span class='line'>677</span>  * @property {number} _animTimer Counts up during animation and rounds up to get current frame
<span class='line'>678</span>  * @property {number} _animTimerDir The direction _animTimer goes to. 1 for up, -1 for down.
<span class='line'>679</span>  * @property {number} _currentFrame At what frame the animation currently is
<span class='line'>680</span>  * @property {string} _currentAnim The animation currently in use
<span class='line'>681</span>  * @property {boolean} _animPlaying Whether the animation is playing at the moment
<span class='line'>682</span>  * @property {boolean} _animEnded Whether the animation has ended
<span class='line'>683</span>  * @param {number} [x=0] The horizontal position
<span class='line'>684</span>  * @param {number} [y=x] The vertical position
<span class='line'>685</span>  * @param {number} [width=0] The width
<span class='line'>686</span>  * @param {number} [height=width] The height
<span class='line'>687</span>  * @type {Class}
<span class='line'>688</span>  */</span><span class="WHIT">
<span class='line'>689</span> </span><span class="NAME">baa.sprite</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.extend</span><span class="PUNC">(</span><span class="STRN">"baa.sprite"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>690</span> 
<span class='line'>691</span> </span><span class="NAME">baa.sprite.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>692</span> </span><span class="WHIT">	</span><span class="NAME">baa.sprite.super.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>693</span> </span><span class="WHIT">	</span><span class="NAME">this.origin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>694</span> </span><span class="WHIT">	</span><span class="NAME">this.offset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>695</span> </span><span class="WHIT">	</span><span class="NAME">this.scale</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>696</span> </span><span class="WHIT">	</span><span class="NAME">this.alpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>697</span> </span><span class="WHIT">	</span><span class="NAME">this.angle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>698</span> </span><span class="WHIT">	</span><span class="NAME">this.flip</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>699</span> </span><span class="WHIT">	</span><span class="NAME">this.visible</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>700</span> 
<span class='line'>701</span> </span><span class="WHIT">	</span><span class="NAME">this.image</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>702</span> </span><span class="WHIT">	</span><span class="NAME">this._frames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>703</span> </span><span class="WHIT">	</span><span class="NAME">this._animations</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>704</span> </span><span class="WHIT">	</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>705</span> </span><span class="WHIT">	</span><span class="NAME">this._animTimerDir</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>706</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>707</span> </span><span class="WHIT">	</span><span class="NAME">this._currentAnim</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"idle"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>708</span> </span><span class="WHIT">	</span><span class="NAME">this._animPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>709</span> </span><span class="WHIT">	</span><span class="NAME">this._animEnded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>710</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>711</span> 
<span class='line'>712</span> </span><span class="COMM">/**
<span class='line'>713</span>  * Updates the sprite
<span class='line'>714</span>  */</span><span class="WHIT">
<span class='line'>715</span> </span><span class="NAME">baa.sprite.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>716</span> </span><span class="WHIT">	</span><span class="NAME">this.animate</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>717</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>718</span> 
<span class='line'>719</span> </span><span class="COMM">/**
<span class='line'>720</span>  * Draws the image. If no image is assigned, it will draw a rectangle instead.
<span class='line'>721</span>  */</span><span class="WHIT">
<span class='line'>722</span> </span><span class="NAME">baa.sprite.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>723</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.visible</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>724</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.image</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>725</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NAME">this.alpha</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>726</span> </span><span class="WHIT">			</span><span class="NAME">this.image.draw</span><span class="PUNC">(</span><span class="NAME">this._frames</span><span class="PUNC">[</span><span class="NAME">this._currentFrame</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>727</span> </span><span class="WHIT">			</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NAME">this.offset.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.origin.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NAME">this.offset.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.origin.y</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>728</span> </span><span class="WHIT">			</span><span class="NAME">this.angle</span><span class="PUNC">,</span><span class="NAME">this.flip</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">this.scale.x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this.scale.x</span><span class="PUNC">,</span><span class="NAME">this.scale.y</span><span class="PUNC">,</span><span class="NAME">this.origin.x</span><span class="PUNC">,</span><span class="NAME">this.origin.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>729</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>730</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>731</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>732</span> </span><span class="WHIT">			</span><span class="NAME">baa.sprite.super.draw</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>733</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>734</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>735</span> 
<span class='line'>736</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">baa.debug.active</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>737</span> </span><span class="WHIT">		</span><span class="NAME">this.drawDebug</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>738</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>739</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>740</span> 
<span class='line'>741</span> </span><span class="COMM">/**
<span class='line'>742</span>  * Draws debug lines. This is called when baa.debug is active.
<span class='line'>743</span>  */</span><span class="WHIT">
<span class='line'>744</span> </span><span class="NAME">baa.sprite.drawDebug</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>745</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>746</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setLineWidth</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>747</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>748</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>749</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>750</span> 
<span class='line'>751</span> </span><span class="COMM">/**
<span class='line'>752</span>  * Sets the given image. Makes frames based on the given width and height. Automatically centers the origin based on the width and height.
<span class='line'>753</span>  * @example
<span class='line'>754</span>  * //The sprite's width and height become that of the image.
<span class='line'>755</span>  * this.setImage("player");
<span class='line'>756</span>  *
<span class='line'>757</span>  * //the image is cut down to smaller images, frames, that can be used for animations.
<span class='line'>758</span>  * this.setImage("player",16,16);
<span class='line'>759</span>  * @param {string} url    The url of the string
<span class='line'>760</span>  * @param {number} [width]  The width of the frames
<span class='line'>761</span>  * @param {number} [height] The height of the frames
<span class='line'>762</span>  * @param {boolean} [smooth] If the image should use smoothing when drawing
<span class='line'>763</span>  */</span><span class="WHIT">
<span class='line'>764</span> </span><span class="NAME">baa.sprite.setImage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>765</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"url"</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>766</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>767</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>768</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"smooth"</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>769</span> 
<span class='line'>770</span> </span><span class="WHIT">	</span><span class="NAME">this.image</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.newImage</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>771</span> </span><span class="WHIT">	</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.image.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>772</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.image.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>773</span> </span><span class="WHIT">	</span><span class="NAME">this._frames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>774</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.image.getHeight</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.height</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>775</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.image.getWidth</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NAME">this.width</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>776</span> </span><span class="WHIT">			</span><span class="NAME">this._frames.push</span><span class="PUNC">(</span><span class="PUNC">{</span><span class="NAME">x</span><span class="PUNC">:</span><span class="NAME">j</span><span class="PUNC">*</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">:</span><span class="NAME">i</span><span class="PUNC">*</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">:</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">:</span><span class="NAME">this.height</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>777</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>778</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>779</span> </span><span class="WHIT">	</span><span class="NAME">this.centerOrigin</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>780</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>781</span> 
<span class='line'>782</span> </span><span class="COMM">/**
<span class='line'>783</span>  * Centers the origin. This is automatically called by setImage
<span class='line'>784</span>  */</span><span class="WHIT">
<span class='line'>785</span> </span><span class="NAME">baa.sprite.centerOrigin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>786</span> </span><span class="WHIT">	</span><span class="NAME">this.origin.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>787</span> </span><span class="WHIT">	</span><span class="NAME">this.origin.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>788</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>789</span> 
<span class='line'>790</span> </span><span class="COMM">/**
<span class='line'>791</span>  * Adds an animation
<span class='line'>792</span>  * @param {string} name   The name of the animation
<span class='line'>793</span>  * @param {number[]} frames  The frames the animation. Use numbers between 1 and the number of frames.
<span class='line'>794</span>  * @param {number} [speed=12]  The speed the animations plays with
<span class='line'>795</span>  * @param {string} [mode="loop"]   The loop mode. "loop" for looping, "once" for the animation playing only once,
<span class='line'>796</span>  *  and "pingpong" for the animation to go back and forth.
<span class='line'>797</span>  * @param {number} [semi=0]	When ended, and looping, where the frame should start from instead. 
<span class='line'>798</span>  * Useful for animations with a starting animation you only want to play once.   
<span class='line'>799</span>  */</span><span class="WHIT">
<span class='line'>800</span> </span><span class="NAME">baa.sprite.addAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">frames</span><span class="PUNC">,</span><span class="NAME">speed</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">semi</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>801</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"name"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>802</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"frames"</span><span class="PUNC">,</span><span class="NAME">frames</span><span class="PUNC">,</span><span class="STRN">"array"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>803</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"speed"</span><span class="PUNC">,</span><span class="NAME">speed</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>804</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>805</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"semi"</span><span class="PUNC">,</span><span class="NAME">semi</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>806</span> 
<span class='line'>807</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>808</span> </span><span class="WHIT">	</span><span class="NAME">obj.frames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frames</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>809</span> </span><span class="WHIT">	</span><span class="NAME">obj.numberOfFrames</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frames.length</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>810</span> </span><span class="WHIT">	</span><span class="NAME">obj.speed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">speed</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">12</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>811</span> </span><span class="WHIT">	</span><span class="NAME">obj.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"loop"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>812</span> </span><span class="WHIT">	</span><span class="NAME">obj.semi</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">semi</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>813</span> 
<span class='line'>814</span> </span><span class="WHIT">	</span><span class="NAME">this._animations</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>815</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>816</span> 
<span class='line'>817</span> </span><span class="COMM">/**
<span class='line'>818</span>  * Handles the animating. Is automatically called by update.
<span class='line'>819</span>  */</span><span class="WHIT">
<span class='line'>820</span> </span><span class="NAME">baa.sprite.animate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>821</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._animPlaying</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>822</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._animations.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">this._currentAnim</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>823</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">anim</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._animations</span><span class="PUNC">[</span><span class="NAME">this._currentAnim</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>824</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anim.numberOfFrames</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>825</span> </span><span class="WHIT">				</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>826</span> </span><span class="WHIT">				</span><span class="NAME">this._currentFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim.frames</span><span class="PUNC">[</span><span class="NAME">this._animTimer</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>827</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>828</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>829</span> 
<span class='line'>830</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">anim.speed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>831</span> </span><span class="WHIT">				</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim.speed</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this._animTimerDir</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>832</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>833</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>834</span> </span><span class="WHIT">				</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim.speed</span><span class="PUNC">[</span><span class="NAME">this._currentFrame</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this._animTimerDir</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>835</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>836</span> 
<span class='line'>837</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">anim.numberOfFrames</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>838</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anim.mode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"loop"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>839</span> </span><span class="WHIT">					</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim.semi</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>840</span> </span><span class="WHIT">					</span><span class="NAME">this._animEnded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>841</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>842</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anim.mode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"once"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>843</span> </span><span class="WHIT">					</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim.finish</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>844</span> </span><span class="WHIT">					</span><span class="NAME">this._animPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>845</span> </span><span class="WHIT">					</span><span class="NAME">this._animEnded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>846</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>847</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anim.mode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"pingpong"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>848</span> </span><span class="WHIT">					</span><span class="NAME">this._animTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._animTimerDir</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">anim.numberOfFrames</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>849</span> </span><span class="WHIT">					</span><span class="NAME">this._animTimerDir</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">this._animTimerDir</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>850</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>851</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>852</span> 
<span class='line'>853</span> </span><span class="WHIT">			</span><span class="NAME">this._currentFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim.frames</span><span class="PUNC">[</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">this._animTimer</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>854</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>855</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>856</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>857</span> 
<span class='line'>858</span> </span><span class="COMM">/**
<span class='line'>859</span>  * Plays the animation
<span class='line'>860</span>  */</span><span class="WHIT">
<span class='line'>861</span> </span><span class="NAME">baa.sprite.playAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>862</span> </span><span class="WHIT">	</span><span class="NAME">this._animPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>863</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>864</span> 
<span class='line'>865</span> </span><span class="COMM">/**
<span class='line'>866</span>  * Pauses the animation
<span class='line'>867</span>  */</span><span class="WHIT">
<span class='line'>868</span> </span><span class="NAME">baa.sprite.pauseAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>869</span> </span><span class="WHIT">	</span><span class="NAME">this._animPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>870</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>871</span> 
<span class='line'>872</span> </span><span class="COMM">/**
<span class='line'>873</span>  * Stops the animation, and goes back to the first frame.
<span class='line'>874</span>  */</span><span class="WHIT">
<span class='line'>875</span> </span><span class="NAME">baa.sprite.stopAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>876</span> </span><span class="WHIT">	</span><span class="NAME">this._animPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>877</span> </span><span class="WHIT">	</span><span class="NAME">this.setAnimationFrame</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>878</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>879</span> 
<span class='line'>880</span> </span><span class="COMM">/**
<span class='line'>881</span>  * Sets the frame to 1, and plays the animation.
<span class='line'>882</span>  */</span><span class="WHIT">
<span class='line'>883</span> </span><span class="NAME">baa.sprite.replayAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>884</span> </span><span class="WHIT">	</span><span class="NAME">this._animPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>885</span> </span><span class="WHIT">	</span><span class="NAME">this.setAnimationFrame</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>886</span> </span><span class="WHIT">	</span><span class="NAME">this._animEnded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>887</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>888</span> 
<span class='line'>889</span> </span><span class="COMM">/**
<span class='line'>890</span>  * Whether the animation has ended
<span class='line'>891</span>  */</span><span class="WHIT">
<span class='line'>892</span> </span><span class="NAME">baa.sprite.hasAnimationEnded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>893</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._animEnded</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>894</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>895</span> 
<span class='line'>896</span> </span><span class="COMM">/**
<span class='line'>897</span>  * Whether the animation is playing
<span class='line'>898</span>  */</span><span class="WHIT">
<span class='line'>899</span> </span><span class="NAME">baa.sprite.isAnimationPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>900</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._animPlaying</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>901</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>902</span> 
<span class='line'>903</span> </span><span class="COMM">/**
<span class='line'>904</span>  * Sets the animation to be played. Has no effect when the current animation is the same as the given one. Unless you use force.
<span class='line'>905</span>  * @param {string} anim  The name of the animation
<span class='line'>906</span>  * @param {boolean} force Forces the animation to be set to the given animation, even when the current animiation is already the given one.
<span class='line'>907</span>  */</span><span class="WHIT">
<span class='line'>908</span> </span><span class="NAME">baa.sprite.setAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anim</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>909</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"anim"</span><span class="PUNC">,</span><span class="NAME">anim</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>910</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"force"</span><span class="PUNC">,</span><span class="NAME">force</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>911</span> 
<span class='line'>912</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._currentAnim</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">anim</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>913</span> </span><span class="WHIT">		</span><span class="NAME">this._currentAnim</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">anim</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>914</span> </span><span class="WHIT">		</span><span class="NAME">this._animEnded</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>915</span> </span><span class="WHIT">		</span><span class="NAME">this._frameTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._animations</span><span class="PUNC">[</span><span class="NAME">anim</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>916</span> </span><span class="WHIT">		</span><span class="NAME">this._frameTimerDir</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>917</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>918</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>919</span> 
<span class='line'>920</span> </span><span class="COMM">/**
<span class='line'>921</span>  * Returns the name of the current animation
<span class='line'>922</span>  * @return {string} The current animation
<span class='line'>923</span> 
<span class='line'>924</span>  */</span><span class="WHIT">
<span class='line'>925</span> </span><span class="NAME">baa.sprite.getAnimation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>926</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._currentAnim</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>927</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>928</span> 
<span class='line'>929</span> </span><span class="COMM">/**
<span class='line'>930</span>  * Sets the frame of the animation
<span class='line'>931</span>  * @throws {Error} If frame is higher than the number of frames the current animation has.
<span class='line'>932</span>  * @param {number} frame The frame to set
<span class='line'>933</span>  */</span><span class="WHIT">
<span class='line'>934</span> </span><span class="NAME">baa.sprite.setAnimationFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">frame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>935</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"frame"</span><span class="PUNC">,</span><span class="NAME">frame</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>936</span> 
<span class='line'>937</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">anim</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._animations</span><span class="PUNC">[</span><span class="NAME">this._currentAnim</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>938</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">anim.numberOfFrames</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">frame</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>939</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"There are only "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">anim.numberOfFrames</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="STRN">" frames. Not "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">frame</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>940</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>941</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frame</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>942</span> </span><span class="WHIT">	</span><span class="NAME">this._frameTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">frame</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>943</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>944</span> 
<span class='line'>945</span> </span><span class="COMM">/**
<span class='line'>946</span>  * Returns the current frame
<span class='line'>947</span>  * @return {number} The current frame
<span class='line'>948</span>  */</span><span class="WHIT">
<span class='line'>949</span> </span><span class="NAME">baa.sprite.getAnimationFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>950</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._currentFrame</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>951</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>952</span> 
<span class='line'>953</span> </span><span class="COMM">//TODO: Maybe seperate animation from sprite, to be its own class</span><span class="WHIT">
<span class='line'>954</span> 
<span class='line'>955</span> 
<span class='line'>956</span> 
<span class='line'>957</span> </span><span class="COMM">//Entity</span><span class="WHIT">
<span class='line'>958</span> </span><span class="COMM">//////////////////////////////</span><span class="WHIT">
<span class='line'>959</span> 
<span class='line'>960</span> </span><span class="COMM">/**
<span class='line'>961</span>  * An entity class. Extends baa.sprite with collision-handling and movement.
<span class='line'>962</span>  * @constructor
<span class='line'>963</span>  * @property {baa.rect} last The previous values of the entity. Useful for checking direction.
<span class='line'>964</span>  * @property {baa.point} velocity The velocity the entity moves with
<span class='line'>965</span>  * @property {baa.point} accel The amount the entity accelerates with. The higher the value, the fast the entity accelerates.
<span class='line'>966</span>  * @property {baa.point} drag The amount of drag the entity has. Is only used when accel[axis] is 0. The higher the value, the faster the entity slows down. 
<span class='line'>967</span>  * @property {baa.point} bounce How much the entity should bounce when colliding. 2 would make it go twice as fast.
<span class='line'>968</span>  * @property {number} separatePriority This decides which of the colliding entities will be moved from it's original position. The lower priority will be moved.
<span class='line'>969</span>  * @property {boolean} solid If false, the entity will not handle collision, and is not effected by other solid objects.
<span class='line'>970</span>  * @property {boolean} dead If true, the entity wil lstop updating and drawing, and has no collision anymore with other entities. 
<span class='line'>971</span>  * @param {number} [x=0] The horizontal position
<span class='line'>972</span>  * @param {number} [y=x] The vertical position
<span class='line'>973</span>  * @param {number} [width=0] The width
<span class='line'>974</span>  * @param {number} [height=width] The height
<span class='line'>975</span>  */</span><span class="WHIT">
<span class='line'>976</span> </span><span class="NAME">baa.entity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.sprite.extend</span><span class="PUNC">(</span><span class="STRN">"baa.entity"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>977</span> 
<span class='line'>978</span> </span><span class="NAME">baa.entity.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>979</span> </span><span class="WHIT">	</span><span class="NAME">baa.entity.super.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>980</span> </span><span class="WHIT">	</span><span class="NAME">this.last</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>981</span> </span><span class="WHIT">	</span><span class="NAME">this.velocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>982</span> </span><span class="WHIT">	</span><span class="NAME">this.maxVelocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="NUMB">99999</span><span class="PUNC">,</span><span class="NUMB">99999</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>983</span> </span><span class="WHIT">	</span><span class="NAME">this.accel</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>984</span> </span><span class="WHIT">	</span><span class="NAME">this.drag</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>985</span> </span><span class="WHIT">	</span><span class="NAME">this.bounce</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>986</span> 
<span class='line'>987</span> </span><span class="WHIT">	</span><span class="NAME">this.separatePriority</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>988</span> </span><span class="WHIT">	</span><span class="NAME">this.solid</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>989</span> </span><span class="WHIT">	</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>990</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>991</span> 
<span class='line'>992</span> </span><span class="COMM">/**
<span class='line'>993</span>  * Updates the entity
<span class='line'>994</span>  */</span><span class="WHIT">
<span class='line'>995</span> </span><span class="NAME">baa.entity.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>996</span> </span><span class="WHIT">	</span><span class="NAME">baa.entity.super.update</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>997</span> </span><span class="WHIT">	</span><span class="NAME">this.updateMovement</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>998</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>999</span> 
<span class='line'>1000</span> </span><span class="COMM">/**
<span class='line'>1001</span>  * Draws the entity. If baa.debug is active, it will call baa.entity.drawDebug as well.
<span class='line'>1002</span>  */</span><span class="WHIT">
<span class='line'>1003</span> </span><span class="NAME">baa.entity.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1004</span> </span><span class="WHIT">	</span><span class="NAME">baa.entity.super.draw</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1005</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1006</span> 
<span class='line'>1007</span> </span><span class="COMM">/**
<span class='line'>1008</span>  * Updates the movement. Acceleration is added to the velocity. The position moves with velocity, and the velocity is lowered with drag.
<span class='line'>1009</span>  */</span><span class="WHIT">
<span class='line'>1010</span> </span><span class="NAME">baa.entity.updateMovement</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1011</span> </span><span class="WHIT">	</span><span class="NAME">this.last.clone</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1012</span> 
<span class='line'>1013</span> </span><span class="WHIT">	</span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.accel.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1014</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.velocity.x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.maxVelocity.x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1015</span> </span><span class="WHIT">		</span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.maxVelocity.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1016</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1017</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1018</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.accel.x</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.drag.x</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1019</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.drag.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.velocity.x</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1020</span> </span><span class="WHIT">			</span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1021</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1022</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1023</span> </span><span class="WHIT">			</span><span class="NAME">this.velocity.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.drag.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.velocity.x</span><span class="PUNC">></span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1024</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1025</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1026</span> 
<span class='line'>1027</span> </span><span class="WHIT">	</span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.accel.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1028</span> 
<span class='line'>1029</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.velocity.y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.maxVelocity.y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1030</span> </span><span class="WHIT">		</span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.maxVelocity.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1031</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1032</span> 
<span class='line'>1033</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1034</span> 
<span class='line'>1035</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.accel.y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.drag.y</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1036</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.drag.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.velocity.y</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1037</span> </span><span class="WHIT">			</span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1038</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1039</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1040</span> </span><span class="WHIT">			</span><span class="NAME">this.velocity.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.drag.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.velocity.y</span><span class="PUNC">></span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1041</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1042</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1043</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1044</span> 
<span class='line'>1045</span> </span><span class="COMM">/**
<span class='line'>1046</span>  * Checks if there is collision with the given entity, and calls baa.entity.onOverlap if so.
<span class='line'>1047</span>  * @param  {baa.entity} e The entity you want to check collision with
<span class='line'>1048</span>  */</span><span class="WHIT">
<span class='line'>1049</span> </span><span class="NAME">baa.entity.resolveCollision</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1050</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.overlaps</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1051</span> </span><span class="WHIT">		</span><span class="NAME">this.onOverlap</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1052</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1053</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1054</span> 
<span class='line'>1055</span> </span><span class="COMM">/**
<span class='line'>1056</span>  * Extends baa.rect.overlaps by checking if both entities aren't dead.
<span class='line'>1057</span>  * @param  {baa.entity} e The entity you want to check collision with
<span class='line'>1058</span>  * @return {boolean}   If there is collision
<span class='line'>1059</span>  */</span><span class="WHIT">
<span class='line'>1060</span> </span><span class="NAME">baa.entity.overlaps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1061</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">e</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">e.dead</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">baa.entity.super.overlaps</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1062</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1063</span> 
<span class='line'>1064</span> </span><span class="COMM">/**
<span class='line'>1065</span>  * Called by baa.entity.resolveCollision when there is overlap. Calls baa.entity.separate if both entities are solid.
<span class='line'>1066</span>  * @param  {baa.entity} e The entity there is overlap with
<span class='line'>1067</span>  */</span><span class="WHIT">
<span class='line'>1068</span> </span><span class="NAME">baa.entity.onOverlap</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1069</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.solid</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">e.solid</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1070</span> </span><span class="WHIT">		</span><span class="NAME">this.separate</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1071</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> 
<span class='line'>1072</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1073</span> 
<span class='line'>1074</span> </span><span class="COMM">/**
<span class='line'>1075</span>  * Calls baa.entity.separateAxis. This wrapper handles the arguments it gives by checking if there was also overlap with this.last and e.last.
<span class='line'>1076</span>  * @param  {baa.entity} e The entity to separate from
<span class='line'>1077</span>  * @return {[type]}   [description]
<span class='line'>1078</span>  */</span><span class="WHIT">
<span class='line'>1079</span> </span><span class="NAME">baa.entity.separate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1080</span> </span><span class="WHIT">	</span><span class="NAME">this.separateAxis</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.last.overlapsY</span><span class="PUNC">(</span><span class="NAME">e.last</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"x"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"y"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1081</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1082</span> 
<span class='line'>1083</span> </span><span class="COMM">/**
<span class='line'>1084</span>  * Separates itself from the collided entity, or the other way around, based on their separatePriority.
<span class='line'>1085</span>  * @param  {baa.entity} e The entity to separate from
<span class='line'>1086</span>  * @param  {string} a The axis used to seperate from the entity
<span class='line'>1087</span>  */</span><span class="WHIT">
<span class='line'>1088</span> </span><span class="NAME">baa.entity.separateAxis</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1089</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">s</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"x"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"width"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"height"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1090</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.separatePriority</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NAME">e.separatePriority</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1091</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">e.last</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">e.last</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.last</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.last</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1092</span> </span><span class="WHIT">			</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1093</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1094</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1095</span> </span><span class="WHIT">			</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">s</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1096</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1097</span> </span><span class="WHIT">		</span><span class="NAME">e.velocity</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">e.velocity</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">e.bounce</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1098</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1099</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1100</span> </span><span class="WHIT">		</span><span class="NAME">e.separateAxis</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1101</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1102</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1103</span> 
<span class='line'>1104</span> 
<span class='line'>1105</span> </span><span class="COMM">//Button</span><span class="WHIT">
<span class='line'>1106</span> </span><span class="COMM">//////////////////////////////</span><span class="WHIT">
<span class='line'>1107</span> 
<span class='line'>1108</span> </span><span class="COMM">/**
<span class='line'>1109</span>  * A button that can call functions when you click on it. You can make the shape of the button either squared or round.
<span class='line'>1110</span>  * By default, buttons won't activate until you release them.
<span class='line'>1111</span>  * @constructor
<span class='line'>1112</span>  * @property {string} shape The shape of the button. The default shape can be set by changing baa.button.defaultShape.
<span class='line'>1113</span>  * @property {boolean} hold If the button is currently hold down.
<span class='line'>1114</span>  * @property {object} obj The object that is used for calling the function.
<span class='line'>1115</span>  * @property {function|string} func The function you want to call when the button is pressed.
<span class='line'>1116</span>  * @property {function|string} func The function you want to call when the button is pressed.
<span class='line'>1117</span> *  @property {boolean} [onRelease=true] If the button should be activated on release. If this is false, it will be activated on press.
<span class='line'>1118</span> *  @property {string|array} [buttons="l"] What button(s) can activate this button.
<span class='line'>1119</span>  * This can either be the name of the function as string, or a function on its own.
<span class='line'>1120</span>  * @param {number} x The horizontal position of the button. 
<span class='line'>1121</span>  * @param {number} y The vertical position of the button.
<span class='line'>1122</span>  * @param {object} [obj] The object that is used for calling the function.
<span class='line'>1123</span>  * @param {function|string} [func] The function you want to call when the button is pressed.
<span class='line'>1124</span>  * This can either be the name of the function as string, or a function on its own. 
<span class='line'>1125</span>  * @param {string} [shape] The shape of the button. The default shape can be set by changing baa.button.defaultShape.
<span class='line'>1126</span>  * @param {boolean} [onRelease=true] If the button should be activated on release. If this is false, it will be activated on press. 
<span class='line'>1127</span>  */</span><span class="WHIT">
<span class='line'>1128</span> </span><span class="NAME">baa.button</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.sprite.extend</span><span class="PUNC">(</span><span class="STRN">"baa.button"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1129</span> 
<span class='line'>1130</span> </span><span class="COMM">/**
<span class='line'>1131</span>  * The default shape. This is normally "rectangle", but can be changed to "circle" if you have a lot of round buttons.
<span class='line'>1132</span>  */</span><span class="WHIT">
<span class='line'>1133</span> </span><span class="NAME">baa.button.defaultShape</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"rectangle"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1134</span> 
<span class='line'>1135</span> </span><span class="NAME">baa.button.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">,</span><span class="NAME">shape</span><span class="PUNC">,</span><span class="NAME">onRelease</span><span class="PUNC">,</span><span class="NAME">buttons</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1136</span> </span><span class="WHIT">	</span><span class="NAME">baa.button.super.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1137</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1138</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1139</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"shape"</span><span class="PUNC">,</span><span class="NAME">shape</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1140</span> </span><span class="WHIT">	</span><span class="NAME">this.shape</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">shape</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">baa.button.defaultShape</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1141</span> </span><span class="WHIT">	</span><span class="NAME">this.hold</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1142</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1143</span> </span><span class="WHIT">	</span><span class="NAME">this.func</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">func</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1144</span> </span><span class="WHIT">	</span><span class="NAME">this.onRelease</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">onRelease</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1145</span> </span><span class="WHIT">	</span><span class="NAME">this.buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">buttons</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"l"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1146</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1147</span> 
<span class='line'>1148</span> </span><span class="COMM">/**
<span class='line'>1149</span>  * Updates the button
<span class='line'>1150</span>  */</span><span class="WHIT">
<span class='line'>1151</span> </span><span class="NAME">baa.button.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1152</span> </span><span class="WHIT">	</span><span class="NAME">baa.button.super.update</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1153</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1154</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse.setCursor</span><span class="PUNC">(</span><span class="STRN">"hand"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1155</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.image</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.setAnimation</span><span class="PUNC">(</span><span class="STRN">"hover"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1156</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1157</span> </span><span class="WHIT">			</span><span class="NAME">this.hold</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1158</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1159</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1160</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1161</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.image</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">this.setAnimation</span><span class="PUNC">(</span><span class="STRN">"idle"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1162</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1163</span> 
<span class='line'>1164</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.hold</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1165</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.image</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.setAnimation</span><span class="PUNC">(</span><span class="STRN">"hold"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1166</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1167</span> 
<span class='line'>1168</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">this.onRelease</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">baa.mouse.isReleased</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.onRelease</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1169</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.hold</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1170</span> </span><span class="WHIT">			</span><span class="NAME">this._active</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1171</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.image</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.setAnimation</span><span class="PUNC">(</span><span class="STRN">"active"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1172</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1173</span> </span><span class="WHIT">		</span><span class="NAME">this.hold</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1174</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> 
<span class='line'>1175</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1176</span> 
<span class='line'>1177</span> </span><span class="COMM">/**
<span class='line'>1178</span>  * Sets an image. The frames will be used to create the following animations:
<span class='line'>1179</span>  * "idle", when the mouse is not on the button. "hover", when you're hovering over the button.
<span class='line'>1180</span>  * "hold", when you're holding your mouse down on the button.  "release", when you release the button.
<span class='line'>1181</span>  * @param {string} url    The name of image.
<span class='line'>1182</span>  * @param {number} width  The width of each frame.
<span class='line'>1183</span>  * @param {nubmer} height The height of each frame.
<span class='line'>1184</span>  */</span><span class="WHIT">
<span class='line'>1185</span> </span><span class="NAME">baa.button.setImage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1186</span> </span><span class="WHIT">	</span><span class="NAME">baa.button.super.setImage</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1187</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.shape</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"circle"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1188</span> </span><span class="WHIT">		</span><span class="NAME">this.offset.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">this.origin.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1189</span> </span><span class="WHIT">		</span><span class="NAME">this.offset.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">this.origin.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1190</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1191</span> 
<span class='line'>1192</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">a3</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1193</span> </span><span class="WHIT">	</span><span class="NAME">a1</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._frames.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1194</span> </span><span class="WHIT">	</span><span class="NAME">a2</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._frames.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">a1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1195</span> </span><span class="WHIT">	</span><span class="NAME">a3</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._frames.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">3</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">a2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1196</span> </span><span class="WHIT">	
<span class='line'>1197</span> 	</span><span class="NAME">this.addAnimation</span><span class="PUNC">(</span><span class="STRN">"idle"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1198</span> </span><span class="WHIT">	</span><span class="NAME">this.addAnimation</span><span class="PUNC">(</span><span class="STRN">"hover"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1199</span> </span><span class="WHIT">	</span><span class="NAME">this.addAnimation</span><span class="PUNC">(</span><span class="STRN">"hold"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1200</span> </span><span class="WHIT">	</span><span class="NAME">this.addAnimation</span><span class="PUNC">(</span><span class="STRN">"active"</span><span class="PUNC">,</span><span class="PUNC">[</span><span class="NAME">a3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1201</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1202</span> 
<span class='line'>1203</span> </span><span class="COMM">/**
<span class='line'>1204</span>  * This is called when the button is clicked, and calls the function that is set.
<span class='line'>1205</span>  */</span><span class="WHIT">
<span class='line'>1206</span> </span><span class="NAME">baa.button._active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1207</span> </span><span class="WHIT">	</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">,</span><span class="NAME">this.func</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1208</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1209</span> 
<span class='line'>1210</span> </span><span class="COMM">/**
<span class='line'>1211</span>  * Sets the function button needs to call when activated
<span class='line'>1212</span>  */</span><span class="WHIT">
<span class='line'>1213</span> </span><span class="NAME">baa.button.setFunction</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">  </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1214</span> </span><span class="WHIT">	</span><span class="NAME">this.func</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">func</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1215</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1216</span> 
<span class='line'>1217</span> 
<span class='line'>1218</span> </span><span class="COMM">///////////////////////////////</span><span class="WHIT">
<span class='line'>1219</span> </span><span class="COMM">///////////////////////////////</span><span class="WHIT">
<span class='line'>1220</span> 
<span class='line'>1221</span> </span><span class="COMM">//Graphics</span><span class="WHIT">
<span class='line'>1222</span> 
<span class='line'>1223</span> </span><span class="COMM">/**
<span class='line'>1224</span>  * Handles everything you see on the screen
<span class='line'>1225</span>  * @constructor
<span class='line'>1226</span>  * @type {object}
<span class='line'>1227</span>  */</span><span class="WHIT">
<span class='line'>1228</span> </span><span class="NAME">baa.graphics</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1229</span> 
<span class='line'>1230</span> </span><span class="COMM">/**
<span class='line'>1231</span>  * The default context
<span class='line'>1232</span>  * @type {object}
<span class='line'>1233</span>  */</span><span class="WHIT">
<span class='line'>1234</span> </span><span class="NAME">baa.graphics._defaultCtx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1235</span> 
<span class='line'>1236</span> </span><span class="COMM">/**
<span class='line'>1237</span>  * The default canvas
<span class='line'>1238</span>  * @type {object}
<span class='line'>1239</span>  */</span><span class="WHIT">
<span class='line'>1240</span> </span><span class="NAME">baa.graphics._defaultCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1241</span> 
<span class='line'>1242</span> </span><span class="COMM">/**
<span class='line'>1243</span>  * The default smoothing
<span class='line'>1244</span>  * @type {boolean}
<span class='line'>1245</span>  */</span><span class="WHIT">
<span class='line'>1246</span> </span><span class="NAME">baa.graphics._defaultSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1247</span> 
<span class='line'>1248</span> </span><span class="COMM">/**
<span class='line'>1249</span>  * The default font
<span class='line'>1250</span>  * @type {baa._font}
<span class='line'>1251</span>  */</span><span class="WHIT">
<span class='line'>1252</span> </span><span class="NAME">baa.graphics._defaultFont</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1253</span> 
<span class='line'>1254</span> </span><span class="COMM">/**
<span class='line'>1255</span>  * The scale of the game.1
<span class='line'>1256</span>  * @type {Number}
<span class='line'>1257</span>  */</span><span class="WHIT">
<span class='line'>1258</span> </span><span class="NAME">baa.graphics._globalScale</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1259</span> 
<span class='line'>1260</span> </span><span class="COMM">/**
<span class='line'>1261</span>  * The current canvas
<span class='line'>1262</span>  * @type {object}
<span class='line'>1263</span>  */</span><span class="WHIT">
<span class='line'>1264</span> </span><span class="NAME">baa.graphics._currentCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1265</span> 
<span class='line'>1266</span> </span><span class="COMM">/**
<span class='line'>1267</span>  * All the preloaded images
<span class='line'>1268</span>  * @see  baa.graphics.preload
<span class='line'>1269</span>  * @type {object}
<span class='line'>1270</span>  */</span><span class="WHIT">
<span class='line'>1271</span> </span><span class="NAME">baa.graphics._images</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1272</span> 
<span class='line'>1273</span> </span><span class="COMM">/**
<span class='line'>1274</span>  * The color to use with drawing
<span class='line'>1275</span>  * @see  baa.graphics.setColor
<span class='line'>1276</span>  * @type {object}
<span class='line'>1277</span>  */</span><span class="WHIT">
<span class='line'>1278</span> </span><span class="NAME">baa.graphics._color</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">:</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">:</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1279</span> 
<span class='line'>1280</span> </span><span class="COMM">/**
<span class='line'>1281</span>  * The background color
<span class='line'>1282</span>  * @see  baa.graphics.setBackgroundColor
<span class='line'>1283</span>  * @type {object}
<span class='line'>1284</span>  */</span><span class="WHIT">
<span class='line'>1285</span> </span><span class="NAME">baa.graphics._backgroundColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="NAME">r</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">:</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1286</span> 
<span class='line'>1287</span> </span><span class="COMM">/**
<span class='line'>1288</span>  * The current font
<span class='line'>1289</span>  * @type {baa.graphics._font}
<span class='line'>1290</span>  */</span><span class="WHIT">
<span class='line'>1291</span> </span><span class="NAME">baa.graphics._currentFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1292</span> 
<span class='line'>1293</span> </span><span class="COMM">/**
<span class='line'>1294</span>  * A number that mimics the number of stack created and destroyed by baa.graphics.push and baa.graphics.pop.
<span class='line'>1295</span>  * @type {Number}
<span class='line'>1296</span>  */</span><span class="WHIT">
<span class='line'>1297</span> </span><span class="NAME">baa.graphics._stacks</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1298</span> 
<span class='line'>1299</span> </span><span class="COMM">/**
<span class='line'>1300</span>  * The width of the canvas
<span class='line'>1301</span>  */</span><span class="WHIT">
<span class='line'>1302</span> </span><span class="NAME">baa.graphics.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1303</span> 
<span class='line'>1304</span> </span><span class="COMM">/**
<span class='line'>1305</span>  * The height of the canvas
<span class='line'>1306</span>  */</span><span class="WHIT">
<span class='line'>1307</span> </span><span class="NAME">baa.graphics.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1308</span> 
<span class='line'>1309</span> </span><span class="COMM">/**
<span class='line'>1310</span>  * Use this to preload images. Assumes all images are in the folder images/
<span class='line'>1311</span>  * @param {string} ext The extension of the images. Examples: "png", "gif", "jpg"
<span class='line'>1312</span>  * @param {string} ... Names of the images. Example: "player", "logo", "enemy" NOT: "images/player.png", "images/logo", "enemy.png"
<span class='line'>1313</span>  */</span><span class="WHIT">
<span class='line'>1314</span> </span><span class="NAME">baa.graphics.preload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">ext</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1315</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ext</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ext</span><span class="WHIT">
<span class='line'>1316</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1317</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1318</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">img</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1319</span> </span><span class="WHIT">		</span><span class="NAME">img</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Image</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1320</span> </span><span class="WHIT">		</span><span class="NAME">img.onload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1321</span> </span><span class="WHIT">			</span><span class="NAME">baa._assetsLoaded</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1322</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1323</span> </span><span class="WHIT">		</span><span class="NAME">img.src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"images/"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ext</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1324</span> </span><span class="WHIT">		</span><span class="NAME">this._images</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">img</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1325</span> </span><span class="WHIT">		</span><span class="NAME">baa._assetsToBeLoaded</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1326</span> </span><span class="WHIT">		
<span class='line'>1327</span> 	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1328</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1329</span> 
<span class='line'>1330</span> </span><span class="COMM">//Drawing functions</span><span class="WHIT">
<span class='line'>1331</span> 
<span class='line'>1332</span> </span><span class="COMM">/**
<span class='line'>1333</span>  * Draws a rectangle
<span class='line'>1334</span>  * @param  {string} mode Whether to draw the rectangle filled, in lines, or both.
<span class='line'>1335</span>  * @param  {number|baa.rectangle} x    The horizontal position OR an object of type baa.rect. Using an object changes y in r, and ignores the other arguments.
<span class='line'>1336</span>  * @param  {number} [y]    The vertical position
<span class='line'>1337</span>  * @param  {number} [w]    The width
<span class='line'>1338</span>  * @param  {number} [h]    The height
<span class='line'>1339</span>  * @param  {number} [r]    The rounding
<span class='line'>1340</span>  */</span><span class="WHIT">
<span class='line'>1341</span> </span><span class="NAME">baa.graphics.rectangle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1342</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1343</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="STRN">"baa.rect"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1344</span> </span><span class="WHIT">	
<span class='line'>1345</span> 
<span class='line'>1346</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Class.isClass</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">x.is</span><span class="PUNC">(</span><span class="NAME">baa.rect</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1347</span> </span><span class="WHIT">		</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1348</span> </span><span class="WHIT">		</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1349</span> </span><span class="WHIT">		</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1350</span> </span><span class="WHIT">		</span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1351</span> </span><span class="WHIT">		</span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1352</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1353</span> 
<span class='line'>1354</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1355</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1356</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1357</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rounding"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1358</span> 
<span class='line'>1359</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1360</span> </span><span class="WHIT">	
<span class='line'>1361</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1362</span> </span><span class="WHIT">		</span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1363</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.rect</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">w</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1364</span> </span><span class="WHIT">		</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1365</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1366</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1367</span> </span><span class="WHIT">		</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">7</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1368</span> </span><span class="WHIT">		</span><span class="NAME">r</span><span class="PUNC">*</span><span class="PUNC">=</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">w</span><span class="PUNC">/</span><span class="NUMB">25</span><span class="PUNC">,</span><span class="NAME">h</span><span class="PUNC">/</span><span class="NUMB">25</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1369</span> </span><span class="WHIT">		</span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1370</span> </span><span class="WHIT">		</span><span class="NAME">w</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1371</span> </span><span class="WHIT">		</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1372</span> </span><span class="WHIT">		</span><span class="NAME">h</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1373</span> 
<span class='line'>1374</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1375</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1376</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1377</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1378</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">w</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1379</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1380</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">h</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1381</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1382</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.quadraticCurveTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1383</span> </span><span class="WHIT">		</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1384</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1385</span> 
<span class='line'>1386</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1387</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1388</span> 
<span class='line'>1389</span> </span><span class="COMM">/**
<span class='line'>1390</span>  * Draws a circle
<span class='line'>1391</span>  * @param  {string} mode Whether to draw the circle filled, in lines, or both.
<span class='line'>1392</span>  * @param  {number|baa.circle} x    The horizontal position OR an object of type baa.circle. Using an object ignores the other arguments.
<span class='line'>1393</span>  * @param  {number} y    The vertical position
<span class='line'>1394</span>  * @param  {number} r    The radius of the circle
<span class='line'>1395</span>  */</span><span class="WHIT">
<span class='line'>1396</span> </span><span class="NAME">baa.graphics.circle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1397</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1398</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="STRN">"baa.circle"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1399</span> 
<span class='line'>1400</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Class.isClass</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">x.is</span><span class="PUNC">(</span><span class="NAME">baa.circle</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1401</span> </span><span class="WHIT">		</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1402</span> </span><span class="WHIT">		</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1403</span> </span><span class="WHIT">		</span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1404</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1405</span> 
<span class='line'>1406</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1407</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1408</span> 
<span class='line'>1409</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1410</span> 
<span class='line'>1411</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.arc</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1412</span> </span><span class="WHIT">	</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1413</span> 
<span class='line'>1414</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1415</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1416</span> 
<span class='line'>1417</span> </span><span class="COMM">/**
<span class='line'>1418</span>  * Draws a convex
<span class='line'>1419</span>  * @param  {string} mode Whether to draw the convex filled, in lines, or both.
<span class='line'>1420</span>  * @param  {number} x    The horizontal position
<span class='line'>1421</span>  * @param  {number} y    The vertical position
<span class='line'>1422</span>  * @param  {number} r    The radius of the convex
<span class='line'>1423</span>  * @param  {number} p 	 The number of points the convex should have
<span class='line'>1424</span>  * @param  {number} rot  The rotation of the convex in radians
<span class='line'>1425</span>  */</span><span class="WHIT">
<span class='line'>1426</span> </span><span class="NAME">baa.graphics.convex</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">rot</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1427</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1428</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1429</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1430</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1431</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1432</span> 
<span class='line'>1433</span> </span><span class="WHIT">	</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1434</span> 
<span class='line'>1435</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1436</span> 
<span class='line'>1437</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1438</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rot</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1439</span> </span><span class="WHIT">						</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rot</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1440</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1441</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rot</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1442</span> </span><span class="WHIT">					</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">rot</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1443</span> </span><span class="WHIT">	</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1444</span> 
<span class='line'>1445</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1446</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1447</span> 
<span class='line'>1448</span> </span><span class="COMM">/**
<span class='line'>1449</span>  * Draws a star
<span class='line'>1450</span>  * @param  {string} mode Whether to draw the star filled, in lines, or both.
<span class='line'>1451</span>  * @param  {number} x    The horizontal position
<span class='line'>1452</span>  * @param  {number} y    The vertical position
<span class='line'>1453</span>  * @param  {number} r1   The inner radius
<span class='line'>1454</span>  * @param  {number} r2   The outer radius
<span class='line'>1455</span>  * @param  {number} p    The number of points the star should have
<span class='line'>1456</span>  * @param  {number} r    The rotation of the star in radians
<span class='line'>1457</span>  */</span><span class="WHIT">
<span class='line'>1458</span> </span><span class="NAME">baa.graphics.star</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r1</span><span class="PUNC">,</span><span class="NAME">r2</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1459</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1460</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1461</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1462</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r1"</span><span class="PUNC">,</span><span class="NAME">r1</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1463</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r2"</span><span class="PUNC">,</span><span class="NAME">r2</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1464</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"p"</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1465</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1466</span> 
<span class='line'>1467</span> </span><span class="WHIT">	</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1468</span> 
<span class='line'>1469</span> </span><span class="WHIT">	</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1470</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1471</span> 
<span class='line'>1472</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1473</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1474</span> </span><span class="WHIT">						</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1475</span> 
<span class='line'>1476</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">180</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r2</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1477</span> </span><span class="WHIT">						</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">+</span><span class="PUNC">(</span><span class="NUMB">180</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1478</span> 
<span class='line'>1479</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1480</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">+</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>1481</span> </span><span class="WHIT">					</span><span class="NAME">y</span><span class="PUNC">+</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NUMB">360</span><span class="PUNC">/</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">180</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">r1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1482</span> 
<span class='line'>1483</span> </span><span class="WHIT">	</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1484</span> 
<span class='line'>1485</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1486</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1487</span> 
<span class='line'>1488</span> </span><span class="COMM">/**
<span class='line'>1489</span>  * Draws an arc, a part of a circle
<span class='line'>1490</span>  * @param  {string} mode Whether to draw the arc filled, in lines, or both.
<span class='line'>1491</span>  * @param  {number} x    The horizontal position
<span class='line'>1492</span>  * @param  {number} y    The vertical position
<span class='line'>1493</span>  * @param  {number} r    The radius of the arc
<span class='line'>1494</span>  * @param  {number} a1   The start of the arc
<span class='line'>1495</span>  * @param  {number} a2   The end of the arc
<span class='line'>1496</span>  */</span><span class="WHIT">
<span class='line'>1497</span> </span><span class="NAME">baa.graphics.arc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">a1</span><span class="PUNC">,</span><span class="NAME">a2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1498</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1499</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1500</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1501</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1502</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"a1"</span><span class="PUNC">,</span><span class="NAME">a1</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1503</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"a2"</span><span class="PUNC">,</span><span class="NAME">a2</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1504</span> 
<span class='line'>1505</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1506</span> 
<span class='line'>1507</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1508</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.arc</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a1</span><span class="PUNC">,</span><span class="NAME">a2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1509</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1510</span> </span><span class="WHIT">	</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1511</span> </span><span class="WHIT">	
<span class='line'>1512</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1513</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1514</span> 
<span class='line'>1515</span> </span><span class="COMM">/**
<span class='line'>1516</span>  * Draws a line
<span class='line'>1517</span>  * @param {array|number} points An array of numbers, x and y alternately, or a number, assuming all numbers are in arguments.
<span class='line'>1518</span>  * @param {number} ... The x and y of the points the lines goes to alternately
<span class='line'>1519</span>  */</span><span class="WHIT">
<span class='line'>1520</span> </span><span class="NAME">baa.graphics.line</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1521</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1522</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1523</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">verts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1524</span> 
<span class='line'>1525</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1526</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1527</span> </span><span class="WHIT">	
<span class='line'>1528</span> 		</span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1529</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">verts.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1530</span> </span><span class="WHIT">		
<span class='line'>1531</span> 			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1532</span> </span><span class="WHIT">			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1533</span> </span><span class="WHIT">		
<span class='line'>1534</span> 			</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1535</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1536</span> </span><span class="WHIT">		
<span class='line'>1537</span> 	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1538</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1539</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1540</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1541</span> </span><span class="WHIT">		
<span class='line'>1542</span> 		</span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1543</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1544</span> 
<span class='line'>1545</span> </span><span class="WHIT">			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1546</span> </span><span class="WHIT">			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1547</span> </span><span class="WHIT">		
<span class='line'>1548</span> 			</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1549</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1550</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1551</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1552</span> 
<span class='line'>1553</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1554</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1555</span> 
<span class='line'>1556</span> </span><span class="COMM">/**
<span class='line'>1557</span>  * Draws a polygon
<span class='line'>1558</span>  * @param  {string} mode Whether to draw the polygon filled, in lines, or both.
<span class='line'>1559</span>  * @param {array|number} points An array of numbers, x and y alternately, or a number, assuming all numbers are in arguments.
<span class='line'>1560</span>  * @param {number} ... The x and y of the points the polygon goes to alternately
<span class='line'>1561</span>  */</span><span class="WHIT">
<span class='line'>1562</span> </span><span class="NAME">baa.graphics.polygon</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1563</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1564</span> 
<span class='line'>1565</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1566</span> </span><span class="WHIT">	
<span class='line'>1567</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1568</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">verts</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1569</span> 
<span class='line'>1570</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1571</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1572</span> </span><span class="WHIT">	
<span class='line'>1573</span> 		</span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1574</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">verts.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1575</span> </span><span class="WHIT">		
<span class='line'>1576</span> 			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1577</span> </span><span class="WHIT">			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1578</span> </span><span class="WHIT">		
<span class='line'>1579</span> 			</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">verts</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1580</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1581</span> </span><span class="WHIT">		
<span class='line'>1582</span> 	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1583</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1584</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1585</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1586</span> </span><span class="WHIT">		
<span class='line'>1587</span> 		</span><span class="NAME">this.ctx.moveTo</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1588</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">+</span><span class="PUNC">=</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1589</span> 
<span class='line'>1590</span> </span><span class="WHIT">			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1591</span> </span><span class="WHIT">			</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"verts"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1592</span> </span><span class="WHIT">		
<span class='line'>1593</span> 			</span><span class="NAME">this.ctx.lineTo</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">+</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1594</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1595</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1596</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.closePath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1597</span> </span><span class="WHIT">	</span><span class="NAME">this._mode</span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1598</span> 
<span class='line'>1599</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1600</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1601</span> 
<span class='line'>1602</span> </span><span class="COMM">/**
<span class='line'>1603</span>  * Clears the canvas, and draws the background
<span class='line'>1604</span>  */</span><span class="WHIT">
<span class='line'>1605</span> </span><span class="NAME">baa.graphics.clear</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1606</span> </span><span class="WHIT">	</span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1607</span> </span><span class="WHIT">	</span><span class="NAME">this.origin</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1608</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._backgroundColor.r</span><span class="PUNC">,</span><span class="NAME">this._backgroundColor.g</span><span class="PUNC">,</span><span class="NAME">this._backgroundColor.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1609</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.fillRect</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.canvas.width</span><span class="PUNC">,</span><span class="NAME">this.canvas.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1610</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._color.r</span><span class="PUNC">,</span><span class="NAME">this._color.g</span><span class="PUNC">,</span><span class="NAME">this._color.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1611</span> </span><span class="WHIT">	</span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1612</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1613</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1614</span> 
<span class='line'>1615</span> </span><span class="COMM">/**
<span class='line'>1616</span>  * Draws text. If the second argument is a string, it will use alignment, else, it will assume the first argument is x.
<span class='line'>1617</span>  * @param  {string} t     The text to draw
<span class='line'>1618</span>  * @param  {string} [align] Use this for text-alignment. Options: "left", "center" and "right". 
<span class='line'>1619</span>  * Using a number here will take this argument as x, will take limit as y, and shift all the arguments.
<span class='line'>1620</span>  * @param  {string} [limit] [description]
<span class='line'>1621</span>  * @param  {number} [x=0]     The horizontal position
<span class='line'>1622</span>  * @param  {number} [y=x]     The vertical position
<span class='line'>1623</span>  * @param  {number} [r=0]     The rotation in radians
<span class='line'>1624</span>  * @param  {number} [sx=0]    The horizontal scaling
<span class='line'>1625</span>  * @param  {number} [sy=sx]    The vertical scaling
<span class='line'>1626</span>  * @param  {number} [ox=0]    The horizontal origin. The origin point is from where the text rotates and scales.
<span class='line'>1627</span>  * @param  {number} [oy=ox]    The vertical origin. The origin point is from where the text rotates and scales.
<span class='line'>1628</span>  * @param  {number} [kx=0]    The horizontal shearing factor
<span class='line'>1629</span>  * @param  {number} [ky=kx]    The vertical shearing factor
<span class='line'>1630</span>  */</span><span class="WHIT">
<span class='line'>1631</span> </span><span class="NAME">baa.graphics.print</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">,</span><span class="NAME">limit</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1632</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">align</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1633</span> </span><span class="WHIT">		</span><span class="NAME">this._print</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">,</span><span class="NAME">limit</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1634</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1635</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1636</span> </span><span class="WHIT">		</span><span class="NAME">this._print</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">limit</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1637</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1638</span> 
<span class='line'>1639</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1640</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1641</span> 
<span class='line'>1642</span> </span><span class="COMM">/**
<span class='line'>1643</span>  * Psst, baa.graphics.print is actually a wrapper, to call this function with the correct arguments. But don't tell anyone.
<span class='line'>1644</span>  */</span><span class="WHIT">
<span class='line'>1645</span> </span><span class="NAME">baa.graphics._print</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">limit</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1646</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"text"</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1647</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"align"</span><span class="PUNC">,</span><span class="NAME">align</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1648</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1649</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1650</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1651</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"sx"</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1652</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"sy"</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1653</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"ox"</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1654</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"oy"</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1655</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"kx"</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1656</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"ky"</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1657</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"limit"</span><span class="PUNC">,</span><span class="NAME">limit</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1658</span> 
<span class='line'>1659</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1660</span> </span><span class="WHIT">	</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1661</span> </span><span class="WHIT">	</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1662</span> </span><span class="WHIT">	</span><span class="NAME">sx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1663</span> </span><span class="WHIT">	</span><span class="NAME">sy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1664</span> </span><span class="WHIT">	</span><span class="NAME">ox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ox</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ox</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1665</span> </span><span class="WHIT">	</span><span class="NAME">oy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">oy</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ox</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">oy</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1666</span> </span><span class="WHIT">	</span><span class="NAME">kx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kx</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">kx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1667</span> </span><span class="WHIT">	</span><span class="NAME">ky</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ky</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">kx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ky</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1668</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.textAlign</span><span class="PUNC">=</span><span class="NAME">align</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1669</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">limit</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1670</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">words</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">t.toString</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">split</span><span class="PUNC">(</span><span class="STRN">' '</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1671</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">''</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1672</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">words.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1673</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">testLine</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">words</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1674</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">metrics</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.ctx.measureText</span><span class="PUNC">(</span><span class="NAME">testLine</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1675</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">testWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">metrics.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1676</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">testWidth</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">limit</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1677</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1678</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.transform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1679</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1680</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.scale</span><span class="PUNC">(</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1681</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.rotate</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1682</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.fillText</span><span class="PUNC">(</span><span class="NAME">line</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">oy</span><span class="PUNC">+</span><span class="NAME">this._currentFont.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1683</span> </span><span class="WHIT">				</span><span class="NAME">this.ctx.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1684</span> </span><span class="WHIT">				</span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">words</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">' '</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1685</span> </span><span class="WHIT">				</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._currentFont.height</span><span class="PUNC">+</span><span class="NAME">sy</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1686</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1687</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1688</span> </span><span class="WHIT">				</span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">testLine</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1689</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1690</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1691</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1692</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1693</span> </span><span class="WHIT">		</span><span class="NAME">line</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1694</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1695</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1696</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.transform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1697</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1698</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.scale</span><span class="PUNC">(</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1699</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.rotate</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1700</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.fillText</span><span class="PUNC">(</span><span class="NAME">line</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">oy</span><span class="PUNC">+</span><span class="NAME">this._currentFont.size</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1701</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1702</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.textAlign</span><span class="PUNC">=</span><span class="STRN">"left"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1703</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1704</span> 
<span class='line'>1705</span> </span><span class="COMM">/**
<span class='line'>1706</span>  * Draws an image. If the second argument is an object, a quad, it will draw only part of the image. Else, it will assume the second argument is x.
<span class='line'>1707</span>  * @throws {Error} If img is a non-existing image.
<span class='line'>1708</span>  * @param  {baa.graphics._image|string} img  The image you want draw, or a string of the name of the image.
<span class='line'>1709</span>  * @param  {object} [quad] An object with an x, y, width and height. 0, 0, 32, 32 would be the top left part of the image, and a 32x32 rectangle. 
<span class='line'>1710</span>  * Using a number here will take this argument as x, and shift all the arguments.  
<span class='line'>1711</span>  * @param  {number} [x=0]     The horizontal position
<span class='line'>1712</span>  * @param  {number} [y=x]     The vertical position
<span class='line'>1713</span>  * @param  {number} [r=0]     The rotation in radians
<span class='line'>1714</span>  * @param  {number} [sx=0]    The horizontal scaling
<span class='line'>1715</span>  * @param  {number} [sy=sx]    The vertical scaling
<span class='line'>1716</span>  * @param  {number} [ox=0]    The horizontal origin. The origin point is from where the text rotates and scales.
<span class='line'>1717</span>  * @param  {number} [oy=ox]    The vertical origin. The origin point is from where the text rotates and scales.
<span class='line'>1718</span>  * @param  {number} [kx=0]    The horizontal shearing factor
<span class='line'>1719</span>  * @param  {number} [ky=kx]    The vertical shearing factor
<span class='line'>1720</span>  */</span><span class="WHIT">
<span class='line'>1721</span> </span><span class="NAME">baa.graphics.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">quad</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1722</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">quad</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1723</span> </span><span class="WHIT">		</span><span class="NAME">this._draw</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">quad</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1724</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1725</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1726</span> </span><span class="WHIT">		</span><span class="NAME">this._draw</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">quad</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1727</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1728</span> 
<span class='line'>1729</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">baa.debug.drawCalls</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1730</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1731</span> 
<span class='line'>1732</span> </span><span class="COMM">/**
<span class='line'>1733</span>  * Psst, baa.graphics.draw is actually a wrapper, to call this function with the correct arguments. But don't tell anyone.
<span class='line'>1734</span>  */</span><span class="WHIT">
<span class='line'>1735</span> </span><span class="NAME">baa.graphics._draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">quad</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1736</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"image"</span><span class="PUNC">,</span><span class="NAME">img</span><span class="PUNC">,</span><span class="STRN">"baa.graphics.image"</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1737</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1738</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1739</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1740</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"sx"</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1741</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"sy"</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1742</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"ox"</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1743</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"oy"</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1744</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"kx"</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1745</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"ky"</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1746</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"quad"</span><span class="PUNC">,</span><span class="NAME">quad</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1747</span> </span><span class="WHIT">	
<span class='line'>1748</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">img</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">img</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">img.url</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1749</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._images</span><span class="PUNC">[</span><span class="NAME">url</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1750</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"The image "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">img</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" doesn't exist. Did you forget to preload it?"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1751</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1752</span> 
<span class='line'>1753</span> </span><span class="WHIT">	</span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1754</span> </span><span class="WHIT">	</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1755</span> </span><span class="WHIT">	</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1756</span> </span><span class="WHIT">	</span><span class="NAME">sx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1757</span> </span><span class="WHIT">	</span><span class="NAME">sy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">sx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">sy</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1758</span> </span><span class="WHIT">	</span><span class="NAME">ox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ox</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ox</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1759</span> </span><span class="WHIT">	</span><span class="NAME">oy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">oy</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">ox</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">oy</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1760</span> </span><span class="WHIT">	</span><span class="NAME">kx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">kx</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">kx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1761</span> </span><span class="WHIT">	</span><span class="NAME">ky</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ky</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">kx</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">ky</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1762</span> 
<span class='line'>1763</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">img.smooth</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._defaultSmooth</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">img.smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1764</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.imageSmoothingEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1765</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.mozImageSmoothingEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1766</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.oImageSmoothingEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1767</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1768</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.transform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1769</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1770</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.scale</span><span class="PUNC">(</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1771</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.rotate</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1772</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">quad</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1773</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.drawImage</span><span class="PUNC">(</span><span class="NAME">this._images</span><span class="PUNC">[</span><span class="NAME">url</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">quad.x</span><span class="PUNC">,</span><span class="NAME">quad.y</span><span class="PUNC">,</span><span class="NAME">quad.width</span><span class="PUNC">,</span><span class="NAME">quad.height</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">quad.width</span><span class="PUNC">,</span><span class="NAME">quad.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1774</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1775</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1776</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.drawImage</span><span class="PUNC">(</span><span class="NAME">this._images</span><span class="PUNC">[</span><span class="NAME">url</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">oy</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1777</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1778</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1779</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.imageSmoothingEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.defaultFilter</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"linear"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1780</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1781</span> 
<span class='line'>1782</span> 
<span class='line'>1783</span> 
<span class='line'>1784</span> </span><span class="COMM">//image</span><span class="WHIT">
<span class='line'>1785</span> </span><span class="COMM">///////////////////</span><span class="WHIT">
<span class='line'>1786</span> 
<span class='line'>1787</span> </span><span class="COMM">/**
<span class='line'>1788</span>  * An image object. Makes it able to read data of the image, and set smoothing for specific images.
<span class='line'>1789</span>  * @constructor
<span class='line'>1790</span>  * @throws {Error} If url is a non-existing image.
<span class='line'>1791</span>  * @param {string} url The url of the image
<span class='line'>1792</span>  * @param {boolean} [smooth=null] The smoothing of the image.
<span class='line'>1793</span>  * @property {string} url The url of the image.
<span class='line'>1794</span>  * @property {boolean} smooth The smoothing of the image. If this is null, default smoothing will be used instead. This can be set with baa.graphics.setSmooth.
<span class='line'>1795</span>  */</span><span class="WHIT">
<span class='line'>1796</span> </span><span class="NAME">baa.graphics._image</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.graphics.image"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1797</span> 
<span class='line'>1798</span> </span><span class="NAME">baa.graphics._image.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1799</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"url"</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1800</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"smooth"</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1801</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.graphics._images</span><span class="PUNC">[</span><span class="NAME">url</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">"Image '"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"' doesn't exist. Did you forgot to preload it?"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1802</span> </span><span class="WHIT">	</span><span class="NAME">this.url</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">url</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1803</span> </span><span class="WHIT">	</span><span class="NAME">this.smooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1804</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1805</span> 
<span class='line'>1806</span> </span><span class="COMM">/**
<span class='line'>1807</span>  * Draws the image.
<span class='line'>1808</span>  * @see  baa.graphics.draw
<span class='line'>1809</span>  */</span><span class="WHIT">
<span class='line'>1810</span> </span><span class="NAME">baa.graphics._image.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">quad</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1811</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.draw</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">quad</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">sx</span><span class="PUNC">,</span><span class="NAME">sy</span><span class="PUNC">,</span><span class="NAME">ox</span><span class="PUNC">,</span><span class="NAME">oy</span><span class="PUNC">,</span><span class="NAME">kx</span><span class="PUNC">,</span><span class="NAME">ky</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1812</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1813</span> 
<span class='line'>1814</span> </span><span class="COMM">/**
<span class='line'>1815</span>  * Sets the smoothing of the image
<span class='line'>1816</span>  * @param {boolean} smooth If the image should use smoothing or not.
<span class='line'>1817</span>  */</span><span class="WHIT">
<span class='line'>1818</span> </span><span class="NAME">baa.graphics._image.setSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1819</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"smooth"</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1820</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.smooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1821</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1822</span> 
<span class='line'>1823</span> </span><span class="COMM">/**
<span class='line'>1824</span>  * Returns the current smoothing of the image. Returns null if no smoothing is assigned yet.
<span class='line'>1825</span>  * @return {boolean|null} The smoothing of the image
<span class='line'>1826</span>  */</span><span class="WHIT">
<span class='line'>1827</span> </span><span class="NAME">baa.graphics._image.getSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1828</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1829</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1830</span> 
<span class='line'>1831</span> </span><span class="COMM">/**
<span class='line'>1832</span>  * Returns the width of the image.
<span class='line'>1833</span>  * @return {number} The width of the image.
<span class='line'>1834</span>  */</span><span class="WHIT">
<span class='line'>1835</span> </span><span class="NAME">baa.graphics._image.getWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1836</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">baa.graphics._images</span><span class="PUNC">[</span><span class="NAME">this.url</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1837</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1838</span> 
<span class='line'>1839</span> </span><span class="COMM">/**
<span class='line'>1840</span>  * Returns the height of the image.
<span class='line'>1841</span>  * @return {number} The height of the image.
<span class='line'>1842</span>  */</span><span class="WHIT">
<span class='line'>1843</span> </span><span class="NAME">baa.graphics._image.getHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1844</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">baa.graphics._images</span><span class="PUNC">[</span><span class="NAME">this.url</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1845</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1846</span> 
<span class='line'>1847</span> </span><span class="COMM">/**
<span class='line'>1848</span>  * Creates a new image. This is used to keep image a private object.
<span class='line'>1849</span>  * @see  baa.graphics._image
<span class='line'>1850</span>  * @return {baa.graphics._image} The new image
<span class='line'>1851</span>  */</span><span class="WHIT">
<span class='line'>1852</span> </span><span class="NAME">baa.graphics.newImage</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1853</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._image.new</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1854</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1855</span> 
<span class='line'>1856</span> 
<span class='line'>1857</span> </span><span class="COMM">//font</span><span class="WHIT">
<span class='line'>1858</span> </span><span class="COMM">/////////////////</span><span class="WHIT">
<span class='line'>1859</span> 
<span class='line'>1860</span> </span><span class="COMM">/**
<span class='line'>1861</span>  * A font object. Allows you to set the size and height of a font. Fonts are loaded in CSS.
<span class='line'>1862</span>  * @example
<span class='line'>1863</span>  *  &lt;style>
<span class='line'>1864</span>  *  @font-face {
<span class='line'>1865</span>  *      font-family: "score";
<span class='line'>1866</span>  *      src: url(fonts/score.otf);
<span class='line'>1867</span>  *  }
<span class='line'>1868</span>  *  &lt;/style>
<span class='line'>1869</span>  *
<span class='line'>1870</span>  * baa.graphics.newFont("score",12);
<span class='line'>1871</span>  * @constructor
<span class='line'>1872</span>  * @alias baa.graphics.font
<span class='line'>1873</span>  * @param {string} name The name of the font.
<span class='line'>1874</span>  * @param {number} size The size of the font.
<span class='line'>1875</span>  * @param {string} [style="normal"] The style of the font. Options: "normal", "italic" and "oblique".
<span class='line'>1876</span>  * @param {number} [height=size*2]  The height of the font. This will be used when using alignment and limit for multilining.
<span class='line'>1877</span>  * @property {string} name The name of the font.
<span class='line'>1878</span>  * @property {number} size The size of the font.
<span class='line'>1879</span>  * @property {string} style The style of the font. Options: "normal", "italic" and "oblique".
<span class='line'>1880</span>  * @property {number} height  The height of the font. This will be used when using alignment and limit for multilining.
<span class='line'>1881</span>  */</span><span class="WHIT">
<span class='line'>1882</span> </span><span class="NAME">baa.graphics._font</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.graphics.font"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1883</span> 
<span class='line'>1884</span> </span><span class="NAME">baa.graphics._font.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1885</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"name"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1886</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"size"</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1887</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"style"</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1888</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1889</span> 
<span class='line'>1890</span> </span><span class="WHIT">	</span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1891</span> </span><span class="WHIT">	</span><span class="NAME">this.size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1892</span> </span><span class="WHIT">	</span><span class="NAME">this.style</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">style</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"normal"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1893</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">size</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1894</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1895</span> 
<span class='line'>1896</span> </span><span class="COMM">/**
<span class='line'>1897</span>  * Sets the size of the font
<span class='line'>1898</span>  * @param {number} size The size of the font
<span class='line'>1899</span>  */</span><span class="WHIT">
<span class='line'>1900</span> </span><span class="NAME">baa.graphics._font.setSize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">size</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1901</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"size"</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1902</span> </span><span class="WHIT">	</span><span class="NAME">this.size</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1903</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics._resetFont</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1904</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1905</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1906</span> 
<span class='line'>1907</span> </span><span class="COMM">/**
<span class='line'>1908</span>  * Returns the size of the font
<span class='line'>1909</span>  * @return {number} The size of the font
<span class='line'>1910</span>  */</span><span class="WHIT">
<span class='line'>1911</span> </span><span class="NAME">baa.graphics._font.getSize</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1912</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.size</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1913</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1914</span> 
<span class='line'>1915</span> </span><span class="COMM">/**
<span class='line'>1916</span>  * Sets the height of the font
<span class='line'>1917</span>  * @param {number} height The height of the font
<span class='line'>1918</span>  */</span><span class="WHIT">
<span class='line'>1919</span> </span><span class="NAME">baa.graphics._font.setHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1920</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1921</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1922</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics._resetFont</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1923</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1924</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1925</span> 
<span class='line'>1926</span> </span><span class="COMM">/**
<span class='line'>1927</span>  * Returns the height of the font
<span class='line'>1928</span>  * @return {number} The height of the font
<span class='line'>1929</span>  */</span><span class="WHIT">
<span class='line'>1930</span> </span><span class="NAME">baa.graphics._font.getHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1931</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1932</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1933</span> 
<span class='line'>1934</span> </span><span class="COMM">/**
<span class='line'>1935</span>  * Creates a new font. This is used to keep font a private object.
<span class='line'>1936</span>  * @see  baa.graphics._image
<span class='line'>1937</span>  * @return {baa.graphics._image} The new image
<span class='line'>1938</span>  */</span><span class="WHIT">
<span class='line'>1939</span> </span><span class="NAME">baa.graphics.newFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1940</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._font.new</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1941</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1942</span> 
<span class='line'>1943</span> </span><span class="NAME">baa.graphics._defaultFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.newFont</span><span class="PUNC">(</span><span class="STRN">"arial"</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1944</span> 
<span class='line'>1945</span> </span><span class="COMM">//Canvas</span><span class="WHIT">
<span class='line'>1946</span> </span><span class="COMM">/////////////////</span><span class="WHIT">
<span class='line'>1947</span> 
<span class='line'>1948</span> </span><span class="COMM">/**
<span class='line'>1949</span>  * Everything is drawn on a canvas. You can create your own canvas, draw stuff on that canvas, and then draw the canvas on the real canvas.
<span class='line'>1950</span>  * @constructor
<span class='line'>1951</span>  * @param {number} width The width of the canvas.
<span class='line'>1952</span>  * @param {number} height The height of the canvas.
<span class='line'>1953</span>  * @param {boolean} smooth If the cnavas should draw everything smooth on default.
<span class='line'>1954</span>  * @property {object} drawable The canvas itself.
<span class='line'>1955</span>  * @property {object} context The context of drawable. This is used to draw everything on the canvas.
<span class='line'>1956</span>  * @property {boolean} [smooth=false] If the canvas should draw everything smooth on default.  
<span class='line'>1957</span>  */</span><span class="WHIT">
<span class='line'>1958</span> </span><span class="NAME">baa.graphics._canvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.graphics.canvas"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1959</span> 
<span class='line'>1960</span> </span><span class="NAME">baa.graphics._canvas.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1961</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1962</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1963</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"smooth"</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1964</span> 
<span class='line'>1965</span> </span><span class="WHIT">	</span><span class="NAME">this.drawable</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">document.createElement</span><span class="PUNC">(</span><span class="STRN">'canvas'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1966</span> </span><span class="WHIT">	</span><span class="NAME">this.context</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.drawable.getContext</span><span class="PUNC">(</span><span class="STRN">'2d'</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1967</span> </span><span class="WHIT">	</span><span class="NAME">this.smooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1968</span> </span><span class="WHIT">	</span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1969</span> </span><span class="WHIT">	</span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1970</span> </span><span class="WHIT">	</span><span class="NAME">this.drawable.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1971</span> </span><span class="WHIT">	</span><span class="NAME">this.drawable.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1972</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1973</span> 
<span class='line'>1974</span> </span><span class="COMM">/**
<span class='line'>1975</span>  * Returns the width of the canvas.
<span class='line'>1976</span>  * @return {number} The width of the canvas.
<span class='line'>1977</span>  */</span><span class="WHIT">
<span class='line'>1978</span> </span><span class="NAME">baa.graphics._canvas.getWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1979</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawable.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1980</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1981</span> 
<span class='line'>1982</span> </span><span class="COMM">/**
<span class='line'>1983</span>  * Returns the height of the canvas.
<span class='line'>1984</span>  * @return {number} The height of the canvas.
<span class='line'>1985</span>  */</span><span class="WHIT">
<span class='line'>1986</span> </span><span class="NAME">baa.graphics._canvas.getHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1987</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawable.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1988</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1989</span> 
<span class='line'>1990</span> </span><span class="COMM">/**
<span class='line'>1991</span>  * Sets the width of the canvas
<span class='line'>1992</span>  * @param {number} width The width of the canvas
<span class='line'>1993</span>  */</span><span class="WHIT">
<span class='line'>1994</span> </span><span class="NAME">baa.graphics._canvas.setWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>1995</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1996</span> </span><span class="WHIT">	</span><span class="NAME">width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1997</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawable.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>1998</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>1999</span> 
<span class='line'>2000</span> </span><span class="COMM">/**
<span class='line'>2001</span>  * Sets the height of the canvas
<span class='line'>2002</span>  * @param {number} height The height of the canvas
<span class='line'>2003</span>  */</span><span class="WHIT">
<span class='line'>2004</span> </span><span class="NAME">baa.graphics._canvas.setHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2005</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"height"</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2006</span> </span><span class="WHIT">	</span><span class="NAME">height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2007</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.drawable.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2008</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2009</span> 
<span class='line'>2010</span> </span><span class="COMM">/**
<span class='line'>2011</span>  * Sets the default smoothing of the canvas
<span class='line'>2012</span>  * @param {boolean} smooth The default smoothing of the canvas
<span class='line'>2013</span>  */</span><span class="WHIT">
<span class='line'>2014</span> </span><span class="NAME">baa.graphics._canvas.setSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2015</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"smooth"</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2016</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.smooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2017</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2018</span> 
<span class='line'>2019</span> </span><span class="COMM">/**
<span class='line'>2020</span>  * Returns the default smoothing of the canvas
<span class='line'>2021</span>  * @return {boolean} The default smoothing of the canvas
<span class='line'>2022</span>  */</span><span class="WHIT">
<span class='line'>2023</span> </span><span class="NAME">baa.graphics._canvas.getSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2024</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2025</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2026</span> 
<span class='line'>2027</span> </span><span class="COMM">/**
<span class='line'>2028</span>  * Creates a new canvas. This is used to keep canvas a private object.
<span class='line'>2029</span>  * @see  baa.graphics._canvas
<span class='line'>2030</span>  * @return {baa.graphics._canvas} The new canvas
<span class='line'>2031</span>  */</span><span class="WHIT">
<span class='line'>2032</span> </span><span class="NAME">baa.graphics.newCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2033</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._canvas.new</span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2034</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2035</span> 
<span class='line'>2036</span> </span><span class="COMM">////////////////</span><span class="WHIT">
<span class='line'>2037</span> 
<span class='line'>2038</span> 
<span class='line'>2039</span> </span><span class="COMM">//Set functions</span><span class="WHIT">
<span class='line'>2040</span> 
<span class='line'>2041</span> </span><span class="COMM">/**
<span class='line'>2042</span>  * Sets the default smoothing.
<span class='line'>2043</span>  * @param {boolean} smooth The default smoothing.
<span class='line'>2044</span>  */</span><span class="WHIT">
<span class='line'>2045</span> </span><span class="NAME">baa.graphics.setSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">smooth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2046</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"smooth"</span><span class="PUNC">,</span><span class="NAME">smooth</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2047</span> </span><span class="WHIT">	</span><span class="NAME">this._defaultSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">smooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2048</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2049</span> 
<span class='line'>2050</span> </span><span class="COMM">/**
<span class='line'>2051</span>  * Sets the color the canvas uses to draw geometry. r, g, and b use numbers between 0 and 255. a (for alpha), uses a number between 0 and 1.
<span class='line'>2052</span>  * @param {number|array} r Red. If this is an array, the function assumes all numbers are in that array, and disregard all the other arguments.
<span class='line'>2053</span>  * @param {number} g Green.
<span class='line'>2054</span>  * @param {number} b Blue.
<span class='line'>2055</span>  * @param {number} a Alpha
<span class='line'>2056</span>  */</span><span class="WHIT">
<span class='line'>2057</span> </span><span class="NAME">baa.graphics.setColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2058</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">print</span><span class="PUNC">(</span><span class="STRN">"Warning: Alpha uses 0 to 1, not 0 to 255!"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2059</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2060</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2061</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"green"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2062</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"blue"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2063</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"alpha"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2064</span> </span><span class="WHIT">		</span><span class="NAME">this._color.r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2065</span> </span><span class="WHIT">		</span><span class="NAME">this._color.g</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2066</span> </span><span class="WHIT">		</span><span class="NAME">this._color.b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2067</span> </span><span class="WHIT">		</span><span class="NAME">this._color.a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">3</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2068</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2069</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2070</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2071</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"green"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2072</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"blue"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2073</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"alpha"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2074</span> 
<span class='line'>2075</span> </span><span class="WHIT">		</span><span class="NAME">this._color.r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._color.r</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2076</span> </span><span class="WHIT">		</span><span class="NAME">this._color.g</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._color.g</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2077</span> </span><span class="WHIT">		</span><span class="NAME">this._color.b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._color.b</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2078</span> </span><span class="WHIT">		</span><span class="NAME">this._color.a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._color.a</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2079</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2080</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._color.r</span><span class="PUNC">,</span><span class="NAME">this._color.g</span><span class="PUNC">,</span><span class="NAME">this._color.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2081</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.strokeStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._color.r</span><span class="PUNC">,</span><span class="NAME">this._color.g</span><span class="PUNC">,</span><span class="NAME">this._color.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2082</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.globalAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._color.a</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2083</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2084</span> 
<span class='line'>2085</span> </span><span class="COMM">/**
<span class='line'>2086</span>  * Sets the alpha the canvas uses to draw geometry and images.
<span class='line'>2087</span>  * @param {number} a The alpha, a number between 0 and 1.
<span class='line'>2088</span>  */</span><span class="WHIT">
<span class='line'>2089</span> </span><span class="NAME">baa.graphics.setAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2090</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"alpha"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2091</span> 
<span class='line'>2092</span> </span><span class="WHIT">	</span><span class="NAME">this._color.a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2093</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ctx.globalAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._color.a</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2094</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2095</span> 
<span class='line'>2096</span> </span><span class="COMM">/**
<span class='line'>2097</span>  * The same as setColor, except for the background. The background color can have no alpha. Uses numbers between 0 and 255.
<span class='line'>2098</span>  * @param {number|array} r Red. If this is an array, the function assumes all numbers are in that array, and disregard all the other arguments.
<span class='line'>2099</span>  * @param {number} g Green.
<span class='line'>2100</span>  * @param {number} b Blue.
<span class='line'>2101</span>  */</span><span class="WHIT">
<span class='line'>2102</span> </span><span class="NAME">baa.graphics.setBackgroundColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2103</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2104</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2105</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"green"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2106</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"blue"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2107</span> 
<span class='line'>2108</span> </span><span class="WHIT">		</span><span class="NAME">this._backgroundColor.r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._backgroundColor.r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2109</span> </span><span class="WHIT">		</span><span class="NAME">this._backgroundColor.g</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._backgroundColor.g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2110</span> </span><span class="WHIT">		</span><span class="NAME">this._backgroundColor.b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">[</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._backgroundColor.b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2111</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2112</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2113</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"red"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2114</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"green"</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2115</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"blue"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2116</span> 
<span class='line'>2117</span> </span><span class="WHIT">		</span><span class="NAME">this._backgroundColor.r</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._backgroundColor.r</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2118</span> </span><span class="WHIT">		</span><span class="NAME">this._backgroundColor.g</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._backgroundColor.g</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">g</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2119</span> </span><span class="WHIT">		</span><span class="NAME">this._backgroundColor.b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">this._backgroundColor.b</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2120</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2121</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2122</span> 
<span class='line'>2123</span> </span><span class="COMM">/**
<span class='line'>2124</span>  * Sets the line width the canvas uses to draw geometry. Is standard on 1.
<span class='line'>2125</span>  * @param {number} width The width of line.
<span class='line'>2126</span>  */</span><span class="WHIT">
<span class='line'>2127</span> </span><span class="NAME">baa.graphics.setLineWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">width</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2128</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"width"</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2129</span> 
<span class='line'>2130</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.lineWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2131</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2132</span> 
<span class='line'>2133</span> </span><span class="COMM">/**
<span class='line'>2134</span>  * Combines baa.graphics.newFont and baa.graphics.setFont to be able to create and set a new font at the same time
<span class='line'>2135</span>  * @see baa.graphics.newFont
<span class='line'>2136</span>  * @see baa.graphics.setfont
<span class='line'>2137</span>  */</span><span class="WHIT">
<span class='line'>2138</span> </span><span class="NAME">baa.graphics.setNewFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fnt</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2139</span> </span><span class="WHIT">	</span><span class="NAME">fnt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.newFont</span><span class="PUNC">(</span><span class="NAME">fnt</span><span class="PUNC">,</span><span class="NAME">size</span><span class="PUNC">,</span><span class="NAME">style</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2140</span> </span><span class="WHIT">	</span><span class="NAME">this.setFont</span><span class="PUNC">(</span><span class="NAME">fnt</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2141</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">fnt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2142</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2143</span> 
<span class='line'>2144</span> </span><span class="COMM">/**
<span class='line'>2145</span>  * Sets a font the canvas uses for printing text.
<span class='line'>2146</span>  * @param {baa.graphics._font} fnt The font to set
<span class='line'>2147</span>  */</span><span class="WHIT">
<span class='line'>2148</span> </span><span class="NAME">baa.graphics.setFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">fnt</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2149</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"font"</span><span class="PUNC">,</span><span class="NAME">fnt</span><span class="PUNC">,</span><span class="STRN">"baa.graphics.font"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2150</span> 
<span class='line'>2151</span> </span><span class="WHIT">	</span><span class="NAME">this._currentFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fnt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2152</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.font</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">fnt.style</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">fnt.size</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"pt "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">fnt.name</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2153</span> 
<span class='line'>2154</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2155</span> 
<span class='line'>2156</span> </span><span class="COMM">/**
<span class='line'>2157</span>  * Sets the blend mode of the canvas. 
<span class='line'>2158</span>  * Options: "source-over", "source-in", "source-out", "source-atop", "destination-over", 
<span class='line'>2159</span>  * "destination-in", "destination-out", "destination-atop", "lighter", "darker", "copy", and "xor".
<span class='line'>2160</span>  * @param {string} mode the blend mode to set.
<span class='line'>2161</span>  */</span><span class="WHIT">
<span class='line'>2162</span> </span><span class="NAME">baa.graphics.setBlendMode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2163</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2164</span> 
<span class='line'>2165</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.globalCompositeOperation</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2166</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2167</span> 
<span class='line'>2168</span> </span><span class="COMM">/**
<span class='line'>2169</span>  * Sets the canvas all future draw operations will be drawn on.
<span class='line'>2170</span>  * @see  baa.graphics._canvas
<span class='line'>2171</span>  * @param {baa.graphics._canvas} cvs The canvas to set
<span class='line'>2172</span>  */</span><span class="WHIT">
<span class='line'>2173</span> </span><span class="NAME">baa.graphics.setCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cvs</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2174</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">,</span><span class="NAME">cvs</span><span class="PUNC">,</span><span class="STRN">"baa.graphics.canvas"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2175</span> 
<span class='line'>2176</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cvs</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2177</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._defaultCtx</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2178</span> </span><span class="WHIT">		</span><span class="NAME">this.canvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._defaultCanvas</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2179</span> </span><span class="WHIT">		</span><span class="NAME">this._currentCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2180</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2181</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2182</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cvs.context</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2183</span> </span><span class="WHIT">		</span><span class="NAME">this.canvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cvs.drawable</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2184</span> </span><span class="WHIT">		</span><span class="NAME">this._currentCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">cvs</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2185</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2186</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2187</span> 
<span class='line'>2188</span> </span><span class="COMM">/**
<span class='line'>2189</span>  * Cuts out a shape, that makes only things drawn inside this shape to appear on the screen.
<span class='line'>2190</span>  * @param {function} [shape] A function with geometry draw calls. The draw calls must use "scissor" as draw mode.
<span class='line'>2191</span>  * @param {object} obj   The object to call the shape function with.
<span class='line'>2192</span>  */</span><span class="WHIT">
<span class='line'>2193</span> </span><span class="NAME">baa.graphics.setScissor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">shape</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2194</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">shape</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2195</span> </span><span class="WHIT">		</span><span class="NAME">this.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2196</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.beginPath</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2197</span> </span><span class="WHIT">		</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">shape</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2198</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.clip</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2199</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2200</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2201</span> </span><span class="WHIT">		</span><span class="NAME">this.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2202</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2203</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2204</span> 
<span class='line'>2205</span> </span><span class="COMM">//Get functions</span><span class="WHIT">
<span class='line'>2206</span> 
<span class='line'>2207</span> </span><span class="COMM">/**
<span class='line'>2208</span>  * Returns the default smoothing of the default canvas.
<span class='line'>2209</span>  * @return {[type]} [description]
<span class='line'>2210</span>  */</span><span class="WHIT">
<span class='line'>2211</span> </span><span class="NAME">baa.graphics.getSmooth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2212</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._defaultSmooth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2213</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2214</span> 
<span class='line'>2215</span> </span><span class="COMM">/**
<span class='line'>2216</span>  * Returns the color currently being used to draw geometry. 
<span class='line'>2217</span>  * @return {array} The color currently in use.
<span class='line'>2218</span>  */</span><span class="WHIT">
<span class='line'>2219</span> </span><span class="NAME">baa.graphics.getColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2220</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this._color.r</span><span class="PUNC">,</span><span class="NAME">this._color.g</span><span class="PUNC">,</span><span class="NAME">this._color.b</span><span class="PUNC">,</span><span class="NAME">this._color.a</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2221</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2222</span> 
<span class='line'>2223</span> </span><span class="COMM">/**
<span class='line'>2224</span>  * Returns the alpha the canvas uses for drawing.
<span class='line'>2225</span>  * @return {number} The alpha currently in use.
<span class='line'>2226</span>  */</span><span class="WHIT">
<span class='line'>2227</span> </span><span class="NAME">baa.graphics.getAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2228</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._color.a</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2229</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2230</span> 
<span class='line'>2231</span> </span><span class="COMM">/**
<span class='line'>2232</span>  * Returns the background color
<span class='line'>2233</span>  * @return {array} The background color
<span class='line'>2234</span>  */</span><span class="WHIT">
<span class='line'>2235</span> </span><span class="NAME">baa.graphics.getBackgroundColor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2236</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NAME">this._backgroundColor.r</span><span class="PUNC">,</span><span class="NAME">this._backgroundColor.g</span><span class="PUNC">,</span><span class="NAME">this._backgroundColor.b</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2237</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2238</span> 
<span class='line'>2239</span> </span><span class="COMM">/**
<span class='line'>2240</span>  * Returns the width of the line currently being used to draw geometry.
<span class='line'>2241</span>  * @return {number} The width of the line
<span class='line'>2242</span>  */</span><span class="WHIT">
<span class='line'>2243</span> </span><span class="NAME">baa.graphics.getLineWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2244</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ctx.lineWidth</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2245</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2246</span> 
<span class='line'>2247</span> </span><span class="COMM">/**
<span class='line'>2248</span>  * Returns the current font being used to print text.
<span class='line'>2249</span>  * @return {baa.graphics._font} The font currently in use.
<span class='line'>2250</span>  */</span><span class="WHIT">
<span class='line'>2251</span> </span><span class="NAME">baa.graphics.getFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2252</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.font</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2253</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2254</span> 
<span class='line'>2255</span> </span><span class="COMM">/**
<span class='line'>2256</span>  * Returns the current canvas being used to draw on.
<span class='line'>2257</span>  * @return {baa.graphics._canvas} The current canvas in use.
<span class='line'>2258</span>  */</span><span class="WHIT">
<span class='line'>2259</span> </span><span class="NAME">baa.graphics.getCanvas</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2260</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.cvs</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2261</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2262</span> 
<span class='line'>2263</span> </span><span class="COMM">/**
<span class='line'>2264</span>  * Returns the width of the current canvas.
<span class='line'>2265</span>  * @return {number} The width of the current canvas in use.
<span class='line'>2266</span>  */</span><span class="WHIT">
<span class='line'>2267</span> </span><span class="NAME">baa.graphics.getWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2268</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.canvas.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2269</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2270</span> 
<span class='line'>2271</span> </span><span class="COMM">/**
<span class='line'>2272</span>  * Returns the height of the current canvas.
<span class='line'>2273</span>  * @return {number} The height of the current canvas in use.
<span class='line'>2274</span>  */</span><span class="WHIT">
<span class='line'>2275</span> </span><span class="NAME">baa.graphics.getHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2276</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.canvas.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2277</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2278</span> 
<span class='line'>2279</span> </span><span class="COMM">/**
<span class='line'>2280</span>  * Returns the text width of a sample text.
<span class='line'>2281</span>  * @param  {string} text The text you want to know the width from.
<span class='line'>2282</span>  * @return {number}   The width of the text;
<span class='line'>2283</span>  */</span><span class="WHIT">
<span class='line'>2284</span> </span><span class="NAME">baa.graphics.getTextWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2285</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ctx.measureText</span><span class="PUNC">(</span><span class="NAME">text</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2286</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2287</span> 
<span class='line'>2288</span> 
<span class='line'>2289</span> </span><span class="COMM">//Coordinate System</span><span class="WHIT">
<span class='line'>2290</span> 
<span class='line'>2291</span> </span><span class="COMM">/**
<span class='line'>2292</span>  * Removes all the translating, scaling, rotating  and shearing.
<span class='line'>2293</span>  */</span><span class="WHIT">
<span class='line'>2294</span> </span><span class="NAME">baa.graphics.origin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2295</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.setTransform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2296</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.scale</span><span class="PUNC">(</span><span class="NAME">baa.graphics._globalScale</span><span class="PUNC">,</span><span class="NAME">baa.graphics._globalScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2297</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2298</span> 
<span class='line'>2299</span> </span><span class="COMM">/**
<span class='line'>2300</span>  * Moves all drawing operations horizontal with x, and vertical with y. This also sets the origin for .rotate, .scale and .shear.
<span class='line'>2301</span>  * @param  {number} x The horizontal movement
<span class='line'>2302</span>  * @param  {number} y The vertical movement
<span class='line'>2303</span>  */</span><span class="WHIT">
<span class='line'>2304</span> </span><span class="NAME">baa.graphics.translate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2305</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2306</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2307</span> </span><span class="WHIT">	</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2308</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.translate</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2309</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2310</span> 
<span class='line'>2311</span> </span><span class="COMM">/**
<span class='line'>2312</span>  * Rotates all the drawing operations. Note that this rotates the whole canvas (at the top left), and not each drawing operation on its own.
<span class='line'>2313</span>  * @param  {number} r The rotation is radians
<span class='line'>2314</span>  */</span><span class="WHIT">
<span class='line'>2315</span> </span><span class="NAME">baa.graphics.rotate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2316</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2317</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.rotate</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2318</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2319</span> 
<span class='line'>2320</span> </span><span class="COMM">/**
<span class='line'>2321</span>  * Scales all the drawing operations. Note that this scales the whole canvas (at the top left), and not each drawing operation on its own.
<span class='line'>2322</span>  * @param  {number} x The horizontal scaling
<span class='line'>2323</span>  * @param  {number} y The vertical scaling
<span class='line'>2324</span>  */</span><span class="WHIT">
<span class='line'>2325</span> </span><span class="NAME">baa.graphics.scale</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2326</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2327</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2328</span> </span><span class="WHIT">	</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2329</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.scale</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2330</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2331</span> 
<span class='line'>2332</span> </span><span class="COMM">/**
<span class='line'>2333</span>  * Scales all the drawing operations. Note that this shears the whole canvas (at the top left), and not each drawing operation on its own.
<span class='line'>2334</span>  * @param  {number} x The horizontal shearing
<span class='line'>2335</span>  * @param  {number} y The vertical shearing
<span class='line'>2336</span>  */</span><span class="WHIT">
<span class='line'>2337</span> </span><span class="NAME">baa.graphics.shear</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2338</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x"</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2339</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y"</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2340</span> </span><span class="WHIT">	</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2341</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.transform</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2342</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2343</span> 
<span class='line'>2344</span> </span><span class="COMM">/**
<span class='line'>2345</span>  * Pushes all the current translating, rotating, scaling and shearing on a stack.
<span class='line'>2346</span>  */</span><span class="WHIT">
<span class='line'>2347</span> </span><span class="NAME">baa.graphics.push</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2348</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.save</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2349</span> </span><span class="WHIT">	</span><span class="NAME">this._stacks</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2350</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2351</span> 
<span class='line'>2352</span> </span><span class="COMM">/**
<span class='line'>2353</span>  * Pops the highest stack, removing all translating, rotating, scaling and shearing on that stack.
<span class='line'>2354</span>  */</span><span class="WHIT">
<span class='line'>2355</span> </span><span class="NAME">baa.graphics.pop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2356</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._stacks</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2357</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2358</span> </span><span class="WHIT">		</span><span class="NAME">this._stacks</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2359</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2360</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2361</span> 
<span class='line'>2362</span> </span><span class="COMM">//Utils</span><span class="WHIT">
<span class='line'>2363</span> 
<span class='line'>2364</span> </span><span class="COMM">/**
<span class='line'>2365</span>  * This is called after every geometry function, to draw the shape filled, in lines or both.
<span class='line'>2366</span>  * @param  {string} mode The fill mode. Options: "fill", "line", "both"
<span class='line'>2367</span>  * @throws {Error} If an invalid mode is used.
<span class='line'>2368</span>  */</span><span class="WHIT">
<span class='line'>2369</span> </span><span class="NAME">baa.graphics._mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2370</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2371</span> 
<span class='line'>2372</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"fill"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2373</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2374</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2375</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2376</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2377</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2378</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"both"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2379</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.fill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2380</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.stroke</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2381</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2382</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"scissor"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2383</span> </span><span class="WHIT">		</span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Error</span><span class="PUNC">(</span><span class="STRN">"Invalid mode "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">mode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2384</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2385</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2386</span> 
<span class='line'>2387</span> </span><span class="COMM">/**
<span class='line'>2388</span>  * Converts RGB to hex
<span class='line'>2389</span>  * @param  {number} r Red
<span class='line'>2390</span>  * @param  {number} g Green
<span class='line'>2391</span>  * @param  {number} b Blue
<span class='line'>2392</span>  * @return {string}   The color in hex
<span class='line'>2393</span>  */</span><span class="WHIT">
<span class='line'>2394</span> </span><span class="NAME">baa.graphics._rgb</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">g</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2395</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">r</span><span class="WHIT"> </span><span class="PUNC">&lt;&lt;</span><span class="WHIT"> </span><span class="NUMB">16</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">g</span><span class="WHIT"> </span><span class="PUNC">&lt;&lt;</span><span class="WHIT"> </span><span class="NUMB">8</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">|</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toString</span><span class="PUNC">(</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2396</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="STRN">"#000000"</span><span class="PUNC">.</span><span class="NAME">substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">7</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">x.length</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2397</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2398</span> 
<span class='line'>2399</span> </span><span class="COMM">/**
<span class='line'>2400</span>  * Resets the font. This is called whenever a change to a font is made.
<span class='line'>2401</span>  */</span><span class="WHIT">
<span class='line'>2402</span> </span><span class="NAME">baa.graphics._resetFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2403</span> </span><span class="WHIT">	</span><span class="NAME">this.ctx.font</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._currentFont.size</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"pt "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._currentFont.name</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2404</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2405</span> 
<span class='line'>2406</span> 
<span class='line'>2407</span> </span><span class="COMM">//Audio</span><span class="WHIT">
<span class='line'>2408</span> 
<span class='line'>2409</span> </span><span class="COMM">/**
<span class='line'>2410</span>  * The audio module takes care of everything you hear, and everything with sound. The audio, volume, pitch.
<span class='line'>2411</span>  * @constructor
<span class='line'>2412</span>  */</span><span class="WHIT">
<span class='line'>2413</span> </span><span class="NAME">baa.audio</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2414</span> 
<span class='line'>2415</span> </span><span class="COMM">/**
<span class='line'>2416</span>  * All the audio files.
<span class='line'>2417</span>  * @see  baa.audio.preload
<span class='line'>2418</span>  */</span><span class="WHIT">
<span class='line'>2419</span> </span><span class="NAME">baa.audio._sources</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2420</span> 
<span class='line'>2421</span> </span><span class="COMM">/**
<span class='line'>2422</span>  * The main volume. Whenever you start a source, the source's volume will be multiplied by the main volume.
<span class='line'>2423</span>  */</span><span class="WHIT">
<span class='line'>2424</span> </span><span class="NAME">baa.audio._masterVolume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2425</span> 
<span class='line'>2426</span> </span><span class="COMM">/**
<span class='line'>2427</span>  * Use this to preload audio. Assumes all audio are in the folder audio/
<span class='line'>2428</span>  * @param {string} ext The extension of the audio. Examples: "ogg", "mp3", "wav"
<span class='line'>2429</span>  * @param {string} ... Names of the audio. Example: "jump", "shoot", "hit" NOT: "audio/jump.ogg", "audio/shoot", "hit.wav"
<span class='line'>2430</span>  */</span><span class="WHIT">
<span class='line'>2431</span> </span><span class="NAME">baa.audio.preload</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2432</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">ext</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2433</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2434</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2435</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">snd</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2436</span> </span><span class="WHIT">		</span><span class="NAME">snd</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">Audio</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2437</span> </span><span class="WHIT">		</span><span class="NAME">snd.oncanplaythrough</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2438</span> </span><span class="WHIT">			</span><span class="NAME">baa._assetsLoaded</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2439</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2440</span> </span><span class="WHIT">		</span><span class="NAME">snd.src</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"audio/"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">name</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">ext</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2441</span> </span><span class="WHIT">		</span><span class="NAME">this._sources</span><span class="PUNC">[</span><span class="NAME">name</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">snd</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2442</span> </span><span class="WHIT">		</span><span class="NAME">baa._assetsToBeLoaded</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2443</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2444</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2445</span> 
<span class='line'>2446</span> </span><span class="COMM">//Recorder functions</span><span class="WHIT">
<span class='line'>2447</span> 
<span class='line'>2448</span> </span><span class="COMM">/**
<span class='line'>2449</span>  * Plays the given audio
<span class='line'>2450</span>  * @param  {baa.audio._source} source The audio to play
<span class='line'>2451</span>  */</span><span class="WHIT">
<span class='line'>2452</span> </span><span class="NAME">baa.audio.play</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2453</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"source"</span><span class="PUNC">,</span><span class="NAME">source</span><span class="PUNC">,</span><span class="STRN">"baa.audio.source"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2454</span> 
<span class='line'>2455</span> </span><span class="WHIT">	</span><span class="NAME">source.audio.play</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2456</span> </span><span class="WHIT">	</span><span class="NAME">source.stopped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2457</span> </span><span class="WHIT">	</span><span class="NAME">source.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2458</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2459</span> 
<span class='line'>2460</span> </span><span class="COMM">/**
<span class='line'>2461</span>  * Stops the given audio, and rewinds it.
<span class='line'>2462</span>  * @param  {baa.audio._source} source The audio to stop
<span class='line'>2463</span>  */</span><span class="WHIT">
<span class='line'>2464</span> </span><span class="NAME">baa.audio.stop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2465</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"source"</span><span class="PUNC">,</span><span class="NAME">source</span><span class="PUNC">,</span><span class="STRN">"baa.audio.source"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2466</span> 
<span class='line'>2467</span> </span><span class="WHIT">	</span><span class="NAME">source.audio.pause</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2468</span> </span><span class="WHIT">	</span><span class="NAME">source.stopped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2469</span> </span><span class="WHIT">	</span><span class="NAME">source.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2470</span> </span><span class="WHIT">	</span><span class="NAME">source.audio.currentTime</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2471</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2472</span> 
<span class='line'>2473</span> </span><span class="COMM">/**
<span class='line'>2474</span>  * Rewinds the given audio.
<span class='line'>2475</span>  * @param  {baa.audio._source} source The audio to rewind
<span class='line'>2476</span>  */</span><span class="WHIT">
<span class='line'>2477</span> </span><span class="NAME">baa.audio.rewind</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2478</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"source"</span><span class="PUNC">,</span><span class="NAME">source</span><span class="PUNC">,</span><span class="STRN">"baa.audio.source"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2479</span> 
<span class='line'>2480</span> </span><span class="WHIT">	</span><span class="NAME">source.audio.currentTime</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2481</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2482</span> 
<span class='line'>2483</span> </span><span class="COMM">/**
<span class='line'>2484</span>  * Pauses the given audio
<span class='line'>2485</span>  * @param  {baa.audio._source} source The audio to pause
<span class='line'>2486</span>  */</span><span class="WHIT">
<span class='line'>2487</span> </span><span class="NAME">baa.audio.pause</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2488</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"source"</span><span class="PUNC">,</span><span class="NAME">source</span><span class="PUNC">,</span><span class="STRN">"baa.audio.source"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2489</span> 
<span class='line'>2490</span> </span><span class="WHIT">	</span><span class="NAME">source.audio.pause</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2491</span> </span><span class="WHIT">	</span><span class="NAME">source.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2492</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2493</span> 
<span class='line'>2494</span> </span><span class="COMM">/**
<span class='line'>2495</span>  * Resumes the given audio
<span class='line'>2496</span>  * @param  {baa.audio._source} source The audio to resume
<span class='line'>2497</span>  */</span><span class="WHIT">
<span class='line'>2498</span> </span><span class="NAME">baa.audio.resume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">source</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2499</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"source"</span><span class="PUNC">,</span><span class="NAME">source</span><span class="PUNC">,</span><span class="STRN">"baa.audio.source"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2500</span> 
<span class='line'>2501</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">source.audio.currentTime</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2502</span> </span><span class="WHIT">		</span><span class="NAME">source.audio.play</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2503</span> </span><span class="WHIT">		</span><span class="NAME">source.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2504</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2505</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2506</span> 
<span class='line'>2507</span> </span><span class="COMM">/**
<span class='line'>2508</span>  * Sets the master volume. Whenever you start a source, the source's volume will be multiplied by the master volume.
<span class='line'>2509</span>  * @param {number} volume What you want the master volume to set to
<span class='line'>2510</span>  */</span><span class="WHIT">
<span class='line'>2511</span> </span><span class="NAME">baa.audio.setVolume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">volume</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2512</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"volume"</span><span class="PUNC">,</span><span class="NAME">volume</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2513</span> 
<span class='line'>2514</span> </span><span class="WHIT">	</span><span class="NAME">this.masterVolume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">volume</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2515</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2516</span> 
<span class='line'>2517</span> 
<span class='line'>2518</span> </span><span class="COMM">//New functions</span><span class="WHIT">
<span class='line'>2519</span> 
<span class='line'>2520</span> </span><span class="COMM">/**
<span class='line'>2521</span>  * An audio object. Makes it able to read data of the audio, and set the volume for specific audio.
<span class='line'>2522</span>  * @constructor
<span class='line'>2523</span>  * @throws {Error} If url is a non-existing source.
<span class='line'>2524</span>  * @param {string} url The url of the source
<span class='line'>2525</span>  * @param {boolean} stopped If the audio is stopped.
<span class='line'>2526</span>  * @param {boolean} playing If the audio is playing.
<span class='line'>2527</span>  */</span><span class="WHIT">
<span class='line'>2528</span> </span><span class="NAME">baa.audio._source</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.audio.source"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2529</span> 
<span class='line'>2530</span> </span><span class="NAME">baa.audio._source.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2531</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"url"</span><span class="PUNC">,</span><span class="NAME">url</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2532</span> 
<span class='line'>2533</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.graphics._sources</span><span class="PUNC">[</span><span class="NAME">url</span><span class="PUNC">]</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="STRN">"Audio '"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">url</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"' doesn't exist. Did you forgot to preload it?"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2534</span> </span><span class="WHIT">	</span><span class="NAME">this.audio</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.audio.sources</span><span class="PUNC">[</span><span class="NAME">url</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2535</span> </span><span class="WHIT">	</span><span class="NAME">this.stopped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2536</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2537</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2538</span> 
<span class='line'>2539</span> </span><span class="COMM">/**
<span class='line'>2540</span>  * Plays the audio.
<span class='line'>2541</span>  */</span><span class="WHIT">
<span class='line'>2542</span> </span><span class="NAME">baa.audio._source.play</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2543</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">oVol</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.audio.volume</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2544</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.volume</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.audio.masterVolume</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2545</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.play</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2546</span> </span><span class="WHIT">	</span><span class="NAME">this.stopped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2547</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2548</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.volume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">oVol</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2549</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2550</span> 
<span class='line'>2551</span> </span><span class="COMM">/**
<span class='line'>2552</span>  * Stops the audio.
<span class='line'>2553</span>  */</span><span class="WHIT">
<span class='line'>2554</span> </span><span class="NAME">baa.audio._source.stop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2555</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.pause</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2556</span> </span><span class="WHIT">	</span><span class="NAME">this.stopped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2557</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.currentTime</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2558</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2559</span> 
<span class='line'>2560</span> </span><span class="COMM">/**
<span class='line'>2561</span>  * Pauses the audio.
<span class='line'>2562</span>  */</span><span class="WHIT">
<span class='line'>2563</span> </span><span class="NAME">baa.audio._source.pause</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2564</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.pause</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2565</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2566</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2567</span> 
<span class='line'>2568</span> </span><span class="COMM">/**
<span class='line'>2569</span>  * Resumes the audio.
<span class='line'>2570</span>  */</span><span class="WHIT">
<span class='line'>2571</span> </span><span class="NAME">baa.audio._source.resume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2572</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.audio.currentTime</span><span class="PUNC">></span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2573</span> </span><span class="WHIT">		</span><span class="NAME">this.audio.play</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2574</span> </span><span class="WHIT">		</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2575</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2576</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2577</span> 
<span class='line'>2578</span> </span><span class="COMM">/**
<span class='line'>2579</span>  * Rewinds the audio
<span class='line'>2580</span>  */</span><span class="WHIT">
<span class='line'>2581</span> </span><span class="NAME">baa.audio._source.rewind</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2582</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.currentTime</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2583</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2584</span> 
<span class='line'>2585</span> </span><span class="COMM">/**
<span class='line'>2586</span>  * Returns the volume of the audio.
<span class='line'>2587</span>  * @return {number} The volume of the audio
<span class='line'>2588</span>  */</span><span class="WHIT">
<span class='line'>2589</span> </span><span class="NAME">baa.audio._source.getVolume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2590</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.audio.volume</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2591</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2592</span> 
<span class='line'>2593</span> </span><span class="COMM">/**
<span class='line'>2594</span>  * Sets the volume of the audio. 0 is no sound, 1 is full sound.
<span class='line'>2595</span>  * @param {number} volume What the volume to set to
<span class='line'>2596</span>  */</span><span class="WHIT">
<span class='line'>2597</span> </span><span class="NAME">baa.audio._source.setVolume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">volume</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2598</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"volume"</span><span class="PUNC">,</span><span class="NAME">volume</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2599</span> 
<span class='line'>2600</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.volume</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">volume</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2601</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2602</span> 
<span class='line'>2603</span> </span><span class="COMM">/**
<span class='line'>2604</span>  * Returns if the audio is looping.
<span class='line'>2605</span>  * @return {boolean} If the audio is looping.
<span class='line'>2606</span>  */</span><span class="WHIT">
<span class='line'>2607</span> </span><span class="NAME">baa.audio._source.isLooping</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2608</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.audio.loop</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2609</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2610</span> 
<span class='line'>2611</span> </span><span class="COMM">/**
<span class='line'>2612</span>  * Sets if the audio should loop
<span class='line'>2613</span>  * @param {boolean} loop If the audio should loop
<span class='line'>2614</span>  */</span><span class="WHIT">
<span class='line'>2615</span> </span><span class="NAME">baa.audio._source.setLooping</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">loop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2616</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"loop"</span><span class="PUNC">,</span><span class="NAME">loop</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2617</span> 
<span class='line'>2618</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.loop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">loop</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2619</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2620</span> 
<span class='line'>2621</span> </span><span class="COMM">/**
<span class='line'>2622</span>  * Returns if the audio is currently playing 
<span class='line'>2623</span>  * @return {boolean} If the audio is currently playing
<span class='line'>2624</span>  */</span><span class="WHIT">
<span class='line'>2625</span> </span><span class="NAME">baa.audio._source.isPlaying</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2626</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.playing</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2627</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2628</span> 
<span class='line'>2629</span> </span><span class="COMM">/**
<span class='line'>2630</span>  * Returns if the audio is currently paused. 
<span class='line'>2631</span>  * @return {boolean} If the audio is currently paused.
<span class='line'>2632</span>  */</span><span class="WHIT">
<span class='line'>2633</span> </span><span class="NAME">baa.audio._source.isPaused</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2634</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.audio.paused</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2635</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2636</span> 
<span class='line'>2637</span> </span><span class="COMM">/**
<span class='line'>2638</span>  * Returns if the audio is currently stopped. 
<span class='line'>2639</span>  * @return {boolean} If the audio is currently stopped.
<span class='line'>2640</span>  */</span><span class="WHIT">
<span class='line'>2641</span> </span><span class="NAME">baa.audio._source.isStopped</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2642</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.stopped</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2643</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2644</span> 
<span class='line'>2645</span> </span><span class="COMM">/**
<span class='line'>2646</span>  * Sets the pitch of the audio. The higher the pitch, the faster the audio goes.
<span class='line'>2647</span>  * @param {number} pitch What the pitch to set to.
<span class='line'>2648</span>  */</span><span class="WHIT">
<span class='line'>2649</span> </span><span class="NAME">baa.audio._source.setPitch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">pitch</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2650</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"pitch"</span><span class="PUNC">,</span><span class="NAME">pitch</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2651</span> 
<span class='line'>2652</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.playbackRate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">pitch</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2653</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2654</span> 
<span class='line'>2655</span> </span><span class="COMM">/**
<span class='line'>2656</span>  * Returns the current pitch of the audio.
<span class='line'>2657</span>  * @return {number} The current pitch of the audio.
<span class='line'>2658</span>  */</span><span class="WHIT">
<span class='line'>2659</span> </span><span class="NAME">baa.audio._source.getPtich</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2660</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.audio.playbackRate</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2661</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2662</span> 
<span class='line'>2663</span> </span><span class="COMM">/**
<span class='line'>2664</span>  * Sets the current audio at a specific time, skipping part of the song, or rewinding a part back.
<span class='line'>2665</span>  * @param  {number} position The position to set to.
<span class='line'>2666</span>  */</span><span class="WHIT">
<span class='line'>2667</span> </span><span class="NAME">baa.audio._source.seek</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">position</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2668</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"position"</span><span class="PUNC">,</span><span class="NAME">position</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2669</span> 
<span class='line'>2670</span> </span><span class="WHIT">	</span><span class="NAME">this.audio.currentTime</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">position</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2671</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2672</span> 
<span class='line'>2673</span> </span><span class="COMM">/**
<span class='line'>2674</span>  * Returns the time the audio currently is at.
<span class='line'>2675</span>  * @return {number} The time the audio currently is at.
<span class='line'>2676</span>  */</span><span class="WHIT">
<span class='line'>2677</span> </span><span class="NAME">baa.audio._source.tell</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2678</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.audio.currentTime</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2679</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2680</span> 
<span class='line'>2681</span> </span><span class="COMM">/**
<span class='line'>2682</span>  * Creates a new source. This is used to keep source a private object.
<span class='line'>2683</span>  * @see  baa.audio._source
<span class='line'>2684</span>  * @return {baa.audio._source} The new source
<span class='line'>2685</span>  */</span><span class="WHIT">
<span class='line'>2686</span> </span><span class="NAME">baa.audio.newSource</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2687</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._source.new</span><span class="PUNC">(</span><span class="NAME">url</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2688</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2689</span> 
<span class='line'>2690</span> 
<span class='line'>2691</span> </span><span class="COMM">//Keyboard</span><span class="WHIT">
<span class='line'>2692</span> 
<span class='line'>2693</span> </span><span class="COMM">/**
<span class='line'>2694</span>  * Keyboard takes care for all they key events. All keys are converted to strings.
<span class='line'>2695</span>  * @constructor
<span class='line'>2696</span>  */</span><span class="WHIT">
<span class='line'>2697</span> </span><span class="NAME">baa.keyboard</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2698</span> 
<span class='line'>2699</span> </span><span class="COMM">/**
<span class='line'>2700</span>  * All the keys as objects. Every object has a key corresponding to it's... key.
<span class='line'>2701</span>  */</span><span class="WHIT">
<span class='line'>2702</span> </span><span class="NAME">baa.keyboard._keys</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2703</span> 
<span class='line'>2704</span> </span><span class="COMM">/**
<span class='line'>2705</span>  * An array of keys that are currently pressed.
<span class='line'>2706</span>  */</span><span class="WHIT">
<span class='line'>2707</span> </span><span class="NAME">baa.keyboard._pressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2708</span> 
<span class='line'>2709</span> </span><span class="COMM">/**
<span class='line'>2710</span>  * An array of all the keys that are currently released.
<span class='line'>2711</span>  */</span><span class="WHIT">
<span class='line'>2712</span> </span><span class="NAME">baa.keyboard._released</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2713</span> 
<span class='line'>2714</span> </span><span class="COMM">/**
<span class='line'>2715</span>  * The keys converted to strings. Most keycodes can be converted to strings with String.fromCharCode().lowerCase. These are exceptions.
<span class='line'>2716</span>  */</span><span class="WHIT">
<span class='line'>2717</span> </span><span class="NAME">baa.keyboard._constant</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2718</span> </span><span class="WHIT">	</span><span class="NUMB">8</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"backspace"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2719</span> </span><span class="WHIT">	</span><span class="NUMB">9</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"tab"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2720</span> </span><span class="WHIT">	</span><span class="NUMB">13</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"return"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2721</span> </span><span class="WHIT">	</span><span class="NUMB">16</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"shift"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2722</span> </span><span class="WHIT">	</span><span class="NUMB">17</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"ctrl"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2723</span> </span><span class="WHIT">	</span><span class="NUMB">18</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"alt"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2724</span> </span><span class="WHIT">	</span><span class="NUMB">19</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"pause"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2725</span> </span><span class="WHIT">	</span><span class="NUMB">20</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"capslock"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2726</span> </span><span class="WHIT">	</span><span class="NUMB">27</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"escape"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2727</span> </span><span class="WHIT">	</span><span class="NUMB">33</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"pageup"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2728</span> </span><span class="WHIT">	</span><span class="NUMB">34</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"pagedown"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2729</span> </span><span class="WHIT">	</span><span class="NUMB">35</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"end"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2730</span> </span><span class="WHIT">	</span><span class="NUMB">36</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"home"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2731</span> </span><span class="WHIT">	</span><span class="NUMB">45</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"insert"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2732</span> </span><span class="WHIT">	</span><span class="NUMB">46</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"delete"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2733</span> </span><span class="WHIT">	</span><span class="NUMB">37</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"left"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2734</span> </span><span class="WHIT">	</span><span class="NUMB">38</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"up"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2735</span> </span><span class="WHIT">	</span><span class="NUMB">39</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"right"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2736</span> </span><span class="WHIT">	</span><span class="NUMB">40</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"down"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2737</span> </span><span class="WHIT">	</span><span class="NUMB">91</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"lmeta"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2738</span> </span><span class="WHIT">	</span><span class="NUMB">92</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"rmeta"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2739</span> </span><span class="WHIT">	</span><span class="NUMB">93</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"mode"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2740</span> </span><span class="WHIT">	</span><span class="NUMB">96</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp0"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2741</span> </span><span class="WHIT">	</span><span class="NUMB">97</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp1"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2742</span> </span><span class="WHIT">	</span><span class="NUMB">98</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp2"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2743</span> </span><span class="WHIT">	</span><span class="NUMB">99</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp3"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2744</span> </span><span class="WHIT">	</span><span class="NUMB">100</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp4"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2745</span> </span><span class="WHIT">	</span><span class="NUMB">101</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp5"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2746</span> </span><span class="WHIT">	</span><span class="NUMB">102</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp6"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2747</span> </span><span class="WHIT">	</span><span class="NUMB">103</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp7"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2748</span> </span><span class="WHIT">	</span><span class="NUMB">104</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp8"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2749</span> </span><span class="WHIT">	</span><span class="NUMB">105</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp9"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2750</span> </span><span class="WHIT">	</span><span class="NUMB">106</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp*"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2751</span> </span><span class="WHIT">	</span><span class="NUMB">107</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp+"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2752</span> </span><span class="WHIT">	</span><span class="NUMB">109</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp-"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2753</span> </span><span class="WHIT">	</span><span class="NUMB">110</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp."</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2754</span> </span><span class="WHIT">	</span><span class="NUMB">111</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"kp/"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2755</span> </span><span class="WHIT">	</span><span class="NUMB">112</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f1"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2756</span> </span><span class="WHIT">	</span><span class="NUMB">113</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f2"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2757</span> </span><span class="WHIT">	</span><span class="NUMB">114</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f3"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2758</span> </span><span class="WHIT">	</span><span class="NUMB">115</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f4"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2759</span> </span><span class="WHIT">	</span><span class="NUMB">116</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f5"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2760</span> </span><span class="WHIT">	</span><span class="NUMB">117</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f6"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2761</span> </span><span class="WHIT">	</span><span class="NUMB">118</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f7"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2762</span> </span><span class="WHIT">	</span><span class="NUMB">119</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f8"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2763</span> </span><span class="WHIT">	</span><span class="NUMB">120</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f9"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2764</span> </span><span class="WHIT">	</span><span class="NUMB">121</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f10"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2765</span> </span><span class="WHIT">	</span><span class="NUMB">122</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f11"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2766</span> </span><span class="WHIT">	</span><span class="NUMB">123</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"f12"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2767</span> </span><span class="WHIT">	</span><span class="NUMB">144</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"numlock"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2768</span> </span><span class="WHIT">	</span><span class="NUMB">145</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"scrolllock"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2769</span> </span><span class="WHIT">	</span><span class="NUMB">186</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">","</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2770</span> </span><span class="WHIT">	</span><span class="NUMB">187</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"="</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2771</span> </span><span class="WHIT">	</span><span class="NUMB">188</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">","</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2772</span> </span><span class="WHIT">	</span><span class="NUMB">189</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2773</span> </span><span class="WHIT">	</span><span class="NUMB">190</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2774</span> </span><span class="WHIT">	</span><span class="NUMB">191</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"/"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2775</span> </span><span class="WHIT">	</span><span class="NUMB">192</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"`"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2776</span> </span><span class="WHIT">	</span><span class="NUMB">219</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"["</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2777</span> </span><span class="WHIT">	</span><span class="NUMB">220</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"\\"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2778</span> </span><span class="WHIT">	</span><span class="NUMB">221</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"]"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2779</span> </span><span class="WHIT">	</span><span class="NUMB">222</span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">"'"</span><span class="WHIT">
<span class='line'>2780</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2781</span> 
<span class='line'>2782</span> </span><span class="COMM">/**
<span class='line'>2783</span>  * This is called every time a key is pressed
<span class='line'>2784</span>  * @param  {object} event The Event object. 
<span class='line'>2785</span>  */</span><span class="WHIT">
<span class='line'>2786</span> </span><span class="NAME">baa.keyboard._downHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2787</span> </span><span class="WHIT">	</span><span class="COMM">// event.preventDefault();  </span><span class="WHIT">
<span class='line'>2788</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">keyPressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.keyboard._constant</span><span class="PUNC">[</span><span class="NAME">event.keyCode</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">event.keyCode</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2789</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">baa.keyboard._keys</span><span class="PUNC">[</span><span class="NAME">keyPressed</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2790</span> </span><span class="WHIT">		</span><span class="NAME">baa.keyboard._pressed.push</span><span class="PUNC">(</span><span class="NAME">keyPressed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2791</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyPressed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2792</span> </span><span class="WHIT">			</span><span class="NAME">baa.keyPressed</span><span class="PUNC">(</span><span class="NAME">keyPressed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2793</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2794</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2795</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.keypressed</span><span class="PUNC">(</span><span class="NAME">keyPressed</span><span class="PUNC">,</span><span class="NAME">event.keyCode</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2796</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2797</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2798</span> </span><span class="WHIT">	</span><span class="NAME">baa.keyboard._keys</span><span class="PUNC">[</span><span class="NAME">keyPressed</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2799</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2800</span> 
<span class='line'>2801</span> </span><span class="COMM">/**
<span class='line'>2802</span>  * This is called every time a key is released.
<span class='line'>2803</span>  * @param  {object} event The Event object. 
<span class='line'>2804</span>  */</span><span class="WHIT">
<span class='line'>2805</span> </span><span class="NAME">baa.keyboard._upHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2806</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">keyReleased</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.keyboard._constant</span><span class="PUNC">[</span><span class="NAME">event.keyCode</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">String.fromCharCode</span><span class="PUNC">(</span><span class="NAME">event.keyCode</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">toLowerCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2807</span> </span><span class="WHIT">	</span><span class="NAME">baa.keyboard._released.push</span><span class="PUNC">(</span><span class="NAME">keyReleased</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2808</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyReleased</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2809</span> </span><span class="WHIT">		</span><span class="NAME">baa.keyReleased</span><span class="PUNC">(</span><span class="NAME">keyReleased</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2810</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2811</span> </span><span class="WHIT">	</span><span class="NAME">baa.keyboard._keys</span><span class="PUNC">[</span><span class="NAME">keyReleased</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2812</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2813</span> 
<span class='line'>2814</span> </span><span class="COMM">/**
<span class='line'>2815</span>  * Returns if any of the given keys is currently down. You can give infinite arguments, or give an array as the first argument.
<span class='line'>2816</span>  * @return {string|array} ... The keys you want to check. If the first arugment is an array, 
<span class='line'>2817</span>  * it will check the strings in the array, and disregard all other arguments.
<span class='line'>2818</span>  */</span><span class="WHIT">
<span class='line'>2819</span> </span><span class="NAME">baa.keyboard.isDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2820</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2821</span> </span><span class="WHIT">		</span><span class="NAME">arguments</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2822</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2823</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2824</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2825</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyboard._keys</span><span class="PUNC">[</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2826</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2827</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2828</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2829</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2830</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2831</span> 
<span class='line'>2832</span> </span><span class="COMM">/**
<span class='line'>2833</span>  * Returns if any of the given keys has just been pressed. You can give infinite arguments, or give an array as the first argument.
<span class='line'>2834</span>  * @return {string|array} ... The keys you want to check. If the first arugment is an array, 
<span class='line'>2835</span>  * it will check the strings in the array, and disregard all other arguments.
<span class='line'>2836</span>  */</span><span class="WHIT">
<span class='line'>2837</span> </span><span class="NAME">baa.keyboard.isPressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2838</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2839</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2840</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._pressed.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2841</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._pressed</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2842</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2843</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2844</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2845</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2846</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2847</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2848</span> 
<span class='line'>2849</span> </span><span class="COMM">/**
<span class='line'>2850</span>  * Returns if any of the given keys has just been released. You can give infinite arguments, or give an array as the first argument.
<span class='line'>2851</span>  * @return {string|array} ... The keys you want to check. If the first arugment is an array, 
<span class='line'>2852</span>  * it will check the strings in the array, and disregard all other arguments.
<span class='line'>2853</span>  */</span><span class="WHIT">
<span class='line'>2854</span> </span><span class="NAME">baa.keyboard.isReleased</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2855</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2856</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2857</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._released.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2858</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._released</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2859</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2860</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2861</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2862</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2863</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2864</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2865</span> 
<span class='line'>2866</span> </span><span class="COMM">//Mouse</span><span class="WHIT">
<span class='line'>2867</span> 
<span class='line'>2868</span> </span><span class="COMM">/**
<span class='line'>2869</span>  * Mouse takes care for the buttons, and for the cursor position. baa.mouse is of the type baa.point, allowing you to check overlap with rectangles.
<span class='line'>2870</span>  */</span><span class="WHIT">
<span class='line'>2871</span> </span><span class="NAME">baa.mouse</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2872</span> 
<span class='line'>2873</span> </span><span class="COMM">/**
<span class='line'>2874</span>  * The buttons of the mouse. Each button is it's own object so that it can be set true or false, when it's down or not.
<span class='line'>2875</span>  */</span><span class="WHIT">
<span class='line'>2876</span> </span><span class="NAME">baa.mouse._buttons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2877</span> 
<span class='line'>2878</span> </span><span class="COMM">/**
<span class='line'>2879</span>  * An array of all the buttons that are pressed.
<span class='line'>2880</span>  */</span><span class="WHIT">
<span class='line'>2881</span> </span><span class="NAME">baa.mouse._pressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2882</span> 
<span class='line'>2883</span> </span><span class="COMM">/**
<span class='line'>2884</span>  * An array of all the buttons that are released.
<span class='line'>2885</span>  */</span><span class="WHIT">
<span class='line'>2886</span> </span><span class="NAME">baa.mouse._released</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2887</span> 
<span class='line'>2888</span> </span><span class="COMM">/**
<span class='line'>2889</span>  * The names of all the keys with their corresponding keycode.
<span class='line'>2890</span>  */</span><span class="WHIT">
<span class='line'>2891</span> </span><span class="NAME">baa.mouse._constant</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2892</span> </span><span class="WHIT">	</span><span class="NUMB">0</span><span class="PUNC">:</span><span class="STRN">"l"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2893</span> </span><span class="WHIT">	</span><span class="NUMB">1</span><span class="PUNC">:</span><span class="STRN">"m"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2894</span> </span><span class="WHIT">	</span><span class="NUMB">2</span><span class="PUNC">:</span><span class="STRN">"r"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2895</span> </span><span class="WHIT">	</span><span class="NUMB">4</span><span class="PUNC">:</span><span class="STRN">"wu"</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>2896</span> </span><span class="WHIT">	</span><span class="NUMB">5</span><span class="PUNC">:</span><span class="STRN">"wd"</span><span class="WHIT">
<span class='line'>2897</span> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2898</span> 
<span class='line'>2899</span> </span><span class="NAME">baa.mouse._scaling</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">
<span class='line'>2900</span> 
<span class='line'>2901</span> </span><span class="NAME">baa.mouse._relative</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2902</span> 
<span class='line'>2903</span> </span><span class="NAME">baa.mouse.ox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2904</span> </span><span class="NAME">baa.mouse.oy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2905</span> 
<span class='line'>2906</span> </span><span class="COMM">/**
<span class='line'>2907</span>  * This is called everything the mouse is moved.
<span class='line'>2908</span>  * @param  {object} event The Event object.
<span class='line'>2909</span>  */</span><span class="WHIT">
<span class='line'>2910</span> </span><span class="NAME">baa.mouse._move</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2911</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse.ox</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.clientX</span><span class="PUNC">-</span><span class="NUMB">4</span><span class="WHIT">
<span class='line'>2912</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse.oy</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">event.clientY</span><span class="PUNC">-</span><span class="NUMB">9</span><span class="WHIT">
<span class='line'>2913</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2914</span> 
<span class='line'>2915</span> </span><span class="COMM">/**
<span class='line'>2916</span>  * This is called everything a mouse button is clicked.
<span class='line'>2917</span>  * @param  {object} event The Event object.
<span class='line'>2918</span>  */</span><span class="WHIT">
<span class='line'>2919</span> </span><span class="NAME">baa.mouse._downHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2920</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mousepressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse._constant</span><span class="PUNC">[</span><span class="NAME">event.button</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2921</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">baa.mouse._buttons</span><span class="PUNC">[</span><span class="NAME">mousepressed</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2922</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse._pressed.push</span><span class="PUNC">(</span><span class="NAME">mousepressed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2923</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mousepressed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2924</span> </span><span class="WHIT">			</span><span class="NAME">baa.mousepressed</span><span class="PUNC">(</span><span class="NAME">mousepressed</span><span class="PUNC">,</span><span class="NAME">event.clientX</span><span class="PUNC">,</span><span class="NAME">event.clientY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2925</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2926</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2927</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.mousepressed</span><span class="PUNC">(</span><span class="NAME">mousepressed</span><span class="PUNC">,</span><span class="NAME">event.clientX</span><span class="PUNC">,</span><span class="NAME">event.clientY</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2928</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2929</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2930</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse._buttons</span><span class="PUNC">[</span><span class="NAME">mousepressed</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2931</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2932</span> 
<span class='line'>2933</span> </span><span class="COMM">/**
<span class='line'>2934</span>  * This is called everything a mouse button is released.
<span class='line'>2935</span>  * @param  {object} event The Event object.
<span class='line'>2936</span>  */</span><span class="WHIT">
<span class='line'>2937</span> </span><span class="NAME">baa.mouse._upHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2938</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mousereleased</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse._constant</span><span class="PUNC">[</span><span class="NAME">event.button</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2939</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse._buttons</span><span class="PUNC">[</span><span class="NAME">mousereleased</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2940</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse._released.push</span><span class="PUNC">(</span><span class="NAME">mousereleased</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2941</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mousereleased</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2942</span> </span><span class="WHIT">			</span><span class="NAME">baa.mousereleased</span><span class="PUNC">(</span><span class="NAME">mousereleased</span><span class="PUNC">,</span><span class="NAME">event.clientX</span><span class="PUNC">,</span><span class="NAME">event.clientY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2943</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2944</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2945</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse._buttons</span><span class="PUNC">[</span><span class="NAME">mousereleased</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2946</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2947</span> 
<span class='line'>2948</span> </span><span class="COMM">/**
<span class='line'>2949</span>  * This is called everything the mousewheel is scrolled.
<span class='line'>2950</span>  * @param  {object} event The Event object.
<span class='line'>2951</span>  */</span><span class="WHIT">
<span class='line'>2952</span> </span><span class="NAME">baa.mouse._wheelHandler</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">event</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2953</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">mousepressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse._constant</span><span class="PUNC">[</span><span class="NAME">event.wheelDelta</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">4</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2954</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">baa.mouse._buttons</span><span class="PUNC">[</span><span class="NAME">mousepressed</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2955</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse._pressed.push</span><span class="PUNC">(</span><span class="NAME">mousepressed</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2956</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mousepressed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2957</span> </span><span class="WHIT">			</span><span class="NAME">baa.mousepressed</span><span class="PUNC">(</span><span class="NAME">mousepressed</span><span class="PUNC">,</span><span class="NAME">event.clientX</span><span class="PUNC">,</span><span class="NAME">event.clientY</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2958</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2959</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2960</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.mousepressed</span><span class="PUNC">(</span><span class="NAME">mousepressed</span><span class="PUNC">,</span><span class="NAME">event.clientX</span><span class="PUNC">,</span><span class="NAME">event.clientY</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>2961</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2962</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2963</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2964</span> 
<span class='line'>2965</span> </span><span class="COMM">/**
<span class='line'>2966</span>  * Returns the horizontal position of the mouse.
<span class='line'>2967</span>  * @return {number} The horizontal position of the mouse.
<span class='line'>2968</span>  */</span><span class="WHIT">
<span class='line'>2969</span> </span><span class="NAME">baa.mouse.getX</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2970</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2971</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2972</span> 
<span class='line'>2973</span> </span><span class="COMM">/**
<span class='line'>2974</span>  * Returns the vertical position of the mouse.
<span class='line'>2975</span>  * @return {number} The vertical position of the mouse.
<span class='line'>2976</span>  */</span><span class="WHIT">
<span class='line'>2977</span> </span><span class="NAME">baa.mouse.getY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2978</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2979</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2980</span> 
<span class='line'>2981</span> </span><span class="COMM">/**
<span class='line'>2982</span>  * Returns if any of the given buttons is currently down. You can give infinite arguments, or give an array as the first argument.
<span class='line'>2983</span>  * @return {string|array} ... The buttons you want to check. If the first arugment is an array, 
<span class='line'>2984</span>  * it will check the strings in the array, and disregard all other arguments.
<span class='line'>2985</span>  */</span><span class="WHIT">
<span class='line'>2986</span> </span><span class="NAME">baa.mouse.isDown</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2987</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2988</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2989</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse._buttons</span><span class="PUNC">[</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>2990</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2991</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2992</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2993</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>2994</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>2995</span> 
<span class='line'>2996</span> </span><span class="COMM">/**
<span class='line'>2997</span>  * Returns if any of the given buttons has just been pressed. You can give infinite arguments, or give an array as the first argument.
<span class='line'>2998</span>  * @return {string|array} ... The buttons you want to check. If the first arugment is an array, 
<span class='line'>2999</span>  * it will check the strings in the array, and disregard all other arguments.
<span class='line'>3000</span>  */</span><span class="WHIT">
<span class='line'>3001</span> </span><span class="NAME">baa.mouse.isPressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3002</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3003</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3004</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._pressed.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3005</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._pressed</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3006</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3007</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3008</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3009</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3010</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3011</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3012</span> 
<span class='line'>3013</span> </span><span class="COMM">/**
<span class='line'>3014</span>  * Returns if any of the given buttons has just been pressed. You can give infinite arguments, or give an array as the first argument.
<span class='line'>3015</span>  * @return {string|array} ... The buttons you want to check. If this is an array, it will check the strings in the array, and disregard all other arguments.
<span class='line'>3016</span>  */</span><span class="WHIT">
<span class='line'>3017</span> </span><span class="NAME">baa.mouse.isReleased</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3018</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3019</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3020</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._released.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3021</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._released</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3022</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3023</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3024</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3025</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3026</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3027</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3028</span> 
<span class='line'>3029</span> </span><span class="COMM">/**
<span class='line'>3030</span>  * Removes the given button from the list of pressed buttons. Useful for when you want to click on something, and not have something behind that affected by it.
<span class='line'>3031</span>  * @param  {string} button The button you want to remove
<span class='line'>3032</span>  */</span><span class="WHIT">
<span class='line'>3033</span> </span><span class="NAME">baa.mouse.catchPressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3034</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">,</span><span class="NAME">button</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3035</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._pressed.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3036</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._pressed</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3037</span> </span><span class="WHIT">			</span><span class="NAME">this._pressed.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3038</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3039</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3040</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3041</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3042</span> 
<span class='line'>3043</span> </span><span class="COMM">/**
<span class='line'>3044</span>  * Removes the given button from the list of released buttons. Useful for when you want to click on something, and not have something behind that affected by it.
<span class='line'>3045</span>  * @param  {string} button The button you want to remove
<span class='line'>3046</span>  */</span><span class="WHIT">
<span class='line'>3047</span> </span><span class="NAME">baa.mouse.catchReleased</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3048</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">,</span><span class="NAME">button</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3049</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._released.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3050</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this._released</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3051</span> </span><span class="WHIT">			</span><span class="NAME">this._released.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3052</span> </span><span class="WHIT">			</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3053</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3054</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3055</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3056</span> 
<span class='line'>3057</span> </span><span class="COMM">/**
<span class='line'>3058</span>  * Sets the look of the cursor. Options: TODO: ADD OPTIONS!
<span class='line'>3059</span>  * @param {string} cursor What you want the cursor to set to.
<span class='line'>3060</span>  */</span><span class="WHIT">
<span class='line'>3061</span> </span><span class="NAME">baa.mouse.setCursor</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">cursor</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3062</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"button"</span><span class="PUNC">,</span><span class="NAME">cursor</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3063</span> </span><span class="WHIT">	</span><span class="NAME">document.getElementById</span><span class="PUNC">(</span><span class="STRN">"canvas"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">style.cursor</span><span class="PUNC">=</span><span class="NAME">cursor</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3064</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3065</span> 
<span class='line'>3066</span> 
<span class='line'>3067</span> </span><span class="COMM">//Filesystem</span><span class="WHIT">
<span class='line'>3068</span> 
<span class='line'>3069</span> </span><span class="COMM">/**
<span class='line'>3070</span>  * The filesystem takes care foar loading and saving data to the local storage.
<span class='line'>3071</span>  */</span><span class="WHIT">
<span class='line'>3072</span> </span><span class="NAME">baa.filesystem</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3073</span> 
<span class='line'>3074</span> </span><span class="COMM">//Filesystem uses store.js</span><span class="WHIT">
<span class='line'>3075</span> </span><span class="COMM">/* Copyright (c) 2010-2013 Marcus Westin */</span><span class="WHIT">
<span class='line'>3076</span> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">o</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">r</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">&&</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">e.document</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">=</span><span class="STRN">"localStorage"</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">=</span><span class="STRN">"script"</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">t.disabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3077</span> </span><span class="NAME">t.set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.get</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.remove</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.clear</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.transact</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">t.get</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">r</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3078</span> </span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">==</span><span class="STRN">"undefined"</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">||</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">r</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t.set</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.getAll</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.forEach</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.serialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">JSON.stringify</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3079</span> </span><span class="NAME">t.deserialize</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">!=</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">JSON.parse</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">||</span><span class="NAME">undefined</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">o</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">r</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">t.set</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3080</span> </span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">?</span><span class="NAME">t.remove</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">s.setItem</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">t.serialize</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.get</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t.deserialize</span><span class="PUNC">(</span><span class="NAME">s.getItem</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.remove</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s.removeItem</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3081</span> </span><span class="NAME">t.clear</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">s.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.getAll</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">e</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">e</span><span class="PUNC">[</span><span class="NAME">t</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">n</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.forEach</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">&lt;</span><span class="NAME">s.length</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3082</span> </span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">s.key</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">,</span><span class="NAME">t.get</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="PUNC">(</span><span class="NAME">n.documentElement.addBehavior</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">u</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">;</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="NAME">a</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">ActiveXObject</span><span class="PUNC">(</span><span class="STRN">"htmlfile"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.open</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3083</span> </span><span class="NAME">a.write</span><span class="PUNC">(</span><span class="STRN">"&lt;"</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">+</span><span class="STRN">">document.w=window&lt;/"</span><span class="PUNC">+</span><span class="NAME">i</span><span class="PUNC">+</span><span class="STRN">'>&lt;iframe src="/favicon.ico">&lt;/iframe>'</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">a.close</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">a.w.frames</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">document</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">u.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3084</span> </span><span class="PUNC">{</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">n.createElement</span><span class="PUNC">(</span><span class="STRN">"div"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">u</span><span class="PUNC">=</span><span class="NAME">n.body</span><span class="PUNC">}</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">l</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">n.unshift</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">u.appendChild</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3085</span> </span><span class="NAME">s.addBehavior</span><span class="PUNC">(</span><span class="STRN">"#default#userData"</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">s.load</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">e.apply</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">u.removeChild</span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">}</span><span class="PUNC">}</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">=</span><span class="KEYW">new</span><span class="WHIT"> </span><span class="NAME">RegExp</span><span class="PUNC">(</span><span class="STRN">"[!\"#$%&'()*+,/\\\\:;&lt;=>?@[\\]^`{|}~]"</span><span class="PUNC">,</span><span class="STRN">"g"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3086</span> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">e.replace</span><span class="PUNC">(</span><span class="REGX">/^d/</span><span class="PUNC">,</span><span class="STRN">"___$&"</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">replace</span><span class="PUNC">(</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"___"</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="NAME">t.set</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">===</span><span class="NAME">undefined</span><span class="PUNC">?</span><span class="NAME">t.remove</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="PUNC">(</span><span class="NAME">e.setAttribute</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">,</span><span class="NAME">t.serialize</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3087</span> </span><span class="NAME">e.save</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t.get</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t.deserialize</span><span class="PUNC">(</span><span class="NAME">e.getAttribute</span><span class="PUNC">(</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t.remove</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">h</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.removeAttribute</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">e.save</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3088</span> </span><span class="NAME">t.clear</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">=</span><span class="NAME">e.XMLDocument.documentElement.attributes</span><span class="PUNC">;</span><span class="NAME">e.load</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">i</span><span class="PUNC">;</span><span class="NAME">i</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">[</span><span class="NAME">n</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="NAME">n</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="NAME">e.removeAttribute</span><span class="PUNC">(</span><span class="NAME">i.name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="NAME">e.save</span><span class="PUNC">(</span><span class="NAME">r</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3089</span> </span><span class="NAME">t.getAll</span><span class="PUNC">=</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">n</span><span class="PUNC">=</span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t.forEach</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">n</span><span class="PUNC">[</span><span class="NAME">e</span><span class="PUNC">]</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="NAME">t.forEach</span><span class="PUNC">=</span><span class="NAME">l</span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">,</span><span class="NAME">n</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">r</span><span class="PUNC">=</span><span class="NAME">e.XMLDocument.documentElement.attributes</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3090</span> </span><span class="KEYW">for</span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">;</span><span class="NAME">s</span><span class="PUNC">=</span><span class="NAME">r</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="PUNC">++</span><span class="NAME">i</span><span class="PUNC">)</span><span class="NAME">n</span><span class="PUNC">(</span><span class="NAME">s.name</span><span class="PUNC">,</span><span class="NAME">t.deserialize</span><span class="PUNC">(</span><span class="NAME">e.getAttribute</span><span class="PUNC">(</span><span class="NAME">s.name</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">try</span><span class="PUNC">{</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">=</span><span class="STRN">"__storejs__"</span><span class="PUNC">;</span><span class="NAME">t.set</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">t.get</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">!=</span><span class="NAME">p</span><span class="PUNC">&&</span><span class="PUNC">(</span><span class="NAME">t.disabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>3091</span> </span><span class="NAME">t.remove</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="KEYW">catch</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="NAME">t.disabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NUMB">0</span><span class="PUNC">}</span><span class="NAME">t.enabled</span><span class="PUNC">=</span><span class="PUNC">!</span><span class="NAME">t.disabled</span><span class="PUNC">,</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">module</span><span class="PUNC">!=</span><span class="STRN">"undefined"</span><span class="PUNC">&&</span><span class="NAME">module.exports</span><span class="PUNC">&&</span><span class="WHIT">
<span class='line'>3092</span> </span><span class="NAME">this.module</span><span class="PUNC">!==</span><span class="NAME">module</span><span class="PUNC">?</span><span class="NAME">module.exports</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">:</span><span class="KEYW">typeof</span><span class="WHIT"> </span><span class="NAME">define</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">&&</span><span class="NAME">define.amd</span><span class="PUNC">?</span><span class="NAME">define</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">:</span><span class="NAME">e.store</span><span class="PUNC">=</span><span class="NAME">t</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="NAME">Function</span><span class="PUNC">(</span><span class="STRN">"return this"</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3093</span> 
<span class='line'>3094</span> </span><span class="COMM">/**
<span class='line'>3095</span>  * Reads the data of what is stored in the given file.
<span class='line'>3096</span>  * @param  {string} name The name of the file you want to read.
<span class='line'>3097</span>  * @return {dynamic TODO: OR STRING!?}      The data of the file
<span class='line'>3098</span>  */</span><span class="WHIT">
<span class='line'>3099</span> </span><span class="NAME">baa.filesystem.read</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3100</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"file"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3101</span> </span><span class="WHIT">	</span><span class="NAME">this._check</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3102</span> 
<span class='line'>3103</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">store.get</span><span class="PUNC">(</span><span class="NAME">this.identity</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3104</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3105</span> 
<span class='line'>3106</span> </span><span class="COMM">/**
<span class='line'>3107</span>  * Writes data to the given file.
<span class='line'>3108</span>  * @param  {string} name   	The name of the file you want to write to.
<span class='line'>3109</span>  * @param  {dynamic TODO: OR STRING?!} content The data you want to write to the file.
<span class='line'>3110</span>  */</span><span class="WHIT">
<span class='line'>3111</span> </span><span class="NAME">baa.filesystem.write</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">content</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3112</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"file"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3113</span> </span><span class="WHIT">	</span><span class="NAME">this._check</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3114</span> 
<span class='line'>3115</span> </span><span class="WHIT">	</span><span class="NAME">store.set</span><span class="PUNC">(</span><span class="NAME">this.identity</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">content</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3116</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3117</span> 
<span class='line'>3118</span> </span><span class="COMM">/**
<span class='line'>3119</span>  * Removes the given file of the local storage.
<span class='line'>3120</span>  * @param  {string} name The name of the file you want to remove
<span class='line'>3121</span>  */</span><span class="WHIT">
<span class='line'>3122</span> </span><span class="NAME">baa.filesystem.remove</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3123</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"file"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3124</span> </span><span class="WHIT">	</span><span class="NAME">this._check</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3125</span> 
<span class='line'>3126</span> </span><span class="WHIT">	</span><span class="NAME">store.remove</span><span class="PUNC">(</span><span class="NAME">this.identity</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3127</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3128</span> 
<span class='line'>3129</span> </span><span class="COMM">/**
<span class='line'>3130</span>  * Returns if given file exists.
<span class='line'>3131</span>  * @param  {string} name The name of the file you want to check.
<span class='line'>3132</span>  * @return {boolean}      If the file exists.
<span class='line'>3133</span>  */</span><span class="WHIT">
<span class='line'>3134</span> </span><span class="NAME">baa.filesystem.exists</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3135</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"file"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3136</span> </span><span class="WHIT">	</span><span class="NAME">this._check</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3137</span> 
<span class='line'>3138</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">store.get</span><span class="PUNC">(</span><span class="NAME">this.identity</span><span class="PUNC">+</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3139</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3140</span> 
<span class='line'>3141</span> </span><span class="COMM">/**
<span class='line'>3142</span>  * Sets an identity to the filesystem. This is required before using any of the filesystem features. The identity can also be set with t.identity = "" in baa.config.
<span class='line'>3143</span>  * @param {string} name The name of what the identity to set to
<span class='line'>3144</span>  */</span><span class="WHIT">
<span class='line'>3145</span> </span><span class="NAME">baa.filesystem.setIdentity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3146</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"file"</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3147</span> 
<span class='line'>3148</span> </span><span class="WHIT">	</span><span class="NAME">this.identity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">+</span><span class="STRN">"/"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3149</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3150</span> 
<span class='line'>3151</span> </span><span class="COMM">/**
<span class='line'>3152</span>  * Checks if local storage is enabled, and if an identity is set.
<span class='line'>3153</span>  * @throws {Error} If no enditity is set.
<span class='line'>3154</span>  */</span><span class="WHIT">
<span class='line'>3155</span> </span><span class="NAME">baa.filesystem._check</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3156</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">store.enabled</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">alert</span><span class="PUNC">(</span><span class="STRN">'Local storage is not supported by your browser. Please disable "Private Mode", or upgrade to a modern browser.'</span><span class="PUNC">)</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3157</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.identity</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"Please set an identity before using filesystem!"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3158</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3159</span> 
<span class='line'>3160</span> 
<span class='line'>3161</span> </span><span class="COMM">//Run</span><span class="WHIT">
<span class='line'>3162</span> 
<span class='line'>3163</span> </span><span class="COMM">/**
<span class='line'>3164</span>  * Call this to start baa. This should be called as last.
<span class='line'>3165</span>  */</span><span class="WHIT">
<span class='line'>3166</span> </span><span class="NAME">baa.run</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3167</span> </span><span class="WHIT">		</span><span class="NAME">window.requestAnimFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3168</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT">  </span><span class="NAME">window.requestAnimationFrame</span><span class="WHIT">   </span><span class="PUNC">||</span><span class="WHIT">  </span><span class="COMM">//Chromium </span><span class="WHIT">
<span class='line'>3169</span> </span><span class="WHIT">			</span><span class="NAME">window.webkitRequestAnimationFrame</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT">  </span><span class="COMM">//Webkit</span><span class="WHIT">
<span class='line'>3170</span> </span><span class="WHIT">			</span><span class="NAME">window.mozRequestAnimationFrame</span><span class="WHIT">    </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="COMM">//Mozilla Geko</span><span class="WHIT">
<span class='line'>3171</span> </span><span class="WHIT">			</span><span class="NAME">window.oRequestAnimationFrame</span><span class="WHIT">      </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="COMM">//Opera Presto</span><span class="WHIT">
<span class='line'>3172</span> </span><span class="WHIT">			</span><span class="NAME">window.msRequestAnimationFrame</span><span class="WHIT">     </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="COMM">//IE Trident?</span><span class="WHIT">
<span class='line'>3173</span> </span><span class="WHIT">			</span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">element</span><span class="PUNC">)</span><span class="PUNC">{</span><span class="WHIT"> </span><span class="COMM">//Fallback function</span><span class="WHIT">
<span class='line'>3174</span> </span><span class="WHIT">				</span><span class="NAME">window.setTimeout</span><span class="PUNC">(</span><span class="NAME">callback</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">                
<span class='line'>3175</span> 			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3176</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">)</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3177</span> </span><span class="WHIT">		
<span class='line'>3178</span> 		</span><span class="NAME">window.cancelAnimFrame</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">window.cancelAnimationFrame</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">window.mozCancelAnimationFrame</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3179</span> </span><span class="WHIT">	
<span class='line'>3180</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa._assetsLoaded</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">baa._assetsToBeLoaded</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3181</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.graphics.ctx</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3182</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.config</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3183</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">conf</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3184</span> </span><span class="WHIT">				</span><span class="COMM">/*
<span class='line'>3185</span> 				t.width = The width of the canvas
<span class='line'>3186</span> 				t.height = The height of the canvas
<span class='line'>3187</span> 				t.identity = The identity of the filesystem
<span class='line'>3188</span> 				t.scale = The global scale
<span class='line'>3189</span> 				 */</span><span class="WHIT">
<span class='line'>3190</span> </span><span class="WHIT">				</span><span class="NAME">baa.config</span><span class="PUNC">(</span><span class="NAME">conf</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3191</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics._globalScale</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">conf.scale</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">conf.scale</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3192</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics.canvas.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">conf.width</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">conf.width</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">800</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">baa.graphics._globalScale</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3193</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics.canvas.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">conf.height</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">conf.height</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">600</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">baa.graphics._globalScale</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3194</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.canvas.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3195</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.canvas.height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3196</span> </span><span class="WHIT">				</span><span class="NAME">Camera.setWindow</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">baa.graphics.width</span><span class="PUNC">,</span><span class="NAME">baa.graphics.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3197</span> </span><span class="WHIT">				</span><span class="NAME">baa.filesystem.identity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">conf.identity</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">conf.identity</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"/"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3198</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">conf.release</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3199</span> </span><span class="WHIT">					</span><span class="NAME">baa.debug</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3200</span> </span><span class="WHIT">					</span><span class="NAME">baa.typesafe</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3201</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3202</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3203</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.imageSmoothingEnabled</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3204</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.ctx.strokeStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics._rgb</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3205</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.setFont</span><span class="PUNC">(</span><span class="NAME">baa.graphics.newFont</span><span class="PUNC">(</span><span class="STRN">"arial"</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3206</span> </span><span class="WHIT">			</span><span class="NAME">baa.load</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3207</span> </span><span class="WHIT">			</span><span class="NAME">baa.loop</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3208</span> </span><span class="WHIT">			</span><span class="NAME">window.cancelAnimFrame</span><span class="PUNC">(</span><span class="NAME">baa.run</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3209</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3210</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3211</span> </span><span class="WHIT">			</span><span class="NAME">window.requestAnimFrame</span><span class="PUNC">(</span><span class="NAME">baa.run</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3212</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3213</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3214</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3215</span> </span><span class="WHIT">		</span><span class="NAME">window.requestAnimFrame</span><span class="PUNC">(</span><span class="NAME">baa.run</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3216</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3217</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3218</span> 
<span class='line'>3219</span> </span><span class="COMM">/**
<span class='line'>3220</span>  * The main loop. Calls baa.update, and baa.graphics.drawLoop. It also calls baa.debug.update if baa.debug is activated.
<span class='line'>3221</span>  */</span><span class="WHIT">
<span class='line'>3222</span> </span><span class="NAME">baa.loop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">time</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3223</span> </span><span class="WHIT">	</span><span class="NAME">baa._time.dt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa._time.stamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">baa._time.last</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3224</span> </span><span class="WHIT">	</span><span class="NAME">ot</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa._time.dt</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NAME">baa._time.dt</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3225</span> </span><span class="WHIT">	</span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">ot</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NUMB">60</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3226</span> 
<span class='line'>3227</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3228</span> </span><span class="WHIT">		</span><span class="NAME">baa.debug.fps</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1000</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa._time.stamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">baa._time.last</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3229</span> </span><span class="WHIT">		</span><span class="NAME">baa.debug.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3230</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3231</span> 
<span class='line'>3232</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.ox</span><span class="PUNC">/</span><span class="NAME">baa.graphics._globalScale</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3233</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.oy</span><span class="PUNC">/</span><span class="NAME">baa.graphics._globalScale</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3234</span> 
<span class='line'>3235</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.update</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3236</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse.setCursor</span><span class="PUNC">(</span><span class="STRN">"default"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3237</span> </span><span class="WHIT">		</span><span class="NAME">baa.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3238</span> </span><span class="WHIT">		</span><span class="NAME">Timer.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3239</span> </span><span class="WHIT">		</span><span class="NAME">Tween.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3240</span> </span><span class="WHIT">		</span><span class="NAME">Camera.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>3241</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3242</span> 
<span class='line'>3243</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3244</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.ox</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3245</span> </span><span class="WHIT">		</span><span class="NAME">baa.mouse.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.oy</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3246</span> </span><span class="WHIT">		</span><span class="NAME">baa.debug.updateWindows</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3247</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3248</span> 
<span class='line'>3249</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics._drawloop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3250</span> 
<span class='line'>3251</span> </span><span class="WHIT">	</span><span class="NAME">baa.keyboard._pressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3252</span> </span><span class="WHIT">	</span><span class="NAME">baa.keyboard._released</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3253</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse._pressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3254</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse._released</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3255</span> 
<span class='line'>3256</span> </span><span class="WHIT">	</span><span class="NAME">baa._time.last</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa._time.stamp</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3257</span> </span><span class="WHIT">	</span><span class="NAME">window.requestAnimFrame</span><span class="PUNC">(</span><span class="NAME">baa.loop</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3258</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3259</span> 
<span class='line'>3260</span> </span><span class="COMM">/**
<span class='line'>3261</span>  * The draw loop. Calls baa.draw, and baa.debug.draw if baa.debug is activated.
<span class='line'>3262</span>  */</span><span class="WHIT">
<span class='line'>3263</span> </span><span class="NAME">baa.graphics._drawloop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3264</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.draw</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3265</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._backgroundColor.r</span><span class="PUNC">,</span><span class="NAME">this._backgroundColor.g</span><span class="PUNC">,</span><span class="NAME">this._backgroundColor.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3266</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.globalAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3267</span> </span><span class="WHIT">		</span><span class="NAME">this.clear</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3268</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.globalAlpha</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._color.a</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3269</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.fillStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._color.r</span><span class="PUNC">,</span><span class="NAME">this._color.g</span><span class="PUNC">,</span><span class="NAME">this._color.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3270</span> </span><span class="WHIT">		</span><span class="NAME">this.ctx.strokeStyle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rgb</span><span class="PUNC">(</span><span class="NAME">this._color.r</span><span class="PUNC">,</span><span class="NAME">this._color.g</span><span class="PUNC">,</span><span class="NAME">this._color.b</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3271</span> </span><span class="WHIT">		</span><span class="NAME">this.setFont</span><span class="PUNC">(</span><span class="NAME">this._defaultFont</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3272</span> </span><span class="WHIT">		
<span class='line'>3273</span> 		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._stacks</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3274</span> </span><span class="WHIT">			</span><span class="NAME">this.ctx.restore</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3275</span> </span><span class="WHIT">			</span><span class="NAME">this._stacks</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3276</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3277</span> 
<span class='line'>3278</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.origin</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3279</span> 
<span class='line'>3280</span> </span><span class="WHIT">		</span><span class="NAME">Camera.start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3281</span> </span><span class="WHIT">		</span><span class="NAME">baa.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3282</span> </span><span class="WHIT">		</span><span class="NAME">Camera.stop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3283</span> 
<span class='line'>3284</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.debug</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3285</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.origin</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3286</span> </span><span class="WHIT">			</span><span class="NAME">baa.graphics.scale</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">this._globalScale</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3287</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3288</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3289</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3290</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3291</span> 
<span class='line'>3292</span> </span><span class="NAME">window.addEventListener</span><span class="PUNC">(</span><span class="STRN">'load'</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">_baa_init</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3293</span> 
<span class='line'>3294</span> </span><span class="COMM">//////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3295</span> </span><span class="COMM">//////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3296</span> </span><span class="COMM">//////////////////////////////////////////////////</span><span class="WHIT">
<span class='line'>3297</span> 
<span class='line'>3298</span> </span><span class="COMM">//////////</span><span class="WHIT">
<span class='line'>3299</span> </span><span class="COMM">///ONCE///</span><span class="WHIT">
<span class='line'>3300</span> </span><span class="COMM">//////////</span><span class="WHIT">
<span class='line'>3301</span> 
<span class='line'>3302</span> </span><span class="COMM">/**
<span class='line'>3303</span>  * A small tool to lock functions to 1 call. They won't be called again until they are unlocked.
<span class='line'>3304</span>  * @constructor
<span class='line'>3305</span>  * @property {object} object The object of this instance.
<span class='line'>3306</span>  * @property {object} list A list of all the functions, and their current state.
<span class='line'>3307</span>  * @param {object} obj The object of this instance.
<span class='line'>3308</span>  * @example
<span class='line'>3309</span>  * this.once = baa.once.new(this);
<span class='line'>3310</span>  *
<span class='line'>3311</span>  * Foo.update = function () {
<span class='line'>3312</span>  * 		//This is only called once
<span class='line'>3313</span>  * 		this.once.do("foo");
<span class='line'>3314</span>  *
<span class='line'>3315</span>  * 		//If a is pressed
<span class='line'>3316</span>  * 		if (baa.keyboard.isPressed("a")) {
<span class='line'>3317</span>  *
<span class='line'>3318</span>  * 			//this.foo can be called again, this.bar is called.
<span class='line'>3319</span>  * 			this.once.back("foo","bar");
<span class='line'>3320</span>  * 		}
<span class='line'>3321</span>  * }
<span class='line'>3322</span>  */</span><span class="WHIT">
<span class='line'>3323</span> </span><span class="NAME">baa.once</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.once"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3324</span> 
<span class='line'>3325</span> </span><span class="NAME">baa.once.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3326</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3327</span> 
<span class='line'>3328</span> </span><span class="WHIT">	</span><span class="NAME">this.object</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3329</span> </span><span class="WHIT">	</span><span class="NAME">this.list</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3330</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3331</span> 
<span class='line'>3332</span> </span><span class="COMM">/**
<span class='line'>3333</span>  * Call a function. If it has already been called with this function, it won't be called again.
<span class='line'>3334</span>  * @param  {string} f    The function to call.
<span class='line'>3335</span>  * @param  {array} args An array of arguments to use with the function.
<span class='line'>3336</span>  * @return {dynamic} If the function is called, returns whatever the given function returns. Else, returns null.
<span class='line'>3337</span>  */</span><span class="WHIT">
<span class='line'>3338</span> </span><span class="NAME">baa.once.do</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3339</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3340</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"arguments"</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3341</span> 
<span class='line'>3342</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3343</span> </span><span class="WHIT">		</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3344</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.object</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">this.object</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3345</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3346</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3347</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3348</span> 
<span class='line'>3349</span> </span><span class="COMM">/**
<span class='line'>3350</span>  * Allow a function to be called again. You can give a new function that will be called.
<span class='line'>3351</span>  *  The new function will not be locked, but won't be called by this function if f is already reverted.
<span class='line'>3352</span>  * @param  {string} f    The function you want to unlock.
<span class='line'>3353</span>  * @param  {string} [nf]   The function you want call when f is unlocked.
<span class='line'>3354</span>  * @param  {array} [args] An array of arguments to use with the function.
<span class='line'>3355</span>  * @return {dynamic} If nf is called, returns whatever nf returns. Else, returns null.
<span class='line'>3356</span>  */</span><span class="WHIT">
<span class='line'>3357</span> </span><span class="NAME">baa.once.back</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="NAME">nf</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3358</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3359</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"newFunction"</span><span class="PUNC">,</span><span class="NAME">nf</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3360</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"arguments"</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3361</span> 
<span class='line'>3362</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.list</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3363</span> </span><span class="WHIT">		</span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">list</span><span class="PUNC">[</span><span class="NAME">f</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3364</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">nf</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3365</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.object</span><span class="PUNC">[</span><span class="NAME">nf</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="NAME">this.object</span><span class="PUNC">,</span><span class="NAME">args</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3366</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3367</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3368</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3369</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3370</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3371</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3372</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3373</span> 
<span class='line'>3374</span> </span><span class="COMM">///////////</span><span class="WHIT">
<span class='line'>3375</span> </span><span class="COMM">// Utils //</span><span class="WHIT">
<span class='line'>3376</span> </span><span class="COMM">///////////</span><span class="WHIT">
<span class='line'>3377</span> 
<span class='line'>3378</span> </span><span class="COMM">/**
<span class='line'>3379</span>  * Useful small functions.
<span class='line'>3380</span>  * @constructor
<span class='line'>3381</span>  */</span><span class="WHIT">
<span class='line'>3382</span> </span><span class="NAME">baa.util</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3383</span> 
<span class='line'>3384</span> </span><span class="COMM">/**
<span class='line'>3385</span>  * Math.PI multiplied.
<span class='line'>3386</span>  */</span><span class="WHIT">
<span class='line'>3387</span> </span><span class="NAME">baa.util.TAU</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3388</span> 
<span class='line'>3389</span> </span><span class="COMM">/**
<span class='line'>3390</span>  * Returns 1 if a is higher or equal to 0, else it returns -1.
<span class='line'>3391</span>  * @param  {number} a The value you want to sign.
<span class='line'>3392</span>  * @return {number}   1 if a is higher or equal to 0, else it returns -1.
<span class='line'>3393</span>  */</span><span class="WHIT">
<span class='line'>3394</span> </span><span class="NAME">baa.util.sign</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3395</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3396</span> 
<span class='line'>3397</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3398</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3399</span> 
<span class='line'>3400</span> </span><span class="NAME">baa.util.any</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3401</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3402</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3403</span> 
<span class='line'>3404</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3405</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3406</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3407</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3408</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3409</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3410</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3411</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3412</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3413</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3414</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3415</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3416</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3417</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3418</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3419</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3420</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3421</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3422</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3423</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3424</span> 
<span class='line'>3425</span> </span><span class="NAME">baa.util.all</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3426</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3427</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3428</span> 
<span class='line'>3429</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3430</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3431</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3432</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3433</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3434</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3435</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3436</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3437</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3438</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3439</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3440</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3441</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3442</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3443</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3444</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3445</span> </span><span class="WHIT">					</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3446</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3447</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3448</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3449</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3450</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3451</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3452</span> 
<span class='line'>3453</span> </span><span class="NAME">baa.util.find</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3454</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3455</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3456</span> </span><span class="WHIT">	
<span class='line'>3457</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3458</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3459</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3460</span> </span><span class="WHIT">				</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3461</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3462</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3463</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3464</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3465</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3466</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3467</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3468</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3469</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3470</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3471</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3472</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3473</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3474</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3475</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3476</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3477</span> 
<span class='line'>3478</span> </span><span class="NAME">baa.util.findAll</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3479</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3480</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3481</span> </span><span class="WHIT">	
<span class='line'>3482</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">newarr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3483</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3484</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3485</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3486</span> </span><span class="WHIT">				</span><span class="NAME">newarr.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3487</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3488</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3489</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3490</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3491</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3492</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3493</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3494</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3495</span> </span><span class="WHIT">						</span><span class="NAME">newarr.push</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3496</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3497</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3498</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3499</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3500</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3501</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">newarr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3502</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3503</span> 
<span class='line'>3504</span> </span><span class="NAME">baa.util.has</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3505</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"array"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3506</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3507</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3508</span> </span><span class="WHIT">		</span><span class="NAME">succes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3509</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3510</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3511</span> </span><span class="WHIT">				</span><span class="NAME">succes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3512</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3513</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3514</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">succes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3515</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3516</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3517</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3518</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT">
<span class='line'>3519</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3520</span> 
<span class='line'>3521</span> </span><span class="NAME">baa.util.count</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3522</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"array"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3523</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3524</span> </span><span class="WHIT">	
<span class='line'>3525</span> 	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3526</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">==</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3527</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3528</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3529</span> </span><span class="WHIT">				</span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3530</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3531</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3532</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3533</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3534</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3535</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3536</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">!=</span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3537</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3538</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3539</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3540</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3541</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3542</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3543</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3544</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">c</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3545</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3546</span> 
<span class='line'>3547</span> </span><span class="NAME">baa.util.clamp</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">min</span><span class="PUNC">,</span><span class="NAME">max</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3548</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"a"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3549</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"min"</span><span class="PUNC">,</span><span class="NAME">min</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3550</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"max"</span><span class="PUNC">,</span><span class="NAME">max</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3551</span> </span><span class="WHIT">	
<span class='line'>3552</span> 	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">max</span><span class="PUNC">,</span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">min</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3553</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3554</span> 
<span class='line'>3555</span> </span><span class="NAME">baa.util.angle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3556</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x1"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3557</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y1"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3558</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x2"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3559</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y2"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3560</span> 
<span class='line'>3561</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">c</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3562</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">b.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">a.y</span><span class="PUNC">,</span><span class="NAME">b.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3563</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3564</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3565</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.atan2</span><span class="PUNC">(</span><span class="NAME">d</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">b</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">a</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3566</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3567</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3568</span> 
<span class='line'>3569</span> </span><span class="NAME">baa.util.distance</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3570</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">===</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3571</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x1"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3572</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y1"</span><span class="PUNC">,</span><span class="NAME">b</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3573</span> </span><span class="WHIT">		</span><span class="NAME">c</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">b.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3574</span> </span><span class="WHIT">		</span><span class="NAME">d</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">b.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3575</span> </span><span class="WHIT">		</span><span class="NAME">b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">a.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3576</span> </span><span class="WHIT">		</span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">a.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3577</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3578</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3579</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"x2"</span><span class="PUNC">,</span><span class="NAME">c</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3580</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"y2"</span><span class="PUNC">,</span><span class="NAME">d</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3581</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3582</span> 
<span class='line'>3583</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">-</span><span class="NAME">c</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NAME">b</span><span class="PUNC">-</span><span class="NAME">d</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3584</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3585</span> 
<span class='line'>3586</span> </span><span class="NAME">baa.util.random</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">s</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3587</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">==</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3588</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"value"</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3589</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">s</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3590</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3591</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3592</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"min"</span><span class="PUNC">,</span><span class="NAME">s</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3593</span> </span><span class="WHIT">		</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"max"</span><span class="PUNC">,</span><span class="NAME">e</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3594</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">s</span><span class="PUNC">+</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">e</span><span class="PUNC">-</span><span class="NAME">s</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3595</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3596</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3597</span> 
<span class='line'>3598</span> </span><span class="NAME">baa.util.choose</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3599</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array"</span><span class="PUNC">,</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3600</span> 
<span class='line'>3601</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="PUNC">[</span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">arr.length</span><span class="PUNC">)</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3602</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3603</span> 
<span class='line'>3604</span> </span><span class="NAME">baa.util.same</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr1</span><span class="PUNC">,</span><span class="NAME">arr2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3605</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array1"</span><span class="PUNC">,</span><span class="NAME">arr2</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3606</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"array2"</span><span class="PUNC">,</span><span class="NAME">arr1</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3607</span> 
<span class='line'>3608</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3609</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr1.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3610</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arr2.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3611</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr1</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">arr2</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3612</span> </span><span class="WHIT">				</span><span class="NAME">arr.push</span><span class="PUNC">(</span><span class="NAME">arr1</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3613</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3614</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3615</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3616</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3617</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3618</span> 
<span class='line'>3619</span> </span><span class="NAME">baa.util.remove</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3620</span> </span><span class="WHIT">	</span><span class="COMM">//find does the checktypes</span><span class="WHIT">
<span class='line'>3621</span> </span><span class="WHIT">	</span><span class="NAME">arr.splice</span><span class="PUNC">(</span><span class="NAME">this.find</span><span class="PUNC">(</span><span class="NAME">arr</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3622</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">arr</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3623</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3624</span> 
<span class='line'>3625</span> </span><span class="NAME">baa.util.call</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">func</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3626</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3627</span> </span><span class="WHIT">		</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">func</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">call</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3628</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3629</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3630</span> </span><span class="WHIT">		</span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3631</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3632</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3633</span> 
<span class='line'>3634</span> 
<span class='line'>3635</span> 
<span class='line'>3636</span> </span><span class="COMM">///////////</span><span class="WHIT">
<span class='line'>3637</span> </span><span class="COMM">// Group //</span><span class="WHIT">
<span class='line'>3638</span> </span><span class="COMM">///////////</span><span class="WHIT">
<span class='line'>3639</span> 
<span class='line'>3640</span> </span><span class="COMM">/**
<span class='line'>3641</span>  * A tool to make groups, saves you from writing arrays.
<span class='line'>3642</span>  * @constructor
<span class='line'>3643</span>  * @example
<span class='line'>3644</span>  * this.enemies = baa.group.new();
<span class='line'>3645</span>  * this.enemies.add( Enemy.new(), Enemy.new(), Enemy.new() );
<span class='line'>3646</span>  *
<span class='line'>3647</span>  * this.enemies.update();
<span class='line'>3648</span>  *
<span class='line'>3649</span>  * this.enemies.draw();
<span class='line'>3650</span>  * @property {number} length How many members are in the group.
<span class='line'>3651</span>  * @param {object|array} [...] The objects you want to add to the group. Can also be added with baa.group.add(). 
<span class='line'>3652</span>  * If the first argument is an array, it will use the objects in the array, and disregard all other arguments.
<span class='line'>3653</span>  */</span><span class="WHIT">
<span class='line'>3654</span> </span><span class="NAME">baa.group</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.group"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3655</span> 
<span class='line'>3656</span> </span><span class="COMM">//Use .other if you want obj A to apply to obj B and vise versa</span><span class="WHIT">
<span class='line'>3657</span> </span><span class="COMM">//Use .one if you want obj B to apply to obj A only if obj A applied to obj B returns false</span><span class="WHIT">
<span class='line'>3658</span> 
<span class='line'>3659</span> </span><span class="COMM">/**
<span class='line'>3660</span>  * Using this as first argument when calling a function, will loop through all objects, and gives every other object as argument.
<span class='line'>3661</span>  * @example
<span class='line'>3662</span>  * this.rects = baa.group.new(baa.entity.new(100,100,200,200),baa.entity.new(50,50,100,100),baa.entity.new(300,200,10,40));
<span class='line'>3663</span>  * this.rects.resolveCollision(baa.group.others);
<span class='line'>3664</span>  */</span><span class="WHIT">
<span class='line'>3665</span> </span><span class="NAME">baa.group.others</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"__GroupOthers"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3666</span> 
<span class='line'>3667</span> </span><span class="COMM">/**
<span class='line'>3668</span>  * Same as baa.group.others, except this will first call A with B as argument, and if A returns true, it will not call B with A as argument.
<span class='line'>3669</span>  */</span><span class="WHIT">
<span class='line'>3670</span> </span><span class="NAME">baa.group.one</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"__GroupOne"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3671</span> 
<span class='line'>3672</span> </span><span class="COMM">/**
<span class='line'>3673</span>  * Make baa.group loop forwards through the objects. Normally the objects loop backwards, but you can revert that with this argument. 
<span class='line'>3674</span>  * Useful for when you want to update something you want to draw as last, so that it's on top.
<span class='line'>3675</span>  */</span><span class="WHIT">
<span class='line'>3676</span> </span><span class="NAME">baa.group.forward</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"_GroupForward"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3677</span> 
<span class='line'>3678</span> </span><span class="NAME">baa.group.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3679</span> </span><span class="WHIT">	</span><span class="NAME">this.length</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3680</span> </span><span class="WHIT">	</span><span class="NAME">baa.group.add.apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3681</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3682</span> 
<span class='line'>3683</span> </span><span class="COMM">/**
<span class='line'>3684</span>  * Add objects to the group. It will copy and modify it's functions so that it can be called by this. 
<span class='line'>3685</span>  *	@param {object|array} ... The objects you want to add to the group. If the first argument is an array, it will use the objects in the array, 
<span class='line'>3686</span>  *	and disregard all other arguments.
<span class='line'>3687</span>  */</span><span class="WHIT">
<span class='line'>3688</span> </span><span class="NAME">baa.group.add</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3689</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3690</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3691</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">arguments.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3692</span> </span><span class="WHIT">				</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">this.length</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3693</span> </span><span class="WHIT">				</span><span class="NAME">this.length</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3694</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3695</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3696</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3697</span> </span><span class="WHIT">							</span><span class="NAME">this._makeFunc</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3698</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3699</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3700</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3701</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3702</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3703</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Class.isClass</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">obj.is</span><span class="PUNC">(</span><span class="NAME">baa.group</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3704</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">obj.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3705</span> </span><span class="WHIT">				</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">this.length</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3706</span> </span><span class="WHIT">				</span><span class="NAME">this.length</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3707</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3708</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3709</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3710</span> </span><span class="WHIT">							</span><span class="NAME">this._makeFunc</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3711</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3712</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3713</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3714</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3715</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3716</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3717</span> </span><span class="WHIT">			</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">this.length</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3718</span> </span><span class="WHIT">			</span><span class="NAME">this.length</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3719</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3720</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3721</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3722</span> </span><span class="WHIT">						</span><span class="NAME">this._makeFunc</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3723</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3724</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3725</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3726</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3727</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3728</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3729</span> 
<span class='line'>3730</span> </span><span class="COMM">/**
<span class='line'>3731</span>  * Removes an object from the group.
<span class='line'>3732</span>  * @param  {obj|number} obj Can be the object itself, or its current position in the group.
<span class='line'>3733</span>  */</span><span class="WHIT">
<span class='line'>3734</span> </span><span class="NAME">baa.group.remove</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3735</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3736</span> 
<span class='line'>3737</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3738</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">dead</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3739</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3740</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3741</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3742</span> </span><span class="WHIT">				</span><span class="NAME">dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3743</span> </span><span class="WHIT">				</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3744</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3745</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3746</span> </span><span class="WHIT">		</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">dead</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3747</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3748</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3749</span> </span><span class="WHIT">		</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">obj</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3750</span> </span><span class="WHIT">		</span><span class="NAME">dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3751</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3752</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dead</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3753</span> </span><span class="WHIT">		</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3754</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3755</span> </span><span class="WHIT">	</span><span class="NAME">this.length</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3756</span> </span><span class="WHIT">	</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">this.length</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3757</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3758</span> 
<span class='line'>3759</span> </span><span class="COMM">/**
<span class='line'>3760</span>  * Modifies the function so that it calls the function for all the members.
<span class='line'>3761</span>  * @param  {string} k The function name
<span class='line'>3762</span>  */</span><span class="WHIT">
<span class='line'>3763</span> </span><span class="NAME">baa.group._makeFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3764</span> </span><span class="WHIT">	</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3765</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">other</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>3766</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">other</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">baa.group.others</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">other</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">baa.group.one</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3767</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3768</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">=</span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3769</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">!=</span><span class="NAME">j</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3770</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3771</span> </span><span class="WHIT">							</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3772</span> </span><span class="WHIT">							</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">a</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3773</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">other</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">baa.group.one</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3774</span> </span><span class="WHIT">								</span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3775</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3776</span> </span><span class="WHIT">							</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">b</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3777</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3778</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3779</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3780</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3781</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3782</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3783</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NUMB">0</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">baa.group.forward</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3784</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3785</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3786</span> </span><span class="WHIT">						</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3787</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3788</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3789</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3790</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3791</span> </span><span class="WHIT">				</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3792</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">k</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3793</span> </span><span class="WHIT">						</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">k</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">apply</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3794</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3795</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">	
<span class='line'>3796</span> 			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3797</span> </span><span class="WHIT">			
<span class='line'>3798</span> 			
<span class='line'>3799</span> 		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3800</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3801</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3802</span> 
<span class='line'>3803</span> </span><span class="COMM">/**
<span class='line'>3804</span>  * Make all the objects in the group call a function.
<span class='line'>3805</span>  * @param  {function} f The function you want to call.
<span class='line'>3806</span>  */</span><span class="WHIT">
<span class='line'>3807</span> </span><span class="NAME">baa.group.do</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3808</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3809</span> 
<span class='line'>3810</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3811</span> </span><span class="WHIT">		</span><span class="NAME">func.call</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3812</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3813</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3814</span> 
<span class='line'>3815</span> </span><span class="COMM">/**
<span class='line'>3816</span>  * Sets a value to the given variable for all members. The object is required to already have this property.
<span class='line'>3817</span>  * @param {string} key   The property you want to change.
<span class='line'>3818</span>  * @param {dynamic} value The value you want to give the property.
<span class='line'>3819</span>  */</span><span class="WHIT">
<span class='line'>3820</span> </span><span class="NAME">baa.group.set</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="NAME">value</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3821</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">key</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3822</span> 
<span class='line'>3823</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3824</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3825</span> </span><span class="WHIT">			</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3826</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3827</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3828</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3829</span> 
<span class='line'>3830</span> </span><span class="COMM">/**
<span class='line'>3831</span>  * Prepares the group for objects to come. Allowing you to already call its functions, without any members.
<span class='line'>3832</span>  * @example
<span class='line'>3833</span>  * this.group = baa.group.new();
<span class='line'>3834</span>  *
<span class='line'>3835</span>  * //This will give an error. this.group doesn't have .update().
<span class='line'>3836</span>  * this.group.update()
<span class='line'>3837</span>  *
<span class='line'>3838</span>  * this.group = baa.group.new();
<span class='line'>3839</span>  * this.group.prepare(baa.entity);
<span class='line'>3840</span>  *
<span class='line'>3841</span>  * //The group is prepared and can now already call functions without errors.
<span class='line'>3842</span>  * this.group.update();
<span class='line'>3843</span>  * @param  {object} obj An object with the functions the group is going to use.
<span class='line'>3844</span>  */</span><span class="WHIT">
<span class='line'>3845</span> </span><span class="NAME">baa.group.prepare</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3846</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3847</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3848</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3849</span> </span><span class="WHIT">				</span><span class="NAME">this._makeFunc</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3850</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3851</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3852</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3853</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3854</span> 
<span class='line'>3855</span> </span><span class="COMM">/**
<span class='line'>3856</span>  * Removes all the members of the group, but keeps the functions.
<span class='line'>3857</span>  */</span><span class="WHIT">
<span class='line'>3858</span> </span><span class="NAME">baa.group.flush</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3859</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">=</span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3860</span> </span><span class="WHIT">		</span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>3861</span> 	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3862</span> </span><span class="WHIT">	</span><span class="NAME">this.length</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3863</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3864</span> 
<span class='line'>3865</span> </span><span class="COMM">/**
<span class='line'>3866</span>  * Sorts all the members on the value of a property. If an object in the group does not own the property, it will be taken as 0.
<span class='line'>3867</span>  * @param  {string} key         The property you want to sort on.
<span class='line'>3868</span>  * @param  {boolean} [highToLow] Set to true if you want the object to sort from high to low, instead of low to high.
<span class='line'>3869</span>  */</span><span class="WHIT">
<span class='line'>3870</span> </span><span class="NAME">baa.group.sort</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">,</span><span class="NAME">highToLow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3871</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"key"</span><span class="PUNC">,</span><span class="NAME">a</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3872</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"highToLow"</span><span class="PUNC">,</span><span class="NAME">highToLow</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3873</span> 
<span class='line'>3874</span> </span><span class="WHIT">	</span><span class="NAME">sorted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3875</span> 
<span class='line'>3876</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">danger</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">10000</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3877</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">propA</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">propB</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3878</span> 
<span class='line'>3879</span> </span><span class="WHIT">	</span><span class="KEYW">while</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">sorted</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">danger</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3880</span> </span><span class="WHIT">		</span><span class="NAME">danger</span><span class="PUNC">--</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3881</span> </span><span class="WHIT">		</span><span class="NAME">sorted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3882</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3883</span> </span><span class="WHIT">			</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3884</span> </span><span class="WHIT">				</span><span class="NAME">propA</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3885</span> </span><span class="WHIT">				</span><span class="NAME">propB</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">hasOwnProperty</span><span class="PUNC">(</span><span class="NAME">a</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">[</span><span class="NAME">a</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3886</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">highToLow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3887</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">propA</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">propB</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3888</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3889</span> </span><span class="WHIT">						</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3890</span> </span><span class="WHIT">						</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">old</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3891</span> </span><span class="WHIT">						</span><span class="NAME">sorted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3892</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3893</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3894</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3895</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">propA</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">propB</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3896</span> </span><span class="WHIT">						</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">old</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3897</span> </span><span class="WHIT">						</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3898</span> </span><span class="WHIT">						</span><span class="KEYW">this</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">old</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3899</span> </span><span class="WHIT">						</span><span class="NAME">sorted</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3900</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3901</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3902</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3903</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3904</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3905</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3906</span> 
<span class='line'>3907</span> 
<span class='line'>3908</span> </span><span class="COMM">//Timer</span><span class="WHIT">
<span class='line'>3909</span> </span><span class="COMM">//////////////////////////////////</span><span class="WHIT">
<span class='line'>3910</span> 
<span class='line'>3911</span> </span><span class="COMM">/**
<span class='line'>3912</span>  * A manager for baa.timer objects. Automatically updates and removes timers made with it.
<span class='line'>3913</span>  * @constructor
<span class='line'>3914</span>  * @see  baa.timer
<span class='line'>3915</span>  * @property {object} obj The object that owns this timermanager. Functions will be called with the object as this. 
<span class='line'>3916</span>  * @property {array} timers A list of all the timers owned by this timermanager.
<span class='line'>3917</span>  * @property {boolean} playing All the timers will only update when this is true.
<span class='line'>3918</span>  * @param {object} [object] The owner of this timermanager.
<span class='line'>3919</span>  */</span><span class="WHIT">
<span class='line'>3920</span> </span><span class="NAME">baa.timerManager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.timerManager"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3921</span> 
<span class='line'>3922</span> </span><span class="NAME">baa.timerManager.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3923</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3924</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3925</span> </span><span class="WHIT">	</span><span class="NAME">this.timers</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3926</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3927</span> </span><span class="WHIT">	</span><span class="NAME">this.new</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.newTimer</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3928</span> </span><span class="WHIT">	</span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">this.newTimer</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3929</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3930</span> 
<span class='line'>3931</span> </span><span class="COMM">/**
<span class='line'>3932</span>  * Sets an object to this timermanager.
<span class='line'>3933</span>  * @param {object} object The object you want to set to this timermanager.
<span class='line'>3934</span>  */</span><span class="WHIT">
<span class='line'>3935</span> </span><span class="NAME">baa.timerManager.setObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">object</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3936</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">object</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3937</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">object</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3938</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3939</span> 
<span class='line'>3940</span> </span><span class="COMM">/**
<span class='line'>3941</span>  * Returns the object set to this timermanager.
<span class='line'>3942</span>  * @return {object} The object set to this timermanager.
<span class='line'>3943</span>  */</span><span class="WHIT">
<span class='line'>3944</span> </span><span class="NAME">baa.timerManager.getObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3945</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3946</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3947</span> 
<span class='line'>3948</span> </span><span class="COMM">/**
<span class='line'>3949</span>  * Create a new timer belonging to this timer manager.
<span class='line'>3950</span>  * @alias new
<span class='line'>3951</span>  * @param  {object} [obj] The object you want to connect to the condition and function of this timer.
<span class='line'>3952</span>  * If the first argument is a number, this will be taken as the argument time, and shift all other arguments, and the manager's object will be used instead.
<span class='line'>3953</span>  * @param  {number} time The length of the timer in seconds.
<span class='line'>3954</span>  * @param  {string} [mode="normal"] If the timer should loop, die after one loop, or neither. Options: "loop", "once", "normal".
<span class='line'>3955</span>  * @param  {function|string} [func] The function you want to call each time the timer is finished. 
<span class='line'>3956</span>  * This can either be the name of the function as a string, or a function on its own.
<span class='line'>3957</span>  * @param  {object|function} [cond] A condition that must be true for the timer to play. 
<span class='line'>3958</span>  * This can either be a function returning a boolean, or an object with properties that have to be a certain value.
<span class='line'>3959</span>  * @return {baa.timer} The new timer.
<span class='line'>3960</span>  */</span><span class="WHIT">
<span class='line'>3961</span> </span><span class="NAME">baa.timerManager.newTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3962</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3963</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3964</span> </span><span class="WHIT">		</span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.timer.new</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3965</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3966</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3967</span> </span><span class="WHIT">		</span><span class="NAME">t</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.timer.new</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3968</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3969</span> </span><span class="WHIT">	</span><span class="NAME">this.timers.push</span><span class="PUNC">(</span><span class="NAME">t</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3970</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">t</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3971</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3972</span> 
<span class='line'>3973</span> </span><span class="COMM">/**
<span class='line'>3974</span>  * Updates all the timers.
<span class='line'>3975</span>  */</span><span class="WHIT">
<span class='line'>3976</span> </span><span class="NAME">baa.timerManager.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3977</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.playing</span><span class="PUNC">)</span><span class="WHIT"> 	</span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3978</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.timers.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3979</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.timers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.timers.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3980</span> </span><span class="WHIT">			</span><span class="NAME">this.timers</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3981</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3982</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3983</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3984</span> 
<span class='line'>3985</span> </span><span class="COMM">/**
<span class='line'>3986</span>  *	Resumes the manager updating the timers.
<span class='line'>3987</span>  */</span><span class="WHIT">
<span class='line'>3988</span> </span><span class="NAME">baa.timerManager.play</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3989</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3990</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3991</span> 
<span class='line'>3992</span> </span><span class="COMM">/**
<span class='line'>3993</span>  * Pauses the manager from updating timers.
<span class='line'>3994</span>  */</span><span class="WHIT">
<span class='line'>3995</span> </span><span class="NAME">baa.timerManager.pause</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>3996</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>3997</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>3998</span> 
<span class='line'>3999</span> </span><span class="COMM">/**
<span class='line'>4000</span>  * A global timermanager. Useful for if you want to make quick, automatically updating, disposable timers. You can not set a main object to this manager.
<span class='line'>4001</span>  */</span><span class="WHIT">
<span class='line'>4002</span> </span><span class="NAME">Timer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.timerManager.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4003</span> </span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">Timer.setObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4004</span> </span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">Timer.getObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4005</span> 
<span class='line'>4006</span> 
<span class='line'>4007</span> </span><span class="COMM">/**
<span class='line'>4008</span>  * A tool to make easy timers. You can make them loop, give them condiitons for playing, and make the call a function when they're done.
<span class='line'>4009</span>  * @see  baa.timerManager
<span class='line'>4010</span>  * @constructor
<span class='line'>4011</span>  * @param  {number} time The length of the timer in seconds.
<span class='line'>4012</span>  * @param  {string} [mode="normal"] If the timer should loop, die after one loop, or neither. Options: "loop", "once", "normal".
<span class='line'>4013</span>  * @param  {object} [obj] The object you want to connect to the condition and function of this timer.
<span class='line'>4014</span>  * @param  {object|function} [cond] A condition that must be true for the timer to play. 
<span class='line'>4015</span>  * This can either be a function returning a boolean, or an object with properties that have to be a certain value.
<span class='line'>4016</span>  * @param  {function|string} [func] The function you want to call each time the timer is finished.
<span class='line'>4017</span>  * @param  {object} [manager] The manager that owns this timer. Should only be given by the manager itself. 
<span class='line'>4018</span>  * This can either be the name of the function as a string, or a function on its own.
<span class='line'>4019</span>  */</span><span class="WHIT">
<span class='line'>4020</span> </span><span class="NAME">baa.timer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.timer"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4021</span> 
<span class='line'>4022</span> </span><span class="NAME">baa.timer.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="NAME">manager</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4023</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4024</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"time"</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4025</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"time"</span><span class="PUNC">,</span><span class="NAME">mode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4026</span> 
<span class='line'>4027</span> </span><span class="WHIT">	</span><span class="NAME">this._manager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">manager</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4028</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._manager.getObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4029</span> 
<span class='line'>4030</span> </span><span class="WHIT">	</span><span class="NAME">this.time</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">time</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4031</span> </span><span class="WHIT">	</span><span class="NAME">this.timeStart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">time</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4032</span> 
<span class='line'>4033</span> </span><span class="WHIT">	</span><span class="NAME">this.mode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">mode</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="STRN">"normal"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4034</span> 
<span class='line'>4035</span> </span><span class="WHIT">	</span><span class="NAME">this.condition</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4036</span> </span><span class="WHIT">	</span><span class="NAME">this.condType</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4037</span> 
<span class='line'>4038</span> </span><span class="WHIT">	</span><span class="NAME">this.updateFunc</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4039</span> </span><span class="WHIT">	</span><span class="NAME">this.updateObj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4040</span> 
<span class='line'>4041</span> </span><span class="WHIT">	</span><span class="NAME">this.completeFunc</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4042</span> </span><span class="WHIT">	</span><span class="NAME">this.completeObj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4043</span> 
<span class='line'>4044</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4045</span> </span><span class="WHIT">	</span><span class="NAME">this.ended</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4046</span> </span><span class="WHIT">	</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4047</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4048</span> 
<span class='line'>4049</span> </span><span class="COMM">/**
<span class='line'>4050</span>  * Sets an object to this timer that will be connected with the condition and function. 
<span class='line'>4051</span>  * @param {object} obj The object you want to set.
<span class='line'>4052</span>  */</span><span class="WHIT">
<span class='line'>4053</span> </span><span class="NAME">baa.timer.setObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4054</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4055</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4056</span> 
<span class='line'>4057</span> </span><span class="COMM">/**
<span class='line'>4058</span>  * Returns the object set to this timer. If no object is set yet, it will return null.
<span class='line'>4059</span>  * @return {object} The object set to this timer.
<span class='line'>4060</span>  */</span><span class="WHIT">
<span class='line'>4061</span> </span><span class="NAME">baa.timer.getObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4062</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4063</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4064</span> 
<span class='line'>4065</span> </span><span class="COMM">/**
<span class='line'>4066</span>  * Sets the condition of the timer that needs to be true for it to play. This can either be a function returning a boolean, 
<span class='line'>4067</span>  * or an object with properties that have to be a certain value.
<span class='line'>4068</span>  * @param {object|function} condition The condition of the timer that needs to be true for it to play.
<span class='line'>4069</span>  */</span><span class="WHIT">
<span class='line'>4070</span> </span><span class="NAME">baa.timer.setCondition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">condition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4071</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"condition"</span><span class="PUNC">,</span><span class="NAME">condition</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4072</span> 
<span class='line'>4073</span> </span><span class="WHIT">	</span><span class="NAME">this.condition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">condition</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4074</span> </span><span class="WHIT">	</span><span class="NAME">this.condType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">this.condition</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4075</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4076</span> 
<span class='line'>4077</span> </span><span class="COMM">/**
<span class='line'>4078</span>  * Updates the timer.
<span class='line'>4079</span>  */</span><span class="WHIT">
<span class='line'>4080</span> </span><span class="NAME">baa.timer.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4081</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.dead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4082</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.loop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4083</span> </span><span class="WHIT">			</span><span class="NAME">this.ended</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4084</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4085</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.ended</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4086</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">succes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT">
<span class='line'>4087</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4088</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.condition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4089</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.condType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4090</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.condition</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4091</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.condition</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4092</span> </span><span class="WHIT">							</span><span class="NAME">succes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4093</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4094</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4095</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4096</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4097</span> </span><span class="WHIT">					</span><span class="NAME">succes</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.condition</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4098</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4099</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4100</span> </span><span class="WHIT">				
<span class='line'>4101</span> 			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">succes</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4102</span> </span><span class="WHIT">				</span><span class="NAME">this.time</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4103</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.updateFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4104</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.updateObj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4105</span> </span><span class="WHIT">						</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">this.updateObj</span><span class="PUNC">,</span><span class="NAME">this.updateFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4106</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4107</span> </span><span class="WHIT">					</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4108</span> </span><span class="WHIT">						</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">this.updateFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4109</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4110</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4111</span> 
<span class='line'>4112</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.time</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4113</span> </span><span class="WHIT">					</span><span class="COMM">// if (this.func) {</span><span class="WHIT">
<span class='line'>4114</span> </span><span class="WHIT">					</span><span class="COMM">// 	baa.util.call(this.obj,this.func)</span><span class="WHIT">
<span class='line'>4115</span> </span><span class="WHIT">					</span><span class="COMM">// }</span><span class="WHIT">
<span class='line'>4116</span> 
<span class='line'>4117</span> </span><span class="WHIT">					</span><span class="NAME">this.ended</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4118</span> 
<span class='line'>4119</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.once</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4120</span> </span><span class="WHIT">						</span><span class="NAME">this.kill</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4121</span> </span><span class="WHIT">						</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4122</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4123</span> </span><span class="WHIT">					
<span class='line'>4124</span> 					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.loop</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4125</span> </span><span class="WHIT">						</span><span class="NAME">this.time</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.timeStart</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4126</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4127</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4128</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4129</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4130</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4131</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4132</span> 
<span class='line'>4133</span> </span><span class="COMM">/**
<span class='line'>4134</span>  * Resets the timer, making it start from the beginning. It does not revert killing.
<span class='line'>4135</span>  */</span><span class="WHIT">
<span class='line'>4136</span> </span><span class="NAME">baa.timer.reset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">time</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4137</span> </span><span class="WHIT">	</span><span class="NAME">this.timeStart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">time</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.timeStart</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4138</span> </span><span class="WHIT">	</span><span class="NAME">this.ended</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4139</span> </span><span class="WHIT">	</span><span class="NAME">this.time</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.timeStart</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4140</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4141</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4142</span> 
<span class='line'>4143</span> </span><span class="COMM">/**
<span class='line'>4144</span>  * Pauses the timer from playing.
<span class='line'>4145</span>  */</span><span class="WHIT">
<span class='line'>4146</span> </span><span class="NAME">baa.timer.pause</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4147</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT"> 
<span class='line'>4148</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4149</span> 
<span class='line'>4150</span> </span><span class="COMM">/**
<span class='line'>4151</span>  * Starts the timer, or resumes the timer from pausing.
<span class='line'>4152</span>  */</span><span class="WHIT">
<span class='line'>4153</span> </span><span class="NAME">baa.timer.play</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4154</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4155</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4156</span> 
<span class='line'>4157</span> </span><span class="COMM">/**
<span class='line'>4158</span>  * Stops the timer from playing, and starts at the beginning.
<span class='line'>4159</span>  * @return {[type]} [description]
<span class='line'>4160</span>  */</span><span class="WHIT">
<span class='line'>4161</span> </span><span class="NAME">baa.timer.stop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4162</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4163</span> </span><span class="WHIT">	</span><span class="NAME">this.time</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.timeStart</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4164</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4165</span> 
<span class='line'>4166</span> </span><span class="COMM">/**
<span class='line'>4167</span>  * Kills the timer, preventing it from updating, and removing itself from its managers timer list.
<span class='line'>4168</span>  */</span><span class="WHIT">
<span class='line'>4169</span> </span><span class="NAME">baa.timer.kill</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4170</span> </span><span class="WHIT">	</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4171</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4172</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4173</span> 
<span class='line'>4174</span> </span><span class="COMM">/**
<span class='line'>4175</span>  * Returns if the timer is finished. If a finished timer loops, it stops being finished at the next update.
<span class='line'>4176</span>  * @return {boolean} If the timer is finished.
<span class='line'>4177</span>  */</span><span class="WHIT">
<span class='line'>4178</span> </span><span class="NAME">baa.timer.isDone</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4179</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.ended</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4180</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4181</span> 
<span class='line'>4182</span> </span><span class="COMM">/**
<span class='line'>4183</span>  * Sets the function that will be called every time the timer updates.
<span class='line'>4184</span>  * @param  {string|function} func The function to be called.
<span class='line'>4185</span>  * @param  {object} obj  The object that this function is called with.
<span class='line'>4186</span>  * @return {baa.timer}      The timer, to allow further extending.
<span class='line'>4187</span>  */</span><span class="WHIT">
<span class='line'>4188</span> </span><span class="NAME">baa.timer.onUpdate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4189</span> </span><span class="WHIT">	</span><span class="NAME">this.updateFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">func</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4190</span> </span><span class="WHIT">	</span><span class="NAME">this.updateObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4191</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4192</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4193</span> 
<span class='line'>4194</span> </span><span class="COMM">/**
<span class='line'>4195</span>  * Sets the function that will be called every time the timer updates.
<span class='line'>4196</span>  * @param  {string|function} func The function to be called.
<span class='line'>4197</span>  * @param  {object} [obj]  The object that this function is called with. If no object is set, the timer's object will be used instead. 
<span class='line'>4198</span>  * @return {baa.timer}      The timer, to allow further extending.
<span class='line'>4199</span>  */</span><span class="WHIT">
<span class='line'>4200</span> </span><span class="NAME">baa.timer.onComplete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">func</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4201</span> </span><span class="WHIT">	</span><span class="NAME">this.completeFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">func</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4202</span> </span><span class="WHIT">	</span><span class="NAME">this.completeObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4203</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4204</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4205</span> 
<span class='line'>4206</span> </span><span class="COMM">//Tween</span><span class="WHIT">
<span class='line'>4207</span> </span><span class="COMM">//////////////////////////////////</span><span class="WHIT">
<span class='line'>4208</span> 
<span class='line'>4209</span> </span><span class="COMM">/**
<span class='line'>4210</span>  * A manager for baa.tween objects. Automatically updates and removes tweens made with it.
<span class='line'>4211</span>  * @constructor
<span class='line'>4212</span>  * @see baa.tween
<span class='line'>4213</span>  * @property {object} obj The object that owns this tweenmanager. Whenever you make a new tween with this tweenmanager, it will use this object.
<span class='line'>4214</span>  * @property {array} tweens A list of all the tweens owned by this tweenmanager.
<span class='line'>4215</span>  * @property {boolean} playing All the tweens will only update when this is true.
<span class='line'>4216</span>  * @param {object} [object] The owner of this tweenmanager.
<span class='line'>4217</span>  */</span><span class="WHIT">
<span class='line'>4218</span> </span><span class="NAME">baa.tweenManager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.tweenManager"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4219</span> 
<span class='line'>4220</span> </span><span class="NAME">baa.tweenManager.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4221</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4222</span> </span><span class="WHIT">	</span><span class="NAME">this.tweens</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4223</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4224</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4225</span> 
<span class='line'>4226</span> </span><span class="COMM">/**
<span class='line'>4227</span>  * Make a new tween.
<span class='line'>4228</span>  * @param  {object} [obj]  The object you want to tween. If you use a number instead, 
<span class='line'>4229</span>  * the function will take this argument as the rate and shift all other arguments. In this case it will use the manager's object.
<span class='line'>4230</span>  * @param  {number} rate  How long the tween should take in seconds.
<span class='line'>4231</span>  * @param  {object} vars  An object with properties of the object, and the values you want them to tween to.
<span class='line'>4232</span>  * @param  {boolean} force Whether to overwrite properties that are already being tweened. 
<span class='line'>4233</span>  * If true, the tween already using these properties will have these properties removed.
<span class='line'>4234</span>  * @return {baa.tween}	The tween created, allowing you to extend the tween by using .to, adding a delay with .delay, or easing with .ease.
<span class='line'>4235</span>  */</span><span class="WHIT">
<span class='line'>4236</span> </span><span class="NAME">baa.tweenManager.to</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">rate</span><span class="PUNC">,</span><span class="NAME">vars</span><span class="PUNC">,</span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4237</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4238</span> </span><span class="WHIT">		</span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">vars</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4239</span> </span><span class="WHIT">		</span><span class="NAME">vars</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rate</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4240</span> </span><span class="WHIT">		</span><span class="NAME">rate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4241</span> </span><span class="WHIT">		</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4242</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4243</span> 
<span class='line'>4244</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"force"</span><span class="PUNC">,</span><span class="NAME">force</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4245</span> 
<span class='line'>4246</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">tween</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.tween.new</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">rate</span><span class="PUNC">,</span><span class="NAME">vars</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4247</span> </span><span class="WHIT">	</span><span class="NAME">tween._force</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4248</span> </span><span class="WHIT">	</span><span class="NAME">this.tweens.push</span><span class="PUNC">(</span><span class="NAME">tween</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4249</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">tween</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4250</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4251</span> 
<span class='line'>4252</span> </span><span class="COMM">/**
<span class='line'>4253</span>  * Updates all the tweens
<span class='line'>4254</span>  */</span><span class="WHIT">
<span class='line'>4255</span> </span><span class="NAME">baa.tweenManager.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4256</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.playing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4257</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.tweens.length</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">--</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4258</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.tweens</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">dead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.tweens.splice</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">continue</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4259</span> </span><span class="WHIT">			</span><span class="NAME">this.tweens</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4260</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4261</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4262</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4263</span> 
<span class='line'>4264</span> </span><span class="COMM">/**
<span class='line'>4265</span>  * Set an object that the manager will use for its tweens.
<span class='line'>4266</span>  */</span><span class="WHIT">
<span class='line'>4267</span> </span><span class="NAME">baa.tweenManager.setObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4268</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4269</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4270</span> 
<span class='line'>4271</span> </span><span class="COMM">/**
<span class='line'>4272</span>  * Returns the object the manager is using for its tweens.
<span class='line'>4273</span>  * @return {object} The object the manager is using for its tweens.
<span class='line'>4274</span>  */</span><span class="WHIT">
<span class='line'>4275</span> </span><span class="NAME">baa.tweenManager.getObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4276</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4277</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4278</span> 
<span class='line'>4279</span> </span><span class="COMM">/**
<span class='line'>4280</span>  *	Resumes the manager updating its tweens.
<span class='line'>4281</span>  */</span><span class="WHIT">
<span class='line'>4282</span> </span><span class="NAME">baa.tweenManager.play</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4283</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4284</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4285</span> 
<span class='line'>4286</span> </span><span class="COMM">/**
<span class='line'>4287</span>  *	Pauses the manager updating its tweens.
<span class='line'>4288</span>  */</span><span class="WHIT">
<span class='line'>4289</span> </span><span class="NAME">baa.tweenManager.pause</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4290</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4291</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4292</span> 
<span class='line'>4293</span> </span><span class="COMM">/**
<span class='line'>4294</span>  * A global tweenmanager. Useful for if you want to make quick, automatically updating, disposable tweens. You can not set a main object to this manager.
<span class='line'>4295</span>  */</span><span class="WHIT">
<span class='line'>4296</span> </span><span class="NAME">Tween</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.tweenManager.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4297</span> </span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">Tween.getObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4298</span> </span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">Tween.setObject</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4299</span> 
<span class='line'>4300</span> </span><span class="COMM">/**
<span class='line'>4301</span>  * Making transitions of the value of properties easier. 
<span class='line'>4302</span>  * Make objects move from one point to another, use delay, easing, 
<span class='line'>4303</span>  * and call multiple tweens in a row. It is highly recommended that you use a tweenmanager.
<span class='line'>4304</span>  * @constructor
<span class='line'>4305</span>  * @param  {object} obj  The object you want to tween.
<span class='line'>4306</span>  * @param  {number} rate  How long the tween should take in seconds.
<span class='line'>4307</span>  * @param  {object} vars  An object with properties of the object, and the values you want them to tween to.
<span class='line'>4308</span>  * @param  {object} [manager] The manager that owns this tween. Should only be given by the manager itself.
<span class='line'>4309</span>  * @see baa.tweenManager
<span class='line'>4310</span>  */</span><span class="WHIT">
<span class='line'>4311</span> </span><span class="NAME">baa.tween</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa.tween"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4312</span> 
<span class='line'>4313</span> </span><span class="NAME">baa.tween.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">rate</span><span class="PUNC">,</span><span class="NAME">vars</span><span class="PUNC">,</span><span class="NAME">manager</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4314</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4315</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rate"</span><span class="PUNC">,</span><span class="NAME">rate</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4316</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"vars"</span><span class="PUNC">,</span><span class="NAME">vars</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4317</span> 
<span class='line'>4318</span> </span><span class="WHIT">	</span><span class="NAME">this._obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4319</span> </span><span class="WHIT">	</span><span class="NAME">this._rate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rate</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">/</span><span class="NAME">rate</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4320</span> </span><span class="WHIT">	</span><span class="NAME">this._vars</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">vars</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4321</span> </span><span class="WHIT">	</span><span class="NAME">this._manager</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">manager</span><span class="WHIT">
<span class='line'>4322</span> 
<span class='line'>4323</span> </span><span class="WHIT">	</span><span class="NAME">this._delay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4324</span> </span><span class="WHIT">	</span><span class="NAME">this._started</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4325</span> </span><span class="WHIT">	</span><span class="NAME">this._progress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4326</span> </span><span class="WHIT">	</span><span class="NAME">this._easeMode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"in"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4327</span> </span><span class="WHIT">	</span><span class="NAME">this._easing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"linear"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4328</span> </span><span class="WHIT">	</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4329</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4330</span> 
<span class='line'>4331</span> </span><span class="COMM">/**
<span class='line'>4332</span>  * Updates the tween
<span class='line'>4333</span>  */</span><span class="WHIT">
<span class='line'>4334</span> </span><span class="NAME">baa.tween.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4335</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.dead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4336</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._delay</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this._delay</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="PUNC">;</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4337</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._started</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>4338</span> 		</span><span class="NAME">this._start</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4339</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.startFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4340</span> </span><span class="WHIT">			</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">this.startObj</span><span class="PUNC">,</span><span class="NAME">this.startFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4341</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4342</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4343</span> </span><span class="WHIT">	</span><span class="NAME">this._progress</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._rate</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4344</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._progress</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4345</span> </span><span class="WHIT">	</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4346</span> </span><span class="WHIT">	</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.tween.__ease</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="NAME">this._easeMode</span><span class="PUNC">,</span><span class="NAME">this._easing</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4347</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._vars</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4348</span> </span><span class="WHIT">		</span><span class="NAME">this._obj</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT">  </span><span class="NAME">this._vars</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this._vars</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">diff</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4349</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4350</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.updateFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4351</span> </span><span class="WHIT">		</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">this.updateObj</span><span class="PUNC">,</span><span class="NAME">this.updateFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4352</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4353</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._progress</span><span class="WHIT"> </span><span class="PUNC">>=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4354</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.completeFunc</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>4355</span> 			</span><span class="NAME">baa.util.call</span><span class="PUNC">(</span><span class="NAME">this.completeObj</span><span class="PUNC">,</span><span class="NAME">this.completeFunc</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4356</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4357</span> </span><span class="WHIT">		</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4358</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._after</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4359</span> </span><span class="WHIT">			</span><span class="NAME">this._manager.tweens.push</span><span class="PUNC">(</span><span class="NAME">this._after</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4360</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4361</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4362</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4363</span> 
<span class='line'>4364</span> </span><span class="COMM">/**
<span class='line'>4365</span>  * Starts the tween.
<span class='line'>4366</span>  */</span><span class="WHIT">
<span class='line'>4367</span> </span><span class="NAME">baa.tween._start</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4368</span> </span><span class="WHIT">	</span><span class="COMM">//Check if there are duplicates</span><span class="WHIT">
<span class='line'>4369</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._manager</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4370</span> </span><span class="WHIT">		</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this._manager.tweens.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4371</span> </span><span class="WHIT">			</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">twn</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._manager.tweens</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4372</span> 
<span class='line'>4373</span> </span><span class="WHIT">			</span><span class="COMM">//We only check for inited, alive tweens.</span><span class="WHIT">
<span class='line'>4374</span> </span><span class="WHIT">			</span><span class="COMM">//Since this tween itself is not inited yet, we automatically check if it is itself.</span><span class="WHIT">
<span class='line'>4375</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">twn._started</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">twn.dead</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4376</span> </span><span class="WHIT">				</span><span class="COMM">//If they are the same object</span><span class="WHIT">
<span class='line'>4377</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._obj</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">twn.obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4378</span> </span><span class="WHIT">					</span><span class="COMM">//Make an array of all they keys both tweens have</span><span class="WHIT">
<span class='line'>4379</span> </span><span class="WHIT">					</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">same</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4380</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._vars</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4381</span> </span><span class="WHIT">						</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key2</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">twn.vars</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4382</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">key2</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4383</span> </span><span class="WHIT">								</span><span class="NAME">same.push</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4384</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4385</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4386</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4387</span> </span><span class="WHIT">					</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">same.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">j</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4388</span> </span><span class="WHIT">						</span><span class="COMM">//Wh1ether we use force to overwrite it or not</span><span class="WHIT">
<span class='line'>4389</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4390</span> </span><span class="WHIT">							</span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">twn.vars</span><span class="PUNC">[</span><span class="NAME">same</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4391</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4392</span> </span><span class="WHIT">						</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4393</span> </span><span class="WHIT">							</span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">this._vars</span><span class="PUNC">[</span><span class="NAME">same</span><span class="PUNC">[</span><span class="NAME">j</span><span class="PUNC">]</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4394</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4395</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4396</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4397</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4398</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4399</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4400</span> 
<span class='line'>4401</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">prop</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this._vars</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4402</span> </span><span class="WHIT">		</span><span class="NAME">this._vars</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4403</span> </span><span class="WHIT">		</span><span class="NAME">start</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._obj</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4404</span> </span><span class="WHIT">		</span><span class="NAME">diff</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="NAME">this._vars</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._obj</span><span class="PUNC">[</span><span class="NAME">prop</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>4405</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4406</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4407</span> 
<span class='line'>4408</span> </span><span class="WHIT">	</span><span class="NAME">this._started</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4409</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4410</span> 
<span class='line'>4411</span> </span><span class="COMM">/**
<span class='line'>4412</span>  * Sets a delay to the tween
<span class='line'>4413</span>  * @param  {number} delay The delay you want to set in seconds
<span class='line'>4414</span>  * @return {baa.tween}  The tween to allow further extending.
<span class='line'>4415</span>  */</span><span class="WHIT">
<span class='line'>4416</span> </span><span class="NAME">baa.tween.delay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">delay</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4417</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"delay"</span><span class="PUNC">,</span><span class="NAME">delay</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4418</span> 
<span class='line'>4419</span> </span><span class="WHIT">	</span><span class="NAME">this._delay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">delay</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4420</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4421</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4422</span> 
<span class='line'>4423</span> </span><span class="COMM">/**
<span class='line'>4424</span>  * Sets the easing to the tween. Easing adapts the way the property transitions to its goal. 
<span class='line'>4425</span>  * @param  {string} easeMode If the easing should be used at the start, at the end, or both.
<span class='line'>4426</span>  * Options: "in", "out", "inout".
<span class='line'>4427</span>  * @param {string} easing The easing you want to use.
<span class='line'>4428</span>  * Options: "linear", "quad", "cubic", "quart", "quint", "expo", "sine", "circ", "back", "elastic"
<span class='line'>4429</span>  * @return {baa.tween}  The tween to allow further extending.
<span class='line'>4430</span>  */</span><span class="WHIT">
<span class='line'>4431</span> </span><span class="NAME">baa.tween.ease</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">easeMode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4432</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"easeMode"</span><span class="PUNC">,</span><span class="NAME">easeMode</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4433</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"easing"</span><span class="PUNC">,</span><span class="NAME">easing</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4434</span> 
<span class='line'>4435</span> </span><span class="WHIT">	</span><span class="NAME">this._easeMode</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">easeMode</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4436</span> </span><span class="WHIT">	</span><span class="NAME">this._easing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4437</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4438</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4439</span> 
<span class='line'>4440</span> </span><span class="COMM">/**
<span class='line'>4441</span>  * Sets a function that will be called when the tween starts (after the delay).
<span class='line'>4442</span>  * @param  {string|function} f   The function you want to have called. 
<span class='line'>4443</span>  * This can either be the name of the function as a string, or a function on its own.
<span class='line'>4444</span>  * @param  {object} [obj] The object you want to have the function called. If null, the tween's object is used instead.
<span class='line'>4445</span>  * @return {baa.tween} The tween to allow further extending.     
<span class='line'>4446</span>  */</span><span class="WHIT">
<span class='line'>4447</span> </span><span class="NAME">baa.tween.onStart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4448</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4449</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4450</span> 
<span class='line'>4451</span> </span><span class="WHIT">	</span><span class="NAME">this.startFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4452</span> </span><span class="WHIT">	</span><span class="NAME">this.startObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4453</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4454</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4455</span> 
<span class='line'>4456</span> </span><span class="COMM">/**
<span class='line'>4457</span>  * Sets a function that will be called every time the tween updates.
<span class='line'>4458</span>  * @param  {string|function} f   The function you want to have called. 
<span class='line'>4459</span>  * This can either be the name of the function as a string, or a function on its own.
<span class='line'>4460</span>  * @param  {object} [obj] The object you want to have the function called. If null, the tween's object is used instead.
<span class='line'>4461</span>  * @return {baa.tween} The tween to allow further extending.     
<span class='line'>4462</span>  */</span><span class="WHIT">
<span class='line'>4463</span> </span><span class="NAME">baa.tween.onUpdate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4464</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4465</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4466</span> 
<span class='line'>4467</span> </span><span class="WHIT">	</span><span class="NAME">this.updateFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4468</span> </span><span class="WHIT">	</span><span class="NAME">this.updateObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4469</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4470</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4471</span> 
<span class='line'>4472</span> </span><span class="COMM">/**
<span class='line'>4473</span>  * Sets a function that will be called when the tween ends.
<span class='line'>4474</span>  * @param  {string|function} f   The function you want to have called. 
<span class='line'>4475</span>  * This can either be the name of the function as a string, or a function on its own.
<span class='line'>4476</span>  * @param  {object} [obj] The object you want to have the function called. If null, the tween's object is used instead.
<span class='line'>4477</span>  * @return {baa.tween} The tween to allow further extending.     
<span class='line'>4478</span>  */</span><span class="WHIT">
<span class='line'>4479</span> </span><span class="NAME">baa.tween.onComplete</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="PUNC">(</span><span class="NAME">f</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4480</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="NAME">f</span><span class="PUNC">,</span><span class="STRN">"function"</span><span class="PUNC">,</span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4481</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4482</span> 
<span class='line'>4483</span> </span><span class="WHIT">	</span><span class="NAME">this.completeFunc</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">f</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4484</span> </span><span class="WHIT">	</span><span class="NAME">this.completeObj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">this._obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4485</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">this</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4486</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4487</span> 
<span class='line'>4488</span> </span><span class="COMM">/**
<span class='line'>4489</span>  * Stops the tween, killing it.
<span class='line'>4490</span>  */</span><span class="WHIT">
<span class='line'>4491</span> </span><span class="NAME">baa.tween.stop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4492</span> </span><span class="WHIT">	</span><span class="NAME">this.dead</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4493</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4494</span> 
<span class='line'>4495</span> </span><span class="COMM">/**
<span class='line'>4496</span>  * Sets the tween's progress to 1, setting properties to its final value in the next update.
<span class='line'>4497</span>  * @return {[type]} [description]
<span class='line'>4498</span>  */</span><span class="WHIT">
<span class='line'>4499</span> </span><span class="NAME">baa.tween.rush</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4500</span> </span><span class="WHIT">	</span><span class="NAME">this._progress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4501</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4502</span> 
<span class='line'>4503</span> </span><span class="COMM">/**
<span class='line'>4504</span>  * Creates a new tween. This can only be done with tweens owned by a tweenmanager.  
<span class='line'>4505</span>  * @param  {object} obj  The object you want to tween. If this is a number instead 
<span class='line'>4506</span>  * the function will take this argument as the rate and shift all other arguments. In this case it will use the manager's object.
<span class='line'>4507</span>  * @param  {number} rate  How long the tween should take in seconds.
<span class='line'>4508</span>  * @param  {object} vars  An object with properties of the object, and the values you want them to tween to.
<span class='line'>4509</span>  * @param  {boolean} force Whether to overwrite properties that already being tweened.
<span class='line'>4510</span>  * @return {baa.tween}       The new tween.
<span class='line'>4511</span>  */</span><span class="WHIT">
<span class='line'>4512</span> </span><span class="NAME">baa.tween.to</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">rate</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">vars</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">force</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4513</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this._manager</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">throw</span><span class="PUNC">(</span><span class="STRN">"This function can only be called by tweens that are owned by a tweenmanager."</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4514</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4515</span> </span><span class="WHIT">		</span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">vars</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4516</span> </span><span class="WHIT">		</span><span class="NAME">vars</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rate</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4517</span> </span><span class="WHIT">		</span><span class="NAME">rate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4518</span> </span><span class="WHIT">		</span><span class="NAME">obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4519</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4520</span> 
<span class='line'>4521</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"rate"</span><span class="PUNC">,</span><span class="NAME">rate</span><span class="PUNC">,</span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4522</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"vars"</span><span class="PUNC">,</span><span class="NAME">vars</span><span class="PUNC">,</span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4523</span> </span><span class="WHIT">	</span><span class="NAME">baa._checkType</span><span class="PUNC">(</span><span class="STRN">"force"</span><span class="PUNC">,</span><span class="NAME">force</span><span class="PUNC">,</span><span class="STRN">"boolean"</span><span class="PUNC">,</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4524</span> </span><span class="WHIT">	
<span class='line'>4525</span> 	</span><span class="NAME">this._after</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.tween.new</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">rate</span><span class="PUNC">,</span><span class="NAME">vars</span><span class="PUNC">,</span><span class="NAME">this._manager</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4526</span> </span><span class="WHIT">	</span><span class="NAME">this._after._force</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">force</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4527</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._after</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4528</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4529</span> 
<span class='line'>4530</span> </span><span class="COMM">/**
<span class='line'>4531</span>  * Adapts progress with easing.
<span class='line'>4532</span>  * @param  {number} p      The progress of the tween. A number between 0 and 1.
<span class='line'>4533</span>  * @param  {string} easeMode  The easemode to use.
<span class='line'>4534</span>  * @param  {string} easing The easing type.
<span class='line'>4535</span>  * @return {number}        The adapted progress.
<span class='line'>4536</span>  */</span><span class="WHIT">
<span class='line'>4537</span> </span><span class="NAME">baa.tween.__ease</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">easeMode</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4538</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">easing</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"linear"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4539</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">easeMode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"out"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4540</span> </span><span class="WHIT">		</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4541</span> </span><span class="WHIT">		</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">baa.tween</span><span class="PUNC">[</span><span class="STRN">"__"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4542</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4543</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">easeMode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"in"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4544</span> </span><span class="WHIT">		</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.tween</span><span class="PUNC">[</span><span class="STRN">"__"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4545</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4546</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">easeMode</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"easeMode"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4547</span> </span><span class="WHIT">		</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4548</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4549</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">.</span><span class="NUMB">5</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.tween</span><span class="PUNC">[</span><span class="STRN">"__"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4550</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4551</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4552</span> </span><span class="WHIT">			</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">2</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4553</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">.</span><span class="NUMB">5</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.tween</span><span class="PUNC">[</span><span class="STRN">"__"</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">easing</span><span class="PUNC">]</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">.</span><span class="NUMB">5</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4554</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4555</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4556</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4557</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4558</span> 
<span class='line'>4559</span> </span><span class="NAME">baa.tween.__quad</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4560</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4561</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4562</span> 
<span class='line'>4563</span> </span><span class="NAME">baa.tween.__cubic</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4564</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4565</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4566</span> 
<span class='line'>4567</span> </span><span class="NAME">baa.tween.__quart</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4568</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4569</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4570</span> 
<span class='line'>4571</span> </span><span class="NAME">baa.tween.__quint</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4572</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="NAME">p</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4573</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4574</span> 
<span class='line'>4575</span> </span><span class="NAME">baa.tween.__expo</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4576</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NUMB">10</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4577</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4578</span> 
<span class='line'>4579</span> </span><span class="NAME">baa.tween.__sine</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4580</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Math.PI</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">.</span><span class="NUMB">5</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4581</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4582</span> 
<span class='line'>4583</span> </span><span class="NAME">baa.tween.__circ</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4584</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">Math.sqrt</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4585</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4586</span> 
<span class='line'>4587</span> </span><span class="NAME">baa.tween.__back</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4588</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NUMB">2.7</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">p</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">1.7</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4589</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4590</span> 
<span class='line'>4591</span> </span><span class="NAME">baa.tween.__elastic</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4592</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">(</span><span class="NAME">Math.pow</span><span class="PUNC">(</span><span class="NUMB">2</span><span class="PUNC">,</span><span class="PUNC">(</span><span class="NUMB">10</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="PUNC">(</span><span class="NAME">p</span><span class="PUNC">-</span><span class="NUMB">1.075</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="PUNC">(</span><span class="NAME">Math.PI</span><span class="PUNC">*</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="PUNC">.</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4593</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4594</span> 
<span class='line'>4595</span> </span><span class="COMM">//Camera</span><span class="WHIT">
<span class='line'>4596</span> </span><span class="COMM">///////////////////////////</span><span class="WHIT">
<span class='line'>4597</span> 
<span class='line'>4598</span> </span><span class="COMM">/**
<span class='line'>4599</span>  * A tool that helps you with cameras in your game. Make the camera follow an object, decide the size of the camera, and give it boundaries. You can also zoom in and rotate.
<span class='line'>4600</span>  * @constructor
<span class='line'>4601</span>  * @property {baa.rect} _window The rectangle everything is drawn in.
<span class='line'>4602</span>  * @property {baa.rect} _world The world's boundaries. The camera won't go out of this.
<span class='line'>4603</span>  * @property {baa.rect} _follow The object the camera should follow.
<span class='line'>4604</span>  * @property {baa.point} _velocity The velocity of the camera. This is based on the distance of the object.
<span class='line'>4605</span>  * @property {baa.point} _real The actual position of the camera, meaning the x position + the shake offset.
<span class='line'>4606</span>  * @property {baa.point} _shakeOffset The offset of the camera shake.
<span class='line'>4607</span>  * @property {number} _shakePower The power of the camera shake. The higher the number, the more the camera shakes.
<span class='line'>4608</span>  * @property {baa.timer} _shakeTimer How long the screenshake takes.
<span class='line'>4609</span>  * @property {boolean} active If the camera is active. Set it to false to stop moving and drawing with the camera.
<span class='line'>4610</span>  * @property {number} zoom How far the camera is zoomed in. 1 means not zoomed in at all.
<span class='line'>4611</span>  * @property {number} speed How fast the camera moves.
<span class='line'>4612</span>  * @param 	 {number} x The horizontal position of the camera on the screen.	 
<span class='line'>4613</span>  * @param 	 {number} y The vertical position of the camera on the screen.
<span class='line'>4614</span>  * @param 	 {number} width The width of the camera.
<span class='line'>4615</span>  * @param 	 {number} height The height of the camera.
<span class='line'>4616</span>  */</span><span class="WHIT">
<span class='line'>4617</span> </span><span class="NAME">baa.camera</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.extend</span><span class="PUNC">(</span><span class="STRN">"baa.camera"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4618</span> 
<span class='line'>4619</span> </span><span class="NAME">baa.camera.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4620</span> </span><span class="WHIT">		</span><span class="NAME">baa.camera.super.init</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4621</span> </span><span class="WHIT">		</span><span class="NAME">this._window</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4622</span> </span><span class="WHIT">		</span><span class="NAME">this._world</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4623</span> </span><span class="WHIT">		</span><span class="NAME">this._follow</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4624</span> </span><span class="WHIT">		</span><span class="NAME">this._velocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4625</span> </span><span class="WHIT">		</span><span class="NAME">this._real</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4626</span> </span><span class="WHIT">		</span><span class="NAME">this._shakeOffset</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.point.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4627</span> </span><span class="WHIT">		</span><span class="NAME">this._shakePower</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4628</span> </span><span class="WHIT">		</span><span class="NAME">this._shakeTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Timer.new</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">.</span><span class="NAME">onUpdate</span><span class="PUNC">(</span><span class="STRN">"_screenshake"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4629</span> </span><span class="WHIT">		</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4630</span> </span><span class="WHIT">		</span><span class="NAME">this.zoom</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4631</span> </span><span class="WHIT">		</span><span class="NAME">this.speed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4632</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4633</span> 
<span class='line'>4634</span> </span><span class="COMM">/**
<span class='line'>4635</span>  * Updates the camera's position
<span class='line'>4636</span>  */</span><span class="WHIT">
<span class='line'>4637</span> </span><span class="NAME">baa.camera.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4638</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4639</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._follow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4640</span> </span><span class="WHIT">			</span><span class="NAME">this._setVelocity</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4641</span> </span><span class="WHIT">			</span><span class="NAME">this._move</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4642</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4643</span> 
<span class='line'>4644</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyboard.isDown</span><span class="PUNC">(</span><span class="STRN">" "</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4645</span> </span><span class="WHIT">			</span><span class="NAME">this._screenshake</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4646</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4647</span> 
<span class='line'>4648</span> </span><span class="WHIT">		</span><span class="NAME">this._real.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._shakeOffset.x</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4649</span> </span><span class="WHIT">		</span><span class="NAME">this._real.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._shakeOffset.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4650</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4651</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4652</span> 
<span class='line'>4653</span> </span><span class="COMM">/**
<span class='line'>4654</span>  * Sets the velocity of the camera
<span class='line'>4655</span>  */</span><span class="WHIT">
<span class='line'>4656</span> </span><span class="NAME">baa.camera._setVelocity</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4657</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.util.distance</span><span class="PUNC">(</span><span class="NAME">this.centerX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.centerY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this._follow.centerX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">this.centerY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4658</span> </span><span class="WHIT">		</span><span class="COMM">// print(this._x,this._follow.x);</span><span class="WHIT">
<span class='line'>4659</span> </span><span class="WHIT">		</span><span class="NAME">this._velocity.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.centerX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this._follow.centerX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">baa.util.sign</span><span class="PUNC">(</span><span class="NAME">this.centerX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._follow.centerX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4660</span> </span><span class="WHIT">		</span><span class="NAME">this._velocity.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.abs</span><span class="PUNC">(</span><span class="NAME">this.centerY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this._follow.centerY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">baa.util.sign</span><span class="PUNC">(</span><span class="NAME">this.centerY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this._follow.centerY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4661</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4662</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4663</span> </span><span class="WHIT">		</span><span class="NAME">this._velocity.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4664</span> </span><span class="WHIT">		</span><span class="NAME">this._velocity.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4665</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4666</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4667</span> 
<span class='line'>4668</span> </span><span class="COMM">/**
<span class='line'>4669</span>  * Moves the camera
<span class='line'>4670</span>  */</span><span class="WHIT">
<span class='line'>4671</span> </span><span class="NAME">baa.camera._move</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4672</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._velocity.x</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this.speed</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4673</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this._velocity.y</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this.speed</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4674</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._world</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4675</span> </span><span class="WHIT">		</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this._world.left</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._world.right</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.width</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4676</span> </span><span class="WHIT">		</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this._world.top</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._world.bottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4677</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4678</span> 
<span class='line'>4679</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this._world</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4680</span> </span><span class="WHIT">		</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this._world.left</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._world.right</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.width</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4681</span> </span><span class="WHIT">		</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this._world.top</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this._world.bottom</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">-</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4682</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4683</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4684</span> 
<span class='line'>4685</span> </span><span class="COMM">/**
<span class='line'>4686</span>  * Sets the position of the shake offset
<span class='line'>4687</span>  */</span><span class="WHIT">
<span class='line'>4688</span> </span><span class="NAME">baa.camera._screenshake</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4689</span> </span><span class="WHIT">	</span><span class="NAME">this._shakeOffset.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.cos</span><span class="PUNC">(</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this._shakePower</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4690</span> </span><span class="WHIT">	</span><span class="NAME">this._shakeOffset.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.sin</span><span class="PUNC">(</span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">*</span><span class="NAME">this._shakePower</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4691</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4692</span> 
<span class='line'>4693</span> </span><span class="COMM">/**
<span class='line'>4694</span>  * Starts the camera. After this, everything that is drawn, is inside the camera.
<span class='line'>4695</span>  */</span><span class="WHIT">
<span class='line'>4696</span> </span><span class="NAME">baa.camera.start</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4697</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.push</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4698</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setScissor</span><span class="PUNC">(</span><span class="WHIT">
<span class='line'>4699</span> </span><span class="WHIT">		</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> 
<span class='line'>4700</span> 			</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"scissor"</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>4701</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>4702</span> </span><span class="WHIT">		</span><span class="NAME">this._window</span><span class="WHIT">
<span class='line'>4703</span> </span><span class="WHIT">	</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4704</span> </span><span class="WHIT">	</span><span class="COMM">// baa.graphics.scale(this._zoom);</span><span class="WHIT">
<span class='line'>4705</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.translate</span><span class="PUNC">(</span><span class="PUNC">-</span><span class="NAME">this._real.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._window.x</span><span class="PUNC">,</span><span class="PUNC">-</span><span class="NAME">this._real.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this._window.y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4706</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4707</span> 
<span class='line'>4708</span> </span><span class="COMM">/**
<span class='line'>4709</span>  * Stops the camera. Now everything drawn after this will be drawn normally again.
<span class='line'>4710</span>  */</span><span class="WHIT">
<span class='line'>4711</span> </span><span class="NAME">baa.camera.stop</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4712</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setScissor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4713</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4714</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4715</span> 
<span class='line'>4716</span> </span><span class="COMM">/**
<span class='line'>4717</span>  * Sets the window, the rectangle of the camera on screen. The x and y position decide where the camera will be drawn.
<span class='line'>4718</span>  * @param {number} x      The horizontal position of the camera on screen.
<span class='line'>4719</span>  * @param {number} y      The vertical position of the camera on screen.
<span class='line'>4720</span>  * @param {number} width  The width of the camera.
<span class='line'>4721</span>  * @param {number} height The height of the camera.
<span class='line'>4722</span>  */</span><span class="WHIT">
<span class='line'>4723</span> </span><span class="NAME">baa.camera.setWindow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4724</span> </span><span class="WHIT">	</span><span class="NAME">this._window.set</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4725</span> </span><span class="WHIT">	</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4726</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">height</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4727</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4728</span> 
<span class='line'>4729</span> </span><span class="COMM">/**
<span class='line'>4730</span>  * Sets the boundaries of the world. The camera does not go outside of these boundaries.
<span class='line'>4731</span>  * @param {number} x      The horizontal position of the boundary of the world.
<span class='line'>4732</span>  * @param {number} y      The vertical position of the boundary of the world.
<span class='line'>4733</span>  * @param {number} width  The width of boundary of the world.
<span class='line'>4734</span>  * @param {number} height The height of the boundary of the world.
<span class='line'>4735</span>  */</span><span class="WHIT">
<span class='line'>4736</span> </span><span class="NAME">baa.camera.setWorld</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4737</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">!=</span><span class="KEYW">null</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4738</span> </span><span class="WHIT">		</span><span class="NAME">this._world</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">width</span><span class="PUNC">,</span><span class="NAME">height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4739</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT"> 
<span class='line'>4740</span> 	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4741</span> </span><span class="WHIT">		</span><span class="NAME">this._world</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4742</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4743</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4744</span> 
<span class='line'>4745</span> </span><span class="COMM">/**
<span class='line'>4746</span>  * Sets the object the camera should follow.
<span class='line'>4747</span>  * @param {baa.rect|null} obj The object the camera should follow. If no argument is given, the camera won't follow any object instead. 
<span class='line'>4748</span>  */</span><span class="WHIT">
<span class='line'>4749</span> </span><span class="NAME">baa.camera.setFollow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4750</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4751</span> </span><span class="WHIT">		</span><span class="NAME">this._follow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4752</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4753</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4754</span> </span><span class="WHIT">		</span><span class="NAME">this._follow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">null</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4755</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4756</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4757</span> 
<span class='line'>4758</span> </span><span class="COMM">/**
<span class='line'>4759</span>  * Returns the object the camera currently follows
<span class='line'>4760</span>  * @return {baa.rect|null} The object the camera follows. If the camera doesn't follow any object, null is returned.
<span class='line'>4761</span>  */</span><span class="WHIT">
<span class='line'>4762</span> </span><span class="NAME">baa.camera.getFollow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4763</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this._follow</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4764</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4765</span> 
<span class='line'>4766</span> </span><span class="COMM">/**
<span class='line'>4767</span>  * Sets the activation of the camera. 
<span class='line'>4768</span>  * @param {boolean} active 
<span class='line'>4769</span>  */</span><span class="WHIT">
<span class='line'>4770</span> </span><span class="NAME">baa.camera.setActive</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">active</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4771</span> </span><span class="WHIT">	</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">active</span><span class="WHIT">
<span class='line'>4772</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4773</span> 
<span class='line'>4774</span> </span><span class="COMM">/**
<span class='line'>4775</span>  * Returns the current activation state of the camera.
<span class='line'>4776</span>  * @return {boolean} The activation of the camera.
<span class='line'>4777</span>  */</span><span class="WHIT">
<span class='line'>4778</span> </span><span class="NAME">baa.camera.getActive</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4779</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.active</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4780</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4781</span> 
<span class='line'>4782</span> </span><span class="COMM">/**
<span class='line'>4783</span>  * Shakes the camera.
<span class='line'>4784</span>  * @param  {number} [power=3] How much the screen should shake. Use a number higher than 0. 
<span class='line'>4785</span>  * If 0, shaking currently going on will stop. If null, The default will be used.
<span class='line'>4786</span>  * @param  {number} [time=0.3]  How long the camera should shake.
<span class='line'>4787</span>  */</span><span class="WHIT">
<span class='line'>4788</span> </span><span class="NAME">baa.camera.shake</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">power</span><span class="PUNC">,</span><span class="NAME">time</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4789</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">power</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4790</span> </span><span class="WHIT">		</span><span class="NAME">this._shakePower</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">power</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4791</span> </span><span class="WHIT">		</span><span class="NAME">this._shakeTimer.reset</span><span class="PUNC">(</span><span class="NAME">time</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NUMB">0.3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4792</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4793</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4794</span> </span><span class="WHIT">		</span><span class="NAME">this._shakeTimer.reset</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4795</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4796</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4797</span> 
<span class='line'>4798</span> </span><span class="COMM">/**
<span class='line'>4799</span>  * A global camera. It's update and drawn automatically.
<span class='line'>4800</span>  */</span><span class="WHIT">
<span class='line'>4801</span> </span><span class="NAME">Camera</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.camera.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4802</span> 
<span class='line'>4803</span> </span><span class="COMM">/////////////////////////////</span><span class="WHIT">
<span class='line'>4804</span> </span><span class="COMM">/////////////////////////////</span><span class="WHIT">
<span class='line'>4805</span> 
<span class='line'>4806</span> </span><span class="COMM">//Debug</span><span class="WHIT">
<span class='line'>4807</span> 
<span class='line'>4808</span> </span><span class="NAME">baa._debug</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa._debug"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4809</span> 
<span class='line'>4810</span> </span><span class="NAME">baa._debug.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4811</span> </span><span class="WHIT">	</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4812</span> 
<span class='line'>4813</span> </span><span class="WHIT">	</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4814</span> </span><span class="WHIT">	</span><span class="NAME">this.hide</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4815</span> </span><span class="WHIT">	</span><span class="NAME">this.speed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4816</span> 
<span class='line'>4817</span> </span><span class="WHIT">	</span><span class="NAME">this.activeHold</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="STRN">"shift"</span><span class="PUNC">,</span><span class="STRN">"d"</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4818</span> </span><span class="WHIT">	</span><span class="NAME">this.activePress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"b"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4819</span> 
<span class='line'>4820</span> </span><span class="WHIT">	</span><span class="NAME">this.drawCalls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4821</span> </span><span class="WHIT">	</span><span class="NAME">this.oldDrawCalls</span><span class="WHIT"> </span><span class="COMM">//We don't want to count the debug drawcalls, so we store the original value in this</span><span class="WHIT">
<span class='line'>4822</span> </span><span class="WHIT">	</span><span class="NAME">this.barFont</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.graphics.newFont</span><span class="PUNC">(</span><span class="STRN">"arial"</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4823</span> 
<span class='line'>4824</span> </span><span class="WHIT">	</span><span class="COMM">//Buttons</span><span class="WHIT">
<span class='line'>4825</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonHide</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NUMB">260</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4826</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonRewind</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NUMB">300</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4827</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPlay</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NUMB">340</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4828</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonForward</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NUMB">380</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4829</span> 
<span class='line'>4830</span> </span><span class="WHIT">	</span><span class="NAME">this.windows</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.group.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4831</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.prepare</span><span class="PUNC">(</span><span class="NAME">baa._debug.window</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4832</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4833</span> 
<span class='line'>4834</span> </span><span class="NAME">baa._debug.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4835</span> </span><span class="WHIT">	</span><span class="NAME">this.drawCalls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4836</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4837</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyboard.isDown</span><span class="PUNC">(</span><span class="NAME">this.activeHold</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">baa.keyboard.isPressed</span><span class="PUNC">(</span><span class="NAME">this.activePress</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4838</span> </span><span class="WHIT">			</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4839</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4840</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4841</span> 
<span class='line'>4842</span> 
<span class='line'>4843</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4844</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonPlay.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4845</span> </span><span class="WHIT">				</span><span class="NAME">this.playing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.playing</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4846</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4847</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonRewind.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4848</span> </span><span class="WHIT">				</span><span class="NAME">this.speed</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0.25</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4849</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4850</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonForward.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4851</span> </span><span class="WHIT">				</span><span class="NAME">this.speed</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0.25</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4852</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4853</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonHide.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4854</span> </span><span class="WHIT">				</span><span class="NAME">this.hide</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.hide</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4855</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4856</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4857</span> 
<span class='line'>4858</span> </span><span class="WHIT">		</span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this.speed</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4859</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.playing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4860</span> </span><span class="WHIT">			</span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4861</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"m"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4862</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonRewind.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4863</span> </span><span class="WHIT">					</span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NAME">ot</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4864</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4865</span> </span><span class="WHIT">				</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonForward.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4866</span> </span><span class="WHIT">					</span><span class="NAME">dt</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">ot</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4867</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT"> 
<span class='line'>4868</span> 
<span class='line'>4869</span> 			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4870</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4871</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4872</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4873</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyboard.isDown</span><span class="PUNC">(</span><span class="NAME">this.activeHold</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">baa.keyboard.isPressed</span><span class="PUNC">(</span><span class="NAME">this.activePress</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4874</span> </span><span class="WHIT">			</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4875</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4876</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4877</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4878</span> 
<span class='line'>4879</span> </span><span class="NAME">baa._debug.updateWindows</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4880</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.hide</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4881</span> </span><span class="WHIT">		</span><span class="NAME">this.windows.update</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4882</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4883</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4884</span> 
<span class='line'>4885</span> </span><span class="NAME">baa._debug.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4886</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4887</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setLineWidth</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4888</span> </span><span class="WHIT">		</span><span class="NAME">this.oDrawCalls</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.drawCalls</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4889</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.active</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.hide</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4890</span> </span><span class="WHIT">			</span><span class="NAME">this.windows.draw</span><span class="PUNC">(</span><span class="NAME">baa.group.forward</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4891</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4892</span> </span><span class="WHIT">		</span><span class="NAME">this.drawToolBar</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4893</span> 
<span class='line'>4894</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4895</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setLineWidth</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4896</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4897</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4898</span> 
<span class='line'>4899</span> </span><span class="NAME">baa._debug.drawToolBar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4900</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4901</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">0.8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4902</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">baa.graphics.width</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4903</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4904</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setFont</span><span class="PUNC">(</span><span class="NAME">this.barFont</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4905</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">"FPS: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">this.fps</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">9</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4906</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.line</span><span class="PUNC">(</span><span class="NUMB">92</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">92</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4907</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">"Drawcalls: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.oDrawCalls</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">9</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4908</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.line</span><span class="PUNC">(</span><span class="NUMB">260</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">260</span><span class="PUNC">,</span><span class="NUMB">40</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4909</span> </span><span class="WHIT">	</span><span class="NAME">this.drawToolButtons</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4910</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4911</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">"Speed: "</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.speed</span><span class="PUNC">,</span><span class="NAME">this.buttonForward.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4912</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4913</span> 
<span class='line'>4914</span> </span><span class="NAME">baa._debug.drawToolButtons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4915</span> 
<span class='line'>4916</span> </span><span class="WHIT">	</span><span class="COMM">//Hide</span><span class="WHIT">
<span class='line'>4917</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4918</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonHide.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4919</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4920</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonHide.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4921</span> 
<span class='line'>4922</span> </span><span class="WHIT">	</span><span class="COMM">//Play</span><span class="WHIT">
<span class='line'>4923</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4924</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPlay.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4925</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4926</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPlay.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4927</span> 
<span class='line'>4928</span> 
<span class='line'>4929</span> </span><span class="WHIT">	</span><span class="COMM">//Rewind</span><span class="WHIT">
<span class='line'>4930</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4931</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonRewind.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4932</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4933</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonRewind.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4934</span> 
<span class='line'>4935</span> </span><span class="WHIT">	</span><span class="COMM">//Forward</span><span class="WHIT">
<span class='line'>4936</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4937</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonForward.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4938</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4939</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonForward.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4940</span> 
<span class='line'>4941</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4942</span> 
<span class='line'>4943</span> </span><span class="WHIT">	</span><span class="COMM">//Hide</span><span class="WHIT">
<span class='line'>4944</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">,</span><span class="NAME">this.buttonHide.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NAME">this.buttonHide.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">20</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">20</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>4945</span> 
<span class='line'>4946</span> </span><span class="WHIT">	</span><span class="COMM">//Rewind</span><span class="WHIT">
<span class='line'>4947</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.star</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonRewind.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">15</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.buttonRewind.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">18</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4948</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.star</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonRewind.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">27</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.buttonRewind.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">18</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NAME">Math.PI</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4949</span> 
<span class='line'>4950</span> </span><span class="WHIT">	</span><span class="COMM">//Forward</span><span class="WHIT">
<span class='line'>4951</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.star</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonForward.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">13</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.buttonForward.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">18</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4952</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.star</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonForward.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.buttonRewind.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">18</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4953</span> </span><span class="WHIT">	
<span class='line'>4954</span> 	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.playing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4955</span> </span><span class="WHIT">		</span><span class="COMM">//Pause</span><span class="WHIT">
<span class='line'>4956</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonPlay.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">7</span><span class="PUNC">,</span><span class="NAME">this.buttonPlay.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">30</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4957</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonPlay.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">23</span><span class="PUNC">,</span><span class="NAME">this.buttonPlay.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="NUMB">30</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4958</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4959</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4960</span> </span><span class="WHIT">		</span><span class="COMM">//Play</span><span class="WHIT">
<span class='line'>4961</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.star</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonPlay.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">17</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.buttonPlay.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">19</span><span class="PUNC">,</span><span class="NUMB">16</span><span class="PUNC">,</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4962</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4963</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4964</span> 
<span class='line'>4965</span> </span><span class="NAME">baa._debug.watch</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4966</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.set</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4967</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">wndow</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa._debug.window.new</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">220</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">this.windows.length</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4968</span> </span><span class="WHIT">	</span><span class="NAME">wndow.z</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4969</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.add</span><span class="PUNC">(</span><span class="NAME">wndow</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4970</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.sort</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4971</span> 
<span class='line'>4972</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4973</span> 
<span class='line'>4974</span> </span><span class="NAME">baa._debug.mousepressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4975</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.mousepressed</span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4976</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4977</span> 
<span class='line'>4978</span> </span><span class="NAME">baa._debug.keypressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4979</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.keypressed</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4980</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4981</span> 
<span class='line'>4982</span> </span><span class="NAME">baa._debug.focus</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wndow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4983</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.set</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4984</span> </span><span class="WHIT">	</span><span class="NAME">wndow.z</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4985</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.sort</span><span class="PUNC">(</span><span class="STRN">"z"</span><span class="PUNC">,</span><span class="KEYW">true</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4986</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4987</span> 
<span class='line'>4988</span> </span><span class="NAME">baa._debug.kill</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">wndow</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4989</span> </span><span class="WHIT">	</span><span class="NAME">this.windows.remove</span><span class="PUNC">(</span><span class="NAME">wndow</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4990</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4991</span> 
<span class='line'>4992</span> </span><span class="NAME">baa._debug.setActivate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>4993</span> </span><span class="WHIT">	</span><span class="NAME">this.activePress</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">arguments</span><span class="PUNC">[</span><span class="NAME">arguments.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4994</span> </span><span class="WHIT">	</span><span class="NAME">this.activeHold</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Array.prototype.slice.call</span><span class="PUNC">(</span><span class="NAME">arguments</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>4995</span> </span><span class="WHIT">	</span><span class="NAME">this.activeHold.splice</span><span class="PUNC">(</span><span class="NAME">arguments.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>4996</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>4997</span> 
<span class='line'>4998</span> 
<span class='line'>4999</span> </span><span class="NAME">baa._debug.window</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Class.extend</span><span class="PUNC">(</span><span class="STRN">"baa._debug.window"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5000</span> 
<span class='line'>5001</span> </span><span class="NAME">baa._debug.types</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5002</span> </span><span class="WHIT">	</span><span class="STRN">"object"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">200</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>5003</span> </span><span class="WHIT">	</span><span class="STRN">"string"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">200</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>5004</span> </span><span class="WHIT">	</span><span class="STRN">"number"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>5005</span> </span><span class="WHIT">	</span><span class="STRN">"boolean"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">200</span><span class="PUNC">,</span><span class="NUMB">200</span><span class="PUNC">,</span><span class="NUMB">100</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="WHIT">
<span class='line'>5006</span> </span><span class="WHIT">	</span><span class="STRN">"array"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="NUMB">150</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NUMB">50</span><span class="PUNC">]</span><span class="WHIT">
<span class='line'>5007</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5008</span> 
<span class='line'>5009</span> </span><span class="NAME">baa._debug.window.init</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5010</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5011</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5012</span> </span><span class="WHIT">	</span><span class="NAME">this.z</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.random</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5013</span> </span><span class="WHIT">	</span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5014</span> </span><span class="WHIT">	</span><span class="NAME">this.selectorY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">200</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5015</span> </span><span class="WHIT">	</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">210</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5016</span> </span><span class="WHIT">	</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5017</span> </span><span class="WHIT">	</span><span class="NAME">this.rounding</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0.5</span><span class="WHIT">
<span class='line'>5018</span> 
<span class='line'>5019</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5020</span> </span><span class="WHIT">	</span><span class="NAME">this.originalObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5021</span> </span><span class="WHIT">	</span><span class="NAME">this.objects</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5022</span> 
<span class='line'>5023</span> </span><span class="WHIT">	</span><span class="NAME">this.showPrivates</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5024</span> </span><span class="WHIT">	</span><span class="NAME">this.longestKeyWord</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5025</span> </span><span class="WHIT">	</span><span class="NAME">this.textHeightMargin</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">20</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5026</span> </span><span class="WHIT">	</span><span class="NAME">this.textWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">8.3</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5027</span> </span><span class="WHIT">	</span><span class="NAME">this.keysWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5028</span> </span><span class="WHIT">	</span><span class="NAME">this.longestValueLimit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">13</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5029</span> 
<span class='line'>5030</span> </span><span class="WHIT">	</span><span class="NAME">this.selectedKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5031</span> 
<span class='line'>5032</span> </span><span class="WHIT">	</span><span class="NAME">this.editing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5033</span> </span><span class="WHIT">	</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5034</span> </span><span class="WHIT">	</span><span class="NAME">this.editType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5035</span> </span><span class="WHIT">	</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5036</span> </span><span class="WHIT">	</span><span class="NAME">this.editTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5037</span> 
<span class='line'>5038</span> </span><span class="WHIT">	</span><span class="NAME">this.name</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">name</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5039</span> </span><span class="WHIT">	</span><span class="NAME">this.names</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5040</span> 
<span class='line'>5041</span> </span><span class="WHIT">	</span><span class="NAME">this.numberOfValues</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5042</span> 
<span class='line'>5043</span> </span><span class="WHIT">	</span><span class="NAME">this.titleBar</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5044</span> </span><span class="WHIT">	</span><span class="NAME">this.moving</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5045</span> 
<span class='line'>5046</span> </span><span class="WHIT">	</span><span class="NAME">this.resizer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">15</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">15</span><span class="PUNC">,</span><span class="NUMB">20</span><span class="PUNC">,</span><span class="NUMB">20</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5047</span> </span><span class="WHIT">	</span><span class="NAME">this.resizing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5048</span> 
<span class='line'>5049</span> </span><span class="WHIT">	</span><span class="COMM">//Menu</span><span class="WHIT">
<span class='line'>5050</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonBack</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">27</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5051</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPrivate</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">27</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5052</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonClose</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">27</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5053</span> </span><span class="WHIT">	
<span class='line'>5054</span> 	</span><span class="COMM">//Scrolling</span><span class="WHIT">
<span class='line'>5055</span> </span><span class="WHIT">	</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5056</span> </span><span class="WHIT">	</span><span class="NAME">this.scrollLimit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5057</span> 
<span class='line'>5058</span> 
<span class='line'>5059</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5060</span> 
<span class='line'>5061</span> </span><span class="NAME">baa._debug.window.update</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5062</span> </span><span class="WHIT">	</span><span class="COMM">// this.width = this.keysWidth;</span><span class="WHIT">
<span class='line'>5063</span> </span><span class="WHIT">	</span><span class="COMM">// this.keysWidth = this.longestKeyWord * this.textWidth + 10;</span><span class="WHIT">
<span class='line'>5064</span> </span><span class="WHIT">	</span><span class="NAME">this.longestValueLimit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.keysWidth</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NAME">this.textWidth</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5065</span> </span><span class="WHIT">	</span><span class="NAME">this.scrollLimit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.numberOfValues</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.textHeightMargin</span><span class="PUNC">+</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="PUNC">/</span><span class="NUMB">1.8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5066</span> 
<span class='line'>5067</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5068</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.resizer.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5069</span> </span><span class="WHIT">			</span><span class="NAME">baa.mouse.catchPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5070</span> </span><span class="WHIT">			</span><span class="NAME">this.resizing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5071</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5072</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.titleBar.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5073</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.focus</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5074</span> </span><span class="WHIT">			</span><span class="NAME">this.moving</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5075</span> </span><span class="WHIT">			</span><span class="NAME">baa.mouse.catchPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5076</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5077</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonBack.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5078</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.objects.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5079</span> </span><span class="WHIT">				</span><span class="NAME">this.goBackObject</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5080</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5081</span> </span><span class="WHIT">			</span><span class="NAME">baa.mouse.catchPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5082</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5083</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonPrivate.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5084</span> </span><span class="WHIT">			</span><span class="NAME">this.showPrivates</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.showPrivates</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5085</span> </span><span class="WHIT">			</span><span class="NAME">baa.mouse.catchPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5086</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5087</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.buttonClose.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5088</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.kill</span><span class="PUNC">(</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5089</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5090</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5091</span> 
<span class='line'>5092</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isReleased</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5093</span> </span><span class="WHIT">		</span><span class="NAME">this.resizing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5094</span> </span><span class="WHIT">		</span><span class="NAME">this.moving</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5095</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5096</span> 
<span class='line'>5097</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.resizing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5098</span> </span><span class="WHIT">		</span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.getX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5099</span> </span><span class="WHIT">		</span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.mouse.getY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5100</span> </span><span class="WHIT">		</span><span class="NAME">this.titleBar.width</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5101</span> </span><span class="WHIT">		</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5102</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5103</span> 
<span class='line'>5104</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.moving</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5105</span> </span><span class="WHIT">		</span><span class="NAME">this.setPosition</span><span class="PUNC">(</span><span class="NAME">baa.mouse.getX</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="NAME">baa.mouse.getY</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5106</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5107</span> 
<span class='line'>5108</span> </span><span class="WHIT">	</span><span class="NAME">this.resizer.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.width</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">15</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5109</span> </span><span class="WHIT">	</span><span class="NAME">this.resizer.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">15</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5110</span> 
<span class='line'>5111</span> </span><span class="WHIT">	</span><span class="NAME">this.editTimer</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">dt</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5112</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editTimer</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1.5</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5113</span> </span><span class="WHIT">		</span><span class="NAME">this.editTimer</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5114</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5115</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5116</span> 
<span class='line'>5117</span> </span><span class="NAME">baa._debug.window.draw</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5118</span> </span><span class="WHIT">	</span><span class="NAME">this.drawData</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5119</span> </span><span class="WHIT">	</span><span class="NAME">this.drawButtons</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5120</span> </span><span class="WHIT">	</span><span class="NAME">this.drawRectangle</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5121</span> </span><span class="WHIT">	</span><span class="NAME">this.drawName</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5122</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.resizing</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.moving</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5123</span> </span><span class="WHIT">		</span><span class="NAME">this.drawSelector</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5124</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5125</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5126</span> </span><span class="WHIT">	</span><span class="NAME">this.resizer.draw</span><span class="PUNC">(</span><span class="STRN">"both"</span><span class="PUNC">,</span><span class="NUMB">2</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5127</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5128</span> 
<span class='line'>5129</span> </span><span class="NAME">baa._debug.window.drawRectangle</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5130</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5131</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setLineWidth</span><span class="PUNC">(</span><span class="NUMB">3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5132</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">,</span><span class="NAME">this.rounding</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5133</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5134</span> 
<span class='line'>5135</span> </span><span class="NAME">baa._debug.window.drawName</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5136</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5137</span> </span><span class="WHIT">	</span><span class="NAME">this.titleBar.draw</span><span class="PUNC">(</span><span class="STRN">"both"</span><span class="PUNC">,</span><span class="NUMB">1.8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5138</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5139</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.name</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5140</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.names.length</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5141</span> </span><span class="WHIT">		</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">" -> "</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5142</span> </span><span class="WHIT">		</span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">str</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.names</span><span class="PUNC">[</span><span class="NAME">i</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5143</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5144</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="NAME">str</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NUMB">5</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">+</span><span class="NUMB">4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5145</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5146</span> 
<span class='line'>5147</span> </span><span class="NAME">baa._debug.window.drawButtons</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5148</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5149</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.buttonBack.x</span><span class="PUNC">,</span><span class="NAME">this.buttonBack.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NUMB">27</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5150</span> 
<span class='line'>5151</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.objects.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5152</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5153</span> </span><span class="WHIT">		</span><span class="NAME">this.buttonBack.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5154</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">0.3</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>5155</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5156</span> </span><span class="WHIT">		</span><span class="NAME">this.buttonBack.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5157</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>5158</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">"B"</span><span class="PUNC">,</span><span class="NAME">this.buttonBack.x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">this.buttonBack.y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5159</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5160</span> 
<span class='line'>5161</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5162</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPrivate.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5163</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5164</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">0.3</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>5165</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPrivate.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5166</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>5167</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">"P"</span><span class="PUNC">,</span><span class="NAME">this.buttonPrivate.x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">this.buttonPrivate.y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5168</span> 
<span class='line'>5169</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5170</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonClose.draw</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5171</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5172</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">0.3</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5173</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonClose.draw</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5174</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5175</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">"X"</span><span class="PUNC">,</span><span class="NAME">this.buttonClose.x</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">,</span><span class="NAME">this.buttonClose.y</span><span class="PUNC">+</span><span class="NUMB">8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5176</span> 
<span class='line'>5177</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5178</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"line"</span><span class="PUNC">,</span><span class="NAME">this.buttonBack.x</span><span class="PUNC">,</span><span class="NAME">this.buttonBack.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NUMB">27</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5179</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5180</span> 
<span class='line'>5181</span> </span><span class="NAME">baa._debug.window.drawData</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5182</span> </span><span class="WHIT">	</span><span class="COMM">//TODO: Zorg ervoor dat dit niet meer in draw staat. Veel shit wordt hier gemaakt</span><span class="WHIT">
<span class='line'>5183</span> </span><span class="WHIT">	</span><span class="COMM">//en geupdate, wat in de update loop moet. Bovendien zorgt het voor die bug</span><span class="WHIT">
<span class='line'>5184</span> </span><span class="WHIT">	</span><span class="COMM">//die er voor zorgt dat je op dingen achteraan eerst klikt. Dank u!</span><span class="WHIT">
<span class='line'>5185</span> 
<span class='line'>5186</span> </span><span class="WHIT">	</span><span class="KEYW">function</span><span class="WHIT"> </span><span class="NAME">shape</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5187</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"scissor"</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5188</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5189</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setScissor</span><span class="PUNC">(</span><span class="NAME">shape</span><span class="PUNC">,</span><span class="KEYW">this</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5190</span> </span><span class="WHIT">	</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5191</span> 
<span class='line'>5192</span> 
<span class='line'>5193</span> </span><span class="WHIT">	</span><span class="NAME">this.longestKeyWord</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5194</span> 
<span class='line'>5195</span> </span><span class="WHIT">	</span><span class="KEYW">for</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">key</span><span class="WHIT"> </span><span class="KEYW">in</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5196</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">undefined</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5197</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5198</span> </span><span class="WHIT">				</span><span class="KEYW">delete</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5199</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5200</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5201</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">typeof</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5202</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">sbstr</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">key.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5203</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5204</span> </span><span class="WHIT">		</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">rect</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa.rect.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5205</span> </span><span class="WHIT">		
<span class='line'>5206</span> 		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5207</span> </span><span class="WHIT">			</span><span class="COMM">//We don't want long decimals.</span><span class="WHIT">
<span class='line'>5208</span> </span><span class="WHIT">			</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">value</span><span class="PUNC">*</span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5209</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5210</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5211</span> </span><span class="WHIT">			</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">'"'</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5212</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5213</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5214</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Class.isClass</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5215</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">type</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5216</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5217</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">Array.isArray</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5218</span> </span><span class="WHIT">				</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"array"</span><span class="WHIT">
<span class='line'>5219</span> </span><span class="WHIT">				</span><span class="NAME">value</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">"Array ("</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">.</span><span class="NAME">length</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">")"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5220</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5221</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5222</span> 
<span class='line'>5223</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"function"</span><span class="WHIT"> </span><span class="COMM">/* && this.obj[key]!=undefined */</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5224</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">sbstr</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"_"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.showPrivates</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">sbstr</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">"_"</span><span class="WHIT"> </span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5225</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NAME">baa.debug.types</span><span class="PUNC">[</span><span class="NAME">type</span><span class="PUNC">]</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>5226</span> </span><span class="WHIT">				</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">0.8</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5227</span> </span><span class="WHIT">				</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.getDataY</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">3</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5228</span> </span><span class="WHIT">				</span><span class="NAME">rect.set</span><span class="PUNC">(</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.textHeightMargin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5229</span> </span><span class="WHIT">				</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">40</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">y</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.height</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5230</span> </span><span class="WHIT">					</span><span class="NAME">rect.draw</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5231</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">this.resizing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5232</span> </span><span class="WHIT">						</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">rect.overlaps</span><span class="PUNC">(</span><span class="NAME">baa.mouse</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5233</span> </span><span class="WHIT">							</span><span class="NAME">this.selectorY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">rect.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5234</span> </span><span class="WHIT">							</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"m"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5235</span> </span><span class="WHIT">								</span><span class="KEYW">var</span><span class="WHIT"> </span><span class="NAME">shouldBreak</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.clickedOnKey</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="NAME">type</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5236</span> </span><span class="WHIT">								</span><span class="COMM">// baa.mouse.catchPressed("l");</span><span class="WHIT">
<span class='line'>5237</span> </span><span class="WHIT">								</span><span class="COMM">// baa.mouse.catchPressed("m");</span><span class="WHIT">
<span class='line'>5238</span> </span><span class="WHIT">								</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">shouldBreak</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5239</span> </span><span class="WHIT">									</span><span class="KEYW">break</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5240</span> </span><span class="WHIT">								</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5241</span> </span><span class="WHIT">							</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5242</span> </span><span class="WHIT">						</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5243</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5244</span> </span><span class="WHIT">					</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT">
<span class='line'>5245</span> </span><span class="WHIT">					</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">+</span><span class="NUMB">10</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.getDataY</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5246</span> </span><span class="WHIT">					</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editing</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5247</span> </span><span class="WHIT">						</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editTimer</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0.75</span><span class="WHIT"> </span><span class="PUNC">?</span><span class="WHIT"> </span><span class="STRN">"_"</span><span class="WHIT"> </span><span class="PUNC">:</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.keysWidth</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.getDataY</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5248</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5249</span> </span><span class="WHIT">					</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5250</span> </span><span class="WHIT">						</span><span class="NAME">baa.graphics.print</span><span class="PUNC">(</span><span class="STRN">""</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">value</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.keysWidth</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.getDataY</span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5251</span> </span><span class="WHIT">					</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5252</span> </span><span class="WHIT">					</span><span class="NAME">this.keysWidth</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.keysWidth</span><span class="PUNC">,</span><span class="NAME">baa.graphics.getTextWidth</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">10</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5253</span> </span><span class="WHIT">				</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5254</span> </span><span class="WHIT">				</span><span class="NAME">i</span><span class="PUNC">++</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5255</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5256</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5257</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5258</span> 
<span class='line'>5259</span> </span><span class="WHIT">	</span><span class="NAME">this.numberOfValues</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">i</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5260</span> 
<span class='line'>5261</span> </span><span class="WHIT">	</span><span class="NAME">baa.graphics.setScissor</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5262</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5263</span> 
<span class='line'>5264</span> </span><span class="NAME">baa._debug.window.drawSelector</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5265</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.selectorY</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">40</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5266</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">0.4</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5267</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setColor</span><span class="PUNC">(</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">,</span><span class="NUMB">255</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5268</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.rectangle</span><span class="PUNC">(</span><span class="STRN">"fill"</span><span class="PUNC">,</span><span class="NAME">this.x</span><span class="PUNC">,</span><span class="NAME">this.selectorY</span><span class="PUNC">,</span><span class="NAME">this.width</span><span class="PUNC">,</span><span class="NAME">this.textHeightMargin</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5269</span> </span><span class="WHIT">		</span><span class="NAME">baa.graphics.setAlpha</span><span class="PUNC">(</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5270</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5271</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5272</span> 
<span class='line'>5273</span> </span><span class="NAME">baa._debug.window.getDataY</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">i</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5274</span> </span><span class="WHIT">	</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.textHeightMargin</span><span class="WHIT"> </span><span class="PUNC">*</span><span class="WHIT"> </span><span class="NAME">i</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5275</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5276</span> 
<span class='line'>5277</span> </span><span class="NAME">baa._debug.window.setPosition</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5278</span> </span><span class="WHIT">	</span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">x</span><span class="PUNC">-</span><span class="NAME">this.width</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5279</span> </span><span class="WHIT">	</span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">y</span><span class="PUNC">-</span><span class="NAME">this.titleBar.height</span><span class="PUNC">/</span><span class="NUMB">2</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5280</span> </span><span class="WHIT">	</span><span class="NAME">this.titleBar.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5281</span> </span><span class="WHIT">	</span><span class="NAME">this.titleBar.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5282</span> 
<span class='line'>5283</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonBack.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT">
<span class='line'>5284</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonBack.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5285</span> 
<span class='line'>5286</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPrivate.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">25</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5287</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonPrivate.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5288</span> 
<span class='line'>5289</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonClose.x</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.x</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">50</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5290</span> </span><span class="WHIT">	</span><span class="NAME">this.buttonClose.y</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.y</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.dataY</span><span class="WHIT"> </span><span class="PUNC">/</span><span class="WHIT"> </span><span class="NUMB">2.5</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5291</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5292</span> 
<span class='line'>5293</span> </span><span class="NAME">baa._debug.window.mousepressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="PUNC">,</span><span class="NAME">x</span><span class="PUNC">,</span><span class="NAME">y</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5294</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"wd"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5295</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.scrollLimit</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5296</span> </span><span class="WHIT">			</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.min</span><span class="PUNC">(</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NUMB">20</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NAME">this.scrollLimit</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5297</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5298</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5299</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">button</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"wu"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5300</span> </span><span class="WHIT">		</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Math.max</span><span class="PUNC">(</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="WHIT"> </span><span class="NUMB">20</span><span class="PUNC">,</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5301</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5302</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5303</span> 
<span class='line'>5304</span> </span><span class="NAME">baa._debug.window.keypressed</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5305</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5306</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"return"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5307</span> </span><span class="WHIT">			</span><span class="NAME">this.confirmEdit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5308</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5309</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"escape"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5310</span> </span><span class="WHIT">			</span><span class="NAME">this.cancelEdit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5311</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5312</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5313</span> </span><span class="WHIT">			</span><span class="NAME">this.pressNumber</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5314</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5315</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5316</span> </span><span class="WHIT">			</span><span class="NAME">this.pressString</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5317</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5318</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5319</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"return"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5320</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5321</span> </span><span class="WHIT">			</span><span class="NAME">this.editing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="WHIT">
<span class='line'>5322</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5323</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5324</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5325</span> 
<span class='line'>5326</span> </span><span class="NAME">baa._debug.window.pressNumber</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5327</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">!</span><span class="NAME">isNaN</span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5328</span> </span><span class="WHIT">		</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5329</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5330</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5331</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"backspace"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5332</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.editValue.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5333</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5334</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.editValue.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">0</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.editValue.indexOf</span><span class="PUNC">(</span><span class="STRN">"."</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="PUNC">-</span><span class="NUMB">1</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.editValue.indexOf</span><span class="PUNC">(</span><span class="STRN">"-"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">&lt;</span><span class="WHIT"> </span><span class="NAME">this.editValue.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5335</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"."</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5336</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5337</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.editValue.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5338</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="STRN">"-"</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5339</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT"> 
<span class='line'>5340</span> 	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5341</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5342</span> 
<span class='line'>5343</span> </span><span class="NAME">baa._debug.window.pressString</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5344</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key.length</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5345</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.keyboard.isDown</span><span class="PUNC">(</span><span class="STRN">"shift"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5346</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">key.toUpperCase</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5347</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5348</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5349</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5350</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5351</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5352</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5353</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"backspace"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5354</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue.substring</span><span class="PUNC">(</span><span class="NUMB">0</span><span class="PUNC">,</span><span class="NAME">this.editValue.length</span><span class="PUNC">-</span><span class="NUMB">1</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5355</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5356</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5357</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5358</span> 
<span class='line'>5359</span> 
<span class='line'>5360</span> </span><span class="NAME">baa._debug.window.clickedOnKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="PUNC">,</span><span class="NAME">type</span><span class="PUNC">,</span><span class="NAME">pressed</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5361</span> </span><span class="WHIT">	</span><span class="NAME">baa.mouse.catchPressed</span><span class="PUNC">(</span><span class="STRN">"l"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5362</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"boolean"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5363</span> </span><span class="WHIT">		</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">!</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5364</span> </span><span class="WHIT">		</span><span class="NAME">this.cancelEdit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5365</span> </span><span class="WHIT">		</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5366</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5367</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"string"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5368</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">key</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">&&</span><span class="WHIT"> </span><span class="NAME">this.editing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5369</span> </span><span class="WHIT">			</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5370</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5371</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5372</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5373</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT"> </span><span class="NAME">this.cancelEdit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT"> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5374</span> 
<span class='line'>5375</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5376</span> </span><span class="WHIT">				</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">Math.floor</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">*</span><span class="NUMB">100</span><span class="PUNC">)</span><span class="PUNC">/</span><span class="NUMB">100</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5377</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5378</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5379</span> </span><span class="WHIT">				</span><span class="NAME">this.editValue</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="WHIT"> </span><span class="PUNC">+</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5380</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5381</span> </span><span class="WHIT">			</span><span class="NAME">this.editType</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">type</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5382</span> </span><span class="WHIT">			</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">key</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5383</span> </span><span class="WHIT">			</span><span class="NAME">this.editing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5384</span> </span><span class="WHIT">			</span><span class="NAME">this.editOriginal</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5385</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5386</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5387</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5388</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"object"</span><span class="WHIT"> </span><span class="PUNC">||</span><span class="WHIT"> </span><span class="NAME">type</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"array"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5389</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">baa.mouse.isPressed</span><span class="PUNC">(</span><span class="STRN">"m"</span><span class="PUNC">)</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5390</span> </span><span class="WHIT">			</span><span class="NAME">baa.debug.watch</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5391</span> </span><span class="WHIT">			</span><span class="NAME">baa.mouse.catchPressed</span><span class="PUNC">(</span><span class="STRN">"m"</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5392</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5393</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5394</span> </span><span class="WHIT">		</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5395</span> </span><span class="WHIT">			</span><span class="NAME">this.setObject</span><span class="PUNC">(</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">key</span><span class="PUNC">]</span><span class="PUNC">,</span><span class="NAME">key</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5396</span> </span><span class="WHIT">			</span><span class="KEYW">return</span><span class="WHIT"> </span><span class="KEYW">true</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5397</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5398</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5399</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5400</span> 
<span class='line'>5401</span> </span><span class="NAME">baa._debug.window.setObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">,</span><span class="NAME">name</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5402</span> </span><span class="WHIT">	</span><span class="NAME">this.cancelEdit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5403</span> </span><span class="WHIT">	</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5404</span> </span><span class="WHIT">	</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5405</span> </span><span class="WHIT">	</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">obj</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5406</span> </span><span class="WHIT">	</span><span class="NAME">this.objects.push</span><span class="PUNC">(</span><span class="NAME">obj</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5407</span> </span><span class="WHIT">	</span><span class="NAME">this.names.push</span><span class="PUNC">(</span><span class="NAME">name</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5408</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5409</span> 
<span class='line'>5410</span> </span><span class="NAME">baa._debug.window.goBackObject</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5411</span> </span><span class="WHIT">	</span><span class="NAME">this.cancelEdit</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5412</span> </span><span class="WHIT">	</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5413</span> </span><span class="WHIT">	</span><span class="NAME">this.scrollHeight</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NUMB">0</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5414</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.objects.length</span><span class="WHIT"> </span><span class="PUNC">></span><span class="WHIT"> </span><span class="NUMB">1</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5415</span> </span><span class="WHIT">		</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.objects</span><span class="PUNC">[</span><span class="NAME">this.objects.length</span><span class="PUNC">-</span><span class="NUMB">2</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5416</span> </span><span class="WHIT">		</span><span class="NAME">this.objects.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5417</span> </span><span class="WHIT">		</span><span class="NAME">this.names.pop</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5418</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5419</span> </span><span class="WHIT">	</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5420</span> </span><span class="WHIT">		</span><span class="NAME">this.obj</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.originalObject</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5421</span> </span><span class="WHIT">		</span><span class="NAME">this.names</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5422</span> </span><span class="WHIT">		</span><span class="NAME">this.objects</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="PUNC">[</span><span class="PUNC">]</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5423</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5424</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5425</span> 
<span class='line'>5426</span> </span><span class="NAME">baa._debug.window.cancelEdit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5427</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5428</span> </span><span class="WHIT">		</span><span class="NAME">this.editing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5429</span> </span><span class="WHIT">		</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">this.editKey</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editOriginal</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5430</span> </span><span class="WHIT">		</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5431</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5432</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5433</span> 
<span class='line'>5434</span> </span><span class="NAME">baa._debug.window.confirmEdit</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">function</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5435</span> </span><span class="WHIT">	</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editing</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5436</span> </span><span class="WHIT">		</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editKey</span><span class="WHIT"> </span><span class="PUNC">!=</span><span class="WHIT"> </span><span class="STRN">""</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5437</span> </span><span class="WHIT">			</span><span class="NAME">this.editing</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="KEYW">false</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5438</span> </span><span class="WHIT">			</span><span class="KEYW">if</span><span class="WHIT"> </span><span class="PUNC">(</span><span class="NAME">this.editType</span><span class="WHIT"> </span><span class="PUNC">==</span><span class="WHIT"> </span><span class="STRN">"number"</span><span class="PUNC">)</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5439</span> </span><span class="WHIT">				</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">this.editKey</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">Number</span><span class="PUNC">(</span><span class="NAME">this.editValue</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5440</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5441</span> </span><span class="WHIT">			</span><span class="KEYW">else</span><span class="WHIT"> </span><span class="PUNC">{</span><span class="WHIT">
<span class='line'>5442</span> </span><span class="WHIT">				</span><span class="NAME">this.obj</span><span class="PUNC">[</span><span class="NAME">this.editKey</span><span class="PUNC">]</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">this.editValue</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5443</span> </span><span class="WHIT">			</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5444</span> </span><span class="WHIT">		</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5445</span> </span><span class="WHIT">	</span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5446</span> </span><span class="PUNC">}</span><span class="WHIT">
<span class='line'>5447</span> 
<span class='line'>5448</span> </span><span class="COMM">// baa._debug.window.draw</span><span class="WHIT">
<span class='line'>5449</span> 
<span class='line'>5450</span> </span><span class="NAME">baa.debug</span><span class="WHIT"> </span><span class="PUNC">=</span><span class="WHIT"> </span><span class="NAME">baa._debug.new</span><span class="PUNC">(</span><span class="PUNC">)</span><span class="PUNC">;</span><span class="WHIT">
<span class='line'>5451</span> 
<span class='line'>5452</span> 
<span class='line'>5453</span> </span><span class="COMM">//Oh en misschien ook object debug drawing (body rectangle shizzle, van die rode vierkanten)</span><span class="WHIT">
<span class='line'>5454</span> 
<span class='line'>5455</span> </span><span class="COMM">//Zorg dat windows niet out of bounds kunnen. ( eh..)</span><span class="WHIT">
<span class='line'>5456</span> 
<span class='line'>5457</span> </span><span class="COMM">//Button to see fps graph (????)</span><span class="WHIT">
<span class='line'>5458</span> 
<span class='line'>5459</span> 
<span class='line'>5460</span> </span><span class="COMM">//TODO</span><span class="WHIT">
<span class='line'>5461</span> </span><span class="COMM">////DEBUUGGG</span><span class="WHIT">
<span class='line'>5462</span> </span><span class="COMM">//Make windows contain objects.</span><span class="WHIT">
<span class='line'>5463</span> </span><span class="COMM">//Er is een main window, en door in het main window op variables te klikken</span><span class="WHIT">
<span class='line'>5464</span> </span><span class="COMM">//met middle mouse knop open je een nieuw window.</span><span class="WHIT">
<span class='line'>5465</span> </span><span class="COMM">//Het main window moet 'game' bevatten.</span><span class="WHIT">
<span class='line'>5466</span> 
<span class='line'>5467</span> 
<span class='line'>5468</span> </span><span class="COMM">//List of stuff to add:</span><span class="WHIT">
<span class='line'>5469</span> </span><span class="COMM">/*
<span class='line'>5470</span> baa.graphics.push and pop for colors, linewidth, all that stuff.
<span class='line'>5471</span> 
<span class='line'>5472</span> baa.button class
<span class='line'>5473</span> 
<span class='line'>5474</span> */</span><span class="WHIT">
<span class='line'>5475</span> 
<span class='line'>5476</span> </span><span class="WHIT"> </span></pre></body></html>